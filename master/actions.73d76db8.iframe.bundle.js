(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{5e3:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return goBack}));__webpack_require__(195),__webpack_require__(75),__webpack_require__(5002);var goBack=function goBack(url){for(var amount=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,normalizedUrl=url.replace(/\/$/,""),i=0;i<amount;i++)normalizedUrl=normalizedUrl.substring(0,normalizedUrl.lastIndexOf("/"));return normalizedUrl}},5002:function(module,exports,__webpack_require__){var $=__webpack_require__(44),lastIndexOf=__webpack_require__(5003);$({target:"Array",proto:!0,forced:lastIndexOf!==[].lastIndexOf},{lastIndexOf:lastIndexOf})},5003:function(module,exports,__webpack_require__){"use strict";var toIndexedObject=__webpack_require__(279),toInteger=__webpack_require__(424),toLength=__webpack_require__(184),arrayMethodIsStrict=__webpack_require__(425),min=Math.min,$lastIndexOf=[].lastIndexOf,NEGATIVE_ZERO=!!$lastIndexOf&&1/[1].lastIndexOf(1,-0)<0,STRICT_METHOD=arrayMethodIsStrict("lastIndexOf"),FORCED=NEGATIVE_ZERO||!STRICT_METHOD;module.exports=FORCED?function lastIndexOf(searchElement){if(NEGATIVE_ZERO)return $lastIndexOf.apply(this,arguments)||0;var O=toIndexedObject(this),length=toLength(O.length),index=length-1;for(arguments.length>1&&(index=min(index,toInteger(arguments[1]))),index<0&&(index=length+index);index>=0;index--)if(index in O&&O[index]===searchElement)return index||0;return-1}:$lastIndexOf},5023:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var tocco_input_edit_src_main__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(972);__webpack_require__.d(__webpack_exports__,"default",(function(){return tocco_input_edit_src_main__WEBPACK_IMPORTED_MODULE_0__.a}))},5024:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var tocco_delete_src_main__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5005);__webpack_require__.d(__webpack_exports__,"default",(function(){return tocco_delete_src_main__WEBPACK_IMPORTED_MODULE_0__.a}))},5196:function(module,exports,__webpack_require__){var baseSet=__webpack_require__(1392);module.exports=function setWith(object,path,value,customizer){return customizer="function"==typeof customizer?customizer:void 0,null==object?object:baseSet(object,path,value,customizer)}},5210:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var tocco_input_edit_src_main__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(972);__webpack_require__.d(__webpack_exports__,"default",(function(){return tocco_input_edit_src_main__WEBPACK_IMPORTED_MODULE_0__.a}))},5211:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(483),__webpack_require__(75),__webpack_require__(30),__webpack_require__(1);var tocco_resource_scheduler_src_main__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1359),_utils_routing__WEBPACK_IMPORTED_MODULE_7__=(__webpack_require__(2281),__webpack_require__(1382),__webpack_require__(5e3)),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(0),ResourceScheduler=function ResourceScheduler(_ref){var match=_ref.match,selection=_ref.selection,actionProperties=_ref.actionProperties,history=_ref.history,entityBaseUrl=Object(_utils_routing__WEBPACK_IMPORTED_MODULE_7__.a)(match.url,2);return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(tocco_resource_scheduler_src_main__WEBPACK_IMPORTED_MODULE_4__.b,{onEventClick:function onEventClick(_ref2){var model=_ref2.model,key=_ref2.key,url=history.createHref({pathname:"".concat(entityBaseUrl,"/").concat(model,"/").concat(key)});window.open(url,"_blank")},selection:selection,actionProperties:actionProperties})};ResourceScheduler.displayName="ResourceScheduler",ResourceScheduler.__docgenInfo={description:"",methods:[],displayName:"ResourceScheduler",props:{match:{type:{name:"shape",value:{url:{name:"string",required:!1}}},required:!0,description:""},selection:{type:{name:"custom",raw:"selectionPropType.propType"},required:!1,description:""},actionProperties:{type:{name:"shape",value:{calendarType:{name:"string",required:!1}}},required:!1,description:""},history:{type:{name:"shape",value:{createHref:{name:"func",required:!0}}},required:!0,description:""}}},__webpack_exports__.default=ResourceScheduler,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/admin/src/routes/entities/components/Action/actions/ResourceScheduler.js"]={name:"ResourceScheduler",docgenInfo:ResourceScheduler.__docgenInfo,path:"packages/admin/src/routes/entities/components/Action/actions/ResourceScheduler.js"})},5212:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(1);var react_router_dom__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(719),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__(2281),__webpack_require__(0)),ShowOutputJobsAction=function ShowOutputJobsAction(props){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(react_router_dom__WEBPACK_IMPORTED_MODULE_1__.b,{to:{pathname:"/e/Output_job/list",search:"tql=".concat(encodeURIComponent('entity=="'.concat(props.selection.entityName,'"')))}})};ShowOutputJobsAction.displayName="ShowOutputJobsAction",ShowOutputJobsAction.__docgenInfo={description:"",methods:[],displayName:"ShowOutputJobsAction",props:{selection:{type:{name:"shape",value:{entityName:{name:"string",required:!0}}},required:!0,description:""}}},__webpack_exports__.default=ShowOutputJobsAction,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/admin/src/routes/entities/components/Action/actions/ShowOutputJobsAction.js"]={name:"ShowOutputJobsAction",docgenInfo:ShowOutputJobsAction.__docgenInfo,path:"packages/admin/src/routes/entities/components/Action/actions/ShowOutputJobsAction.js"})},5213:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var tocco_delete_src_main__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5005);__webpack_require__.d(__webpack_exports__,"default",(function(){return tocco_delete_src_main__WEBPACK_IMPORTED_MODULE_0__.a}))},5214:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(1);var react_router_dom__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(719),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),Documents=function Documents(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_router_dom__WEBPACK_IMPORTED_MODULE_1__.b,{to:{pathname:"/docs"}})};Documents.displayName="Documents",Documents.__docgenInfo={description:"",methods:[],displayName:"Documents"},__webpack_exports__.default=Documents,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/admin/src/routes/entities/components/Action/actions/Documents.js"]={name:"Documents",docgenInfo:Documents.__docgenInfo,path:"packages/admin/src/routes/entities/components/Action/actions/Documents.js"})},5215:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var tocco_login_src_main__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(984),react_redux__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(25),tocco_app_extensions_src_notification__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__(1),__webpack_require__(2281),__webpack_require__(26)),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),mapActionCreators={closeModal:tocco_app_extensions_src_notification__WEBPACK_IMPORTED_MODULE_4__.a.removeModal},PasswordUpdate=function PasswordUpdate(_ref){var selection=_ref.selection,closeModal=_ref.closeModal;return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_5__.jsx)(tocco_login_src_main__WEBPACK_IMPORTED_MODULE_0__.a,{username:selection.ids[0],showOldPasswordField:!1,success:function success(){return closeModal("action-password-update")}})};PasswordUpdate.displayName="PasswordUpdate",PasswordUpdate.__docgenInfo={description:"",methods:[],displayName:"PasswordUpdate",props:{selection:{type:{name:"object"},required:!0,description:""},closeModal:{type:{name:"func"},required:!0,description:""}}},__webpack_exports__.default=Object(react_redux__WEBPACK_IMPORTED_MODULE_1__.connect)(null,mapActionCreators)(PasswordUpdate),"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/admin/src/routes/entities/components/Action/actions/PasswordUpdate.js"]={name:"PasswordUpdate",docgenInfo:PasswordUpdate.__docgenInfo,path:"packages/admin/src/routes/entities/components/Action/actions/PasswordUpdate.js"})},5220:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",(function(){return main}));__webpack_require__(79),__webpack_require__(11);var react=__webpack_require__(1),react_default=__webpack_require__.n(react),reducer=__webpack_require__(18),actionEmitter=__webpack_require__(76),appFactory=__webpack_require__(58),externalEvents=__webpack_require__(57),notification=__webpack_require__(26),prop_types=__webpack_require__(6),prop_types_default=__webpack_require__.n(prop_types),GlobalStyles=__webpack_require__(4990),es=__webpack_require__(25),injectIntl=__webpack_require__(375),Typography=__webpack_require__(17),LoadMask=__webpack_require__(2280),Table=__webpack_require__(2277),message=__webpack_require__(1974),defineProperty=__webpack_require__(8),defineProperty_default=__webpack_require__.n(defineProperty),slicedToArray=__webpack_require__(31),slicedToArray_default=__webpack_require__.n(slicedToArray),toConsumableArray=__webpack_require__(23),toConsumableArray_default=__webpack_require__.n(toConsumableArray),jsx_runtime=(__webpack_require__(56),__webpack_require__(2290),__webpack_require__(35),__webpack_require__(98),__webpack_require__(64),__webpack_require__(68),__webpack_require__(28),__webpack_require__(30),__webpack_require__(82),__webpack_require__(341),__webpack_require__(106),__webpack_require__(141),__webpack_require__(254),__webpack_require__(80),__webpack_require__(573),__webpack_require__(236),__webpack_require__(0)),getAllPaths=function getAllPaths(sourceData){return Object.keys(sourceData.entities[0].paths)},sourceData_getAllRelations=function getAllRelations(sourceData){return toConsumableArray_default()(new Set(sourceData.relations.map((function(r){return r.relationName}))))},sourceData_getSortedPathsAndRelations=function getSortedPathsAndRelations(sourceData){var counters=Object.entries(sourceData.entities[0].paths).filter((function(_ref){var _ref2=slicedToArray_default()(_ref,2);_ref2[0];return"counter"===_ref2[1].type})).map((function(_ref3){var _ref4=slicedToArray_default()(_ref3,2),name=_ref4[0];_ref4[1];return name})),other=function getAllPathsAndRelations(sourceData){return[].concat(toConsumableArray_default()(getAllPaths(sourceData)),toConsumableArray_default()(sourceData_getAllRelations(sourceData)))}(sourceData).filter((function(name){return!counters.includes(name)})),sortByLabel=function sortByLabel(list){return list.map((function(name){return{name:name,label:sourceData.labels[name]}})).sort((function(a,b){return a.label<b.label?-1:1})).map((function(o){return o.name}))};return[].concat(toConsumableArray_default()(sortByLabel(counters)),toConsumableArray_default()(sortByLabel(other)))},getDisplay=function getDisplay(sourceData,model,key){var fallbackDisplay="PK: ".concat(key),displaysPerModel=sourceData.displays.find((function(d){return d.model===model}));if(void 0===displaysPerModel)return fallbackDisplay;var display=displaysPerModel.values.find((function(v){return v.key===key}));return display?display.display:fallbackDisplay},setSelection=(prop_types_default.a.shape({entities:prop_types_default.a.arrayOf(prop_types_default.a.shape({key:prop_types_default.a.string.isRequired,model:prop_types_default.a.string.isRequired,paths:prop_types_default.a.objectOf(prop_types_default.a.shape({type:prop_types_default.a.string,writable:prop_types_default.a.bool,value:prop_types_default.a.any}))})).isRequired,relations:prop_types_default.a.arrayOf(prop_types_default.a.shape({entityKey:prop_types_default.a.string.isRequired,relationName:prop_types_default.a.string.isRequired,keys:prop_types_default.a.arrayOf(prop_types_default.a.string).isRequired,totalKeys:prop_types_default.a.number.isRequired})).isRequired,displays:prop_types_default.a.arrayOf(prop_types_default.a.shape({model:prop_types_default.a.string.isRequired,values:prop_types_default.a.arrayOf(prop_types_default.a.shape({key:prop_types_default.a.string.isRequired,display:prop_types_default.a.string.isRequired}))})).isRequired,labels:prop_types_default.a.objectOf(prop_types_default.a.string).isRequired,mergeStragegy:prop_types_default.a.shape({display:prop_types_default.a.string})}),function setSelection(selection){return{type:"merge/SET_SELECTION",payload:{selection:selection}}}),setSourceData=function setSourceData(sourceData){return{type:"merge/SET_SOURCE_DATA",payload:{sourceData:sourceData}}},actions_setTargetEntity=function setTargetEntity(entityKey){return{type:"merge/SET_TARGET_ENTITY",payload:{entityKey:entityKey}}},setMergeResponse=function setMergeResponse(mergeResponse){return{type:"merge/SET_MERGE_RESPONSE",payload:{mergeResponse:mergeResponse}}},setMergeError=function setMergeError(errorMsg,validationErrors){return{type:"merge/SET_MERGE_ERROR",payload:{errorMsg:errorMsg,validationErrors:validationErrors}}},get=(__webpack_require__(2282),__webpack_require__(21)),get_default=__webpack_require__.n(get),MultiCheckbox=(__webpack_require__(153),__webpack_require__(154),__webpack_require__(568)),FormattedValue=__webpack_require__(140),field=__webpack_require__(377),js=__webpack_require__(163),manyRelationEntityCount_ManyRelationEntityCount=(__webpack_require__(253),function ManyRelationEntityCount(_ref){var model=_ref.model,keys=_ref.keys,totalKeys=_ref.totalKeys,navigationStrategy=_ref.navigationStrategy;return 0===totalKeys?Object(jsx_runtime.jsx)(Typography.a.Span,{children:totalKeys}):Object(jsx_runtime.jsxs)(navigationStrategy.ListLink,{entityName:model,entityKeys:keys.slice(0,100),children:["(",totalKeys,")"]})});manyRelationEntityCount_ManyRelationEntityCount.__docgenInfo={description:"",methods:[],displayName:"ManyRelationEntityCount",props:{model:{type:{name:"string"},required:!0,description:""},keys:{type:{name:"arrayOf",value:{name:"string"}},required:!1,description:""},totalKeys:{type:{name:"number"},required:!0,description:""},navigationStrategy:{type:{name:"custom",raw:"navigationStrategy.propTypes"},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/util/manyRelationEntityCount.js"]={name:"ManyRelationEntityCount",docgenInfo:manyRelationEntityCount_ManyRelationEntityCount.__docgenInfo,path:"packages/merge/src/util/manyRelationEntityCount.js"});var taggedTemplateLiteral=__webpack_require__(13),taggedTemplateLiteral_default=__webpack_require__.n(taggedTemplateLiteral),styled_components_browser_esm=__webpack_require__(5),modularScale=__webpack_require__(27),resolveThemePath=__webpack_require__(36),declareFont=__webpack_require__(81);function _templateObject7(){var data=taggedTemplateLiteral_default()(["\n  color: ",";\n"]);return _templateObject7=function _templateObject7(){return data},data}function _templateObject6(){var data=taggedTemplateLiteral_default()(["\n  flex: 1;\n"]);return _templateObject6=function _templateObject6(){return data},data}function _templateObject5(){var data=taggedTemplateLiteral_default()(["\n  display: flex;\n  align-items: center;\n\n  label {\n    vertical-align: bottom;\n  }\n"]);return _templateObject5=function _templateObject5(){return data},data}function _templateObject4(){var data=taggedTemplateLiteral_default()([""]);return _templateObject4=function _templateObject4(){return data},data}function _templateObject3(){var data=taggedTemplateLiteral_default()(["\n  display: flex;\n  align-items: center;\n  color: ",";\n  font-size: ",";\n"]);return _templateObject3=function _templateObject3(){return data},data}function _templateObject2(){var data=taggedTemplateLiteral_default()(["\n  display: grid;\n  align-items: center;\n  grid-template-columns: "," 1fr;\n  grid-column-gap: ",";\n  margin-bottom: ",";\n"]);return _templateObject2=function _templateObject2(){return data},data}function _templateObject(){var data=taggedTemplateLiteral_default()(["\n  ","\n  padding: "," 0 0 ",";\n"]);return _templateObject=function _templateObject(){return data},data}var StyledMergeErrorWrapper=styled_components_browser_esm.default.div(_templateObject(),Object(declareFont.a)(),modularScale.a.space(-1),modularScale.a.space(0)),StyledSummaryErrorWrapper=styled_components_browser_esm.default.div(_templateObject2(),modularScale.a.font(10),modularScale.a.space(-.5),modularScale.a.space(-.7)),StyledIconWrapper=styled_components_browser_esm.default.span(_templateObject3(),resolveThemePath.a.color("signal.danger.text"),modularScale.a.font(10)),StyledError=styled_components_browser_esm.default.p(_templateObject4()),StyledLabelWrapper=styled_components_browser_esm.default.div(_templateObject5()),StyledTableWrapper=styled_components_browser_esm.default.div(_templateObject6()),StyledStatusWrapper=styled_components_browser_esm.default.span(_templateObject7(),(function(_ref){return _ref.isChecked?resolveThemePath.a.color("signal.success.text"):resolveThemePath.a.color("signal.danger.text")})),Selection_areEqual=function areEqual(prevProps,nextProps){return 0===Object.keys(js.a.difference(prevProps,nextProps)).length},Selection_ref2=Object(jsx_runtime.jsx)(message.a,{id:"client.merge.allRelations"}),ManyRelationsCheckBox=react_default.a.memo((function(_ref){var entityData=_ref.entityData,entityKey=_ref.entityKey,name=_ref.name,setSelectedMultipleAll=_ref.setSelectedMultipleAll,isSelected=_ref.isSelected,navigationStrategy=_ref.navigationStrategy;if(0===entityData.value.totalKeys)return null;return Object(jsx_runtime.jsxs)(StyledLabelWrapper,{children:[Object(jsx_runtime.jsx)("input",{type:"checkbox",onChange:function onChange(e){return setSelectedMultipleAll(name,entityKey,e.target.checked)},checked:isSelected,id:"".concat(name).concat(entityKey)}),Object(jsx_runtime.jsxs)(Typography.a.Label,{for:"".concat(name).concat(entityKey),children:[Selection_ref2," ",Object(jsx_runtime.jsx)(manyRelationEntityCount_ManyRelationEntityCount,{model:entityData.value.relationEntity,keys:entityData.value.keys,totalKeys:entityData.value.totalKeys,navigationStrategy:navigationStrategy})]})]})}),Selection_areEqual),Selection_ref4=Object(jsx_runtime.jsx)(message.a,{id:"client.merge.allRelations"}),RelationsCheckBoxes=react_default.a.memo((function(_ref3){var entityData=_ref3.entityData,entityKey=_ref3.entityKey,name=_ref3.name,setSelectedMultiple=_ref3.setSelectedMultiple,selectedMultiple=_ref3.selectedMultiple,isSelected=function isSelected(key){return get_default()(selectedMultiple,[name,key])===entityKey},setSelected=function setSelected(key,checked){return setSelectedMultiple(name,entityKey,key,checked)},numberTotal=entityData.value.length,numberSelected=entityData.value.filter((function(relationEntity){return isSelected(relationEntity.key)})).length,allRowsSelectionState=numberTotal===numberSelected?"checked":numberSelected>0?"indeterminate":"unchecked";return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[entityData.value.length>0&&Object(jsx_runtime.jsxs)(StyledLabelWrapper,{children:[Object(jsx_runtime.jsx)(MultiCheckbox.a,{value:allRowsSelectionState,onChange:function allRowsSelectionChange(v){entityData.value.forEach((function(relationEntity){var checked="checked"===v;isSelected(relationEntity.key)!==checked&&setSelected(relationEntity.key,checked)}))},id:"".concat(name).concat(entityKey)}),Object(jsx_runtime.jsx)(Typography.a.Label,{for:"".concat(name).concat(entityKey),children:Selection_ref4})]}),entityData.value.map((function(relationEntity){return Object(jsx_runtime.jsxs)(StyledLabelWrapper,{children:[Object(jsx_runtime.jsx)("input",{type:"checkbox",onChange:function onChange(e){return setSelected(relationEntity.key,e.target.checked)},checked:isSelected(relationEntity.key),id:"".concat(name).concat(entityKey,"-").concat(relationEntity.key)}),Object(jsx_runtime.jsx)(Typography.a.Label,{for:"".concat(name).concat(entityKey,"-").concat(relationEntity.key),children:Object(jsx_runtime.jsx)(FormattedValue.a,{type:"single-select",value:relationEntity})})]},"relation-checkbox-".concat(relationEntity.key))}))]})}),Selection_areEqual),FormattedValueRadio=react_default.a.memo((function(_ref5){var entityData=_ref5.entityData,entityKey=_ref5.entityKey,name=_ref5.name,setSelectedSingle=_ref5.setSelectedSingle,isSelected=_ref5.isSelected,type=entityData.type,writable=entityData.writable,mappedType={entity:"single-select-box"}[type]||type,Field=field.a.factory("list",mappedType);return Object(jsx_runtime.jsxs)(StyledLabelWrapper,{children:[Object(jsx_runtime.jsx)("input",{type:"radio",name:name,onChange:function onChange(){setSelectedSingle(name,entityKey)},checked:isSelected,id:"".concat(name).concat(entityKey),disabled:!writable}),Object(jsx_runtime.jsx)(Typography.a.Label,{for:"".concat(name).concat(entityKey),children:Object(jsx_runtime.jsx)(Field,{formField:{dataType:mappedType},value:entityData.value})})]})}),Selection_areEqual),CellRender_CellRenderer=function CellRenderer(_ref){var rowData=_ref.rowData,column=_ref.column,setSelectedSingle=_ref.setSelectedSingle,selectedSingle=_ref.selectedSingle,setSelectedMultiple=_ref.setSelectedMultiple,selectedMultiple=_ref.selectedMultiple,setSelectedMultipleAll=_ref.setSelectedMultipleAll,selectedMultipleAll=_ref.selectedMultipleAll,navigationStrategy=_ref.navigationStrategy,entityKey=column.entityKey,entityData=rowData[entityKey],type=entityData.type,name=rowData.__key;return"relations"===type?Object(jsx_runtime.jsx)(ManyRelationsCheckBox,{entityData:entityData,entityKey:entityKey,name:name,setSelectedMultipleAll:setSelectedMultipleAll,isSelected:get_default()(selectedMultipleAll,[name],[]).includes(entityKey),navigationStrategy:navigationStrategy}):"entity-list"===type?Object(jsx_runtime.jsx)(RelationsCheckBoxes,{entityData:entityData,entityKey:entityKey,name:name,setSelectedMultiple:setSelectedMultiple,selectedMultiple:selectedMultiple}):Object(jsx_runtime.jsx)(FormattedValueRadio,{entityData:entityData,entityKey:entityKey,name:name,setSelectedSingle:setSelectedSingle,isSelected:selectedSingle[name]===entityKey})};CellRender_CellRenderer.displayName="CellRenderer";var mapActionCreatorsCell={setSelectedSingle:function setSelectedSingle(name,entityKey){return{type:"merge/SET_SELECTED_SINGLE",payload:{name:name,entityKey:entityKey}}},setSelectedMultiple:function setSelectedMultiple(name,entityKey,relatedEntityKey,isSelected){return{type:"merge/SET_SELECTED_MULTIPLE",payload:{name:name,entityKey:entityKey,relatedEntityKey:relatedEntityKey,isSelected:isSelected}}},setSelectedMultipleAll:function setSelectedMultipleAll(name,entityKey,isSelected){return{type:"merge/SET_SELECTED_MULTIPLE_ALL",payload:{name:name,entityKey:entityKey,isSelected:isSelected}}}},CellRendererContainer=Object(es.connect)((function mapStateToPropsCell(state){return{selectedSingle:state.merge.selected.single,selectedMultiple:state.merge.selected.multiple,selectedMultipleAll:state.merge.selected.multipleAll,navigationStrategy:state.input.navigationStrategy}}),mapActionCreatorsCell)(Object(injectIntl.c)(CellRender_CellRenderer));CellRender_CellRenderer.__docgenInfo={description:"",methods:[],displayName:"CellRenderer",props:{rowData:{type:{name:"objectOf",value:{name:"union",value:[{name:"shape",value:{value:{name:"any",required:!1},type:{name:"string",required:!1}}},{name:"string"}]}},required:!1,description:""},column:{type:{name:"shape",value:{entityKey:{name:"string",required:!0}}},required:!1,description:""},setSelectedSingle:{type:{name:"func"},required:!0,description:""},selectedSingle:{type:{name:"objectOf",value:{name:"string"}},required:!1,description:""},setSelectedMultiple:{type:{name:"func"},required:!0,description:""},selectedMultiple:{type:{name:"objectOf",value:{name:"objectOf",value:{name:"string"}}},required:!1,description:""},setSelectedMultipleAll:{type:{name:"func"},required:!0,description:""},selectedMultipleAll:{type:{name:"objectOf",value:{name:"arrayOf",value:{name:"string"}}},required:!1,description:""},navigationStrategy:{type:{name:"custom",raw:"navigationStrategy.propTypes"},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeTable/CellRender.js"]={name:"CellRenderer",docgenInfo:CellRender_CellRenderer.__docgenInfo,path:"packages/merge/src/components/MergeTable/CellRender.js"});var LazyIcon=__webpack_require__(717),MergeErrors_ref2=Object(jsx_runtime.jsxs)(StyledSummaryErrorWrapper,{children:[Object(jsx_runtime.jsx)(StyledIconWrapper,{children:Object(jsx_runtime.jsx)(LazyIcon.a,{icon:"times"})}),Object(jsx_runtime.jsx)(Typography.a.P,{children:Object(jsx_runtime.jsx)(message.a,{id:"client.merge.summary.error"})})]}),MergeErrors_MergeErrors=function MergeErrors(_ref){var sourceData=_ref.sourceData,mergeErrorMsg=_ref.mergeErrorMsg,allMergerValidationErrors=_ref.mergeValidationErrors.map((function(e){var fieldValidators=Object.keys(e.paths).map((function(name){return Object.keys(e.paths[name]).map((function(validator){return e.paths[name][validator].map((function(msg,index){return Object(jsx_runtime.jsxs)(StyledError,{children:[sourceData.labels[name],": ",msg]},"paths-".concat(name,"-").concat(validator,"-").concat(index))}))}))})),entityValidators=Object.keys(e.entityValidatorErrors).map((function(validator){return e.entityValidatorErrors[validator].map((function(msg,index){return Object(jsx_runtime.jsx)(StyledError,{children:msg},"entity-".concat(validator,"-").concat(index))}))}));return[].concat(toConsumableArray_default()(fieldValidators),toConsumableArray_default()(entityValidators))}));return Object(jsx_runtime.jsxs)(StyledMergeErrorWrapper,{children:[(allMergerValidationErrors.length>0||Boolean(mergeErrorMsg))&&MergeErrors_ref2,Boolean(mergeErrorMsg)&&Object(jsx_runtime.jsx)(StyledError,{children:mergeErrorMsg}),allMergerValidationErrors]})};MergeErrors_MergeErrors.displayName="MergeErrors";prop_types_default.a.arrayOf(prop_types_default.a.shape({model:prop_types_default.a.string,key:prop_types_default.a.string,paths:prop_types_default.a.objectOf(prop_types_default.a.objectOf(prop_types_default.a.arrayOf(prop_types_default.a.string))),entityValidatorErrors:prop_types_default.a.objectOf(prop_types_default.a.arrayOf(prop_types_default.a.string))}));MergeErrors_MergeErrors.__docgenInfo={description:"",methods:[],displayName:"MergeErrors",props:{sourceData:{type:{name:"custom",raw:"sourceDataPropType"},required:!1,description:""},mergeErrorMsg:{type:{name:"string"},required:!1,description:""},mergeValidationErrors:{type:{name:"custom",raw:"mergeValidationErrorsPropTypes"},required:!1,description:""}}};var MergeTable_MergeErrors=MergeErrors_MergeErrors;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeTable/MergeErrors.js"]={name:"MergeErrors",docgenInfo:MergeErrors_MergeErrors.__docgenInfo,path:"packages/merge/src/components/MergeTable/MergeErrors.js"});var Button=__webpack_require__(71);function GlobalStyledComponents_templateObject2(){var data=taggedTemplateLiteral_default()(["\n  align-self: flex-start;\n  margin-top: ",";\n  margin-bottom: ",";\n  margin-left: ",";\n"]);return GlobalStyledComponents_templateObject2=function _templateObject2(){return data},data}function GlobalStyledComponents_templateObject(){var data=taggedTemplateLiteral_default()(["\n  border-bottom: 3px solid ",";\n"]);return GlobalStyledComponents_templateObject=function _templateObject(){return data},data}var StyledButtonWrapper=styled_components_browser_esm.default.div(GlobalStyledComponents_templateObject(),resolveThemePath.a.color("backgroundBody")),StyledButton=Object(styled_components_browser_esm.default)(Button.a)(GlobalStyledComponents_templateObject2(),modularScale.a.space(-.7),modularScale.a.space(-.7),modularScale.a.space(0)),MergeTable_LabelCellRenderer=function LabelCellRenderer(_ref){var rowIdx=_ref.rowIdx,sourceData=_ref.sourceData,columnName=_ref.allPaths[rowIdx];return Object(jsx_runtime.jsx)(Typography.a.B,{children:sourceData.labels[columnName]})};MergeTable_LabelCellRenderer.displayName="LabelCellRenderer";var MergeTable_ref3=Object(jsx_runtime.jsx)(message.a,{id:"client.merge.strategy.keep"}),mapActionCreatorsColumn={setTargetEntity:actions_setTargetEntity},ColumnHeaderRendererContainer=Object(es.connect)((function mapStateToPropsColumn(state){return{targetEntity:state.merge.selected.targetEntity,mergeStrategyDisplay:state.merge.sourceData.mergeStrategyDisplay}}),mapActionCreatorsColumn)(Object(injectIntl.c)((function ColumnHeaderRenderer(_ref2){var label=_ref2.label,entityKey=_ref2.entityKey,setTargetEntity=_ref2.setTargetEntity,targetEntity=_ref2.targetEntity,mergeStrategyDisplay=_ref2.mergeStrategyDisplay,isChecked=targetEntity===entityKey,status=isChecked?MergeTable_ref3:mergeStrategyDisplay;return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("input",{type:"radio",name:"column",onChange:function onChange(){return setTargetEntity(entityKey)},checked:isChecked,id:"targetEntity".concat(entityKey)}),Object(jsx_runtime.jsxs)(Typography.a.Label,{for:"targetEntity".concat(entityKey),children:[Object(jsx_runtime.jsx)(Typography.a.B,{children:label}),Object(jsx_runtime.jsxs)(StyledStatusWrapper,{isChecked:isChecked,children:[" (",status,")"]})]})]})}))),MergeTable_ref5=Object(jsx_runtime.jsx)(LoadMask.a,{}),MergeTable_ref6=Object(jsx_runtime.jsx)(message.a,{id:"client.merge.saveButton"}),MergeTable_MergeTable=function MergeTable(_ref4){var sourceData=_ref4.sourceData,mergePending=_ref4.mergePending,mergeErrorMsg=_ref4.mergeErrorMsg,mergeValidationErrors=_ref4.mergeValidationErrors,executeMerge=_ref4.executeMerge,data=Object(react.useMemo)((function(){return sourceData?function getDataRows(sourceData){var pathRows=getAllPaths(sourceData).map((function(path,idx){return sourceData.entities.reduce((function(acc,e){var value=e.paths[path];return value&&value.value&&("entity"===value.type&&(value.value.display=getDisplay(sourceData,value.value.model,value.value.key)),"entity-list"===value.type&&(value.value=value.value.map((function(f){return f.display=getDisplay(sourceData,f.model,f.key),f})))),Object.assign({},acc,defineProperty_default()({},e.key,value))}),{__key:path})})),relationRows=sourceData_getAllRelations(sourceData).map((function(relation,idx){return sourceData.relations.filter((function(r){return r.relationName===relation})).reduce((function(acc,val){return Object.assign({},acc,defineProperty_default()({},val.entityKey,{type:"relations",value:{keys:val.keys,totalKeys:val.totalKeys,relationEntity:val.relationEntity}}))}),{__key:relation})})),sorting=sourceData_getSortedPathsAndRelations(sourceData);return[].concat(toConsumableArray_default()(pathRows),toConsumableArray_default()(relationRows)).sort((function(a,b){return sorting.findIndex((function(e){return e===a.__key}))-sorting.findIndex((function(e){return e===b.__key}))}))}(sourceData):[]}),[sourceData]),columns=Object(react.useMemo)((function(){return sourceData?function getColumnDefinition(sourceData,ColumnHeaderRenderer,PathCellRenderer,LabelCellRenderer){var pathColumns=sourceData.entities.map((function(entity){return{id:entity.key,entityKey:entity.key,resizable:!0,sorting:{sortable:!1},CellRenderer:PathCellRenderer,HeaderRenderer:function HeaderRenderer(props){return Object(jsx_runtime.jsx)(ColumnHeaderRenderer,Object.assign({},props,{entityKey:entity.key,label:getDisplay(sourceData,entity.model,entity.key)}))}}}));return[{id:"column-label",label:"",resizable:!0,sorting:{sortable:!1},CellRenderer:function CellRenderer(props){return Object(jsx_runtime.jsx)(LabelCellRenderer,Object.assign({},props,{sourceData:sourceData,allPaths:sourceData_getSortedPathsAndRelations(sourceData)}))}}].concat(toConsumableArray_default()(pathColumns))}(sourceData,ColumnHeaderRendererContainer,CellRendererContainer,MergeTable_LabelCellRenderer):[]}),[sourceData]);return mergePending?MergeTable_ref5:Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(StyledButtonWrapper,{children:Object(jsx_runtime.jsx)(StyledButton,{onClick:executeMerge,look:"raised",ink:"primary",disabled:null===sourceData,children:MergeTable_ref6})}),Object(jsx_runtime.jsxs)(StyledTableWrapper,{children:[Object(jsx_runtime.jsx)(MergeTable_MergeErrors,{sourceData:sourceData,mergeErrorMsg:mergeErrorMsg,mergeValidationErrors:mergeValidationErrors}),Object(jsx_runtime.jsx)(Table.a,{columns:columns,data:data,selectionStyle:"none",dataLoadingInProgress:null===sourceData,onColumnPositionChange:function onColumnPositionChange(){}})]})]})};MergeTable_MergeTable.__docgenInfo={description:"",methods:[],displayName:"MergeTable",props:{sourceData:{type:{name:"custom",raw:"sourceDataPropType"},required:!1,description:""},mergePending:{type:{name:"bool"},required:!0,description:""},mergeErrorMsg:{type:{name:"string"},required:!1,description:""},mergeValidationErrors:{type:{name:"custom",raw:"mergeValidationErrorsPropTypes"},required:!1,description:""},executeMerge:{type:{name:"func"},required:!0,description:""}}};var components_MergeTable_MergeTable=MergeTable_MergeTable;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeTable/MergeTable.js"]={name:"MergeTable",docgenInfo:MergeTable_MergeTable.__docgenInfo,path:"packages/merge/src/components/MergeTable/MergeTable.js"});var mapActionCreators={executeMerge:function executeMerge(){return{type:"merge/EXECUTE_MERGE"}}},components_MergeTable=Object(es.connect)((function mapStateToProps(state){return{sourceData:state.merge.sourceData,mergePending:state.merge.mergePending,mergeErrorMsg:state.merge.mergeErrorMsg,mergeValidationErrors:state.merge.mergeValidationErrors}}),mapActionCreators)(Object(injectIntl.c)(components_MergeTable_MergeTable)),groupBy=__webpack_require__(2172),groupBy_default=__webpack_require__.n(groupBy);function StyledComponents_templateObject4(){var data=taggedTemplateLiteral_default()(["\n  display: flex;\n  align-items: center;\n  color: ",";\n  font-size: ",";\n"]);return StyledComponents_templateObject4=function _templateObject4(){return data},data}function StyledComponents_templateObject3(){var data=taggedTemplateLiteral_default()(["\n  padding: "," 0 0 ",";\n"]);return StyledComponents_templateObject3=function _templateObject3(){return data},data}function StyledComponents_templateObject2(){var data=taggedTemplateLiteral_default()(["\n  margin-bottom: ",";\n\n  && {\n    p {\n      margin-bottom: 0;\n    }\n  }\n"]);return StyledComponents_templateObject2=function _templateObject2(){return data},data}function StyledComponents_templateObject(){var data=taggedTemplateLiteral_default()(["\n  display: grid;\n  align-items: center;\n  grid-template-columns: "," 1fr;\n  grid-column-gap: ",";\n  margin-bottom: ",";\n"]);return StyledComponents_templateObject=function _templateObject(){return data},data}var StyledSummarySuccessWrapper=styled_components_browser_esm.default.div(StyledComponents_templateObject(),modularScale.a.font(10),modularScale.a.space(-.5),modularScale.a.space(-.7)),StyledMessageWrapper=styled_components_browser_esm.default.div(StyledComponents_templateObject2(),modularScale.a.space(-.7)),StyledResultsWrapper=styled_components_browser_esm.default.div(StyledComponents_templateObject3(),modularScale.a.space(-1),modularScale.a.space(0)),StyledComponents_StyledIconWrapper=styled_components_browser_esm.default.span(StyledComponents_templateObject4(),resolveThemePath.a.color("signal.success.text"),modularScale.a.font(10)),MergeSummary_ref4=Object(jsx_runtime.jsx)(message.a,{id:"client.merge.close"}),MergeSummary_ref5=Object(jsx_runtime.jsxs)(StyledSummarySuccessWrapper,{children:[Object(jsx_runtime.jsx)(StyledComponents_StyledIconWrapper,{children:Object(jsx_runtime.jsx)(LazyIcon.a,{icon:"check"})}),Object(jsx_runtime.jsx)(Typography.a.P,{children:Object(jsx_runtime.jsx)(message.a,{id:"client.merge.summary.success"})})]}),MergeSummary_ref6=Object(jsx_runtime.jsx)(Typography.a.P,{children:Object(jsx_runtime.jsx)(message.a,{id:"client.merge.summary.successHint"})}),_ref7=Object(jsx_runtime.jsxs)(Typography.a.P,{children:[Object(jsx_runtime.jsx)(message.a,{id:"client.merge.summary.notCopiedRelations"}),":"]}),MergeSummary_ref8=Object(jsx_runtime.jsxs)(Typography.a.P,{children:[Object(jsx_runtime.jsx)(message.a,{id:"client.merge.summary.notDeletedEntities"}),":"]}),MergeSummary_ref9=Object(jsx_runtime.jsx)(Typography.a.P,{children:Object(jsx_runtime.jsx)(message.a,{id:"client.merge.summary.permission"})}),MergeSummary_MergeSummary=function MergeSummary(_ref){var mergeResponse=_ref.mergeResponse,navigationStrategy=_ref.navigationStrategy,close=_ref.close,mapToEntityList=function mapToEntityList(entities){return Object.entries(groupBy_default()(entities,(function(e){return e.entityLabel}))).map((function(_ref2){var _ref3=slicedToArray_default()(_ref2,2),entityLabel=_ref3[0],list=_ref3[1],model=entities.find((function(e){return e.entityLabel===entityLabel})).entity,keys=list.map((function(e){return e.pk}));return Object(jsx_runtime.jsxs)("span",{children:[entityLabel," ",Object(jsx_runtime.jsx)(manyRelationEntityCount_ManyRelationEntityCount,{model:model,keys:keys,totalKeys:keys.length,navigationStrategy:navigationStrategy})]},model)})).reduce((function(prev,curr){return null===prev?[curr]:[].concat(toConsumableArray_default()(prev),[", ",curr])}),null)},notCopiedRelations=mapToEntityList(mergeResponse.notCopiedRelations),notDeletedEntities=mapToEntityList(mergeResponse.notDeletedEntities);return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(StyledButtonWrapper,{children:Object(jsx_runtime.jsx)(StyledButton,{onClick:close,look:"raised",ink:"primary",children:MergeSummary_ref4})}),Object(jsx_runtime.jsxs)(StyledResultsWrapper,{children:[MergeSummary_ref5,(mergeResponse.notCopiedRelations.length>0||mergeResponse.notDeletedEntities.length>0)&&MergeSummary_ref6,mergeResponse.notCopiedRelations.length>0&&Object(jsx_runtime.jsxs)(StyledMessageWrapper,{children:[_ref7,Object(jsx_runtime.jsx)(Typography.a.B,{children:notCopiedRelations})]}),mergeResponse.notDeletedEntities.length>0&&Object(jsx_runtime.jsxs)(StyledMessageWrapper,{children:[MergeSummary_ref8,Object(jsx_runtime.jsx)(Typography.a.B,{children:notDeletedEntities})]}),mergeResponse.showPermissionMessage&&MergeSummary_ref9]})]})};MergeSummary_MergeSummary.__docgenInfo={description:"",methods:[],displayName:"MergeSummary",props:{mergeResponse:{type:{name:"shape",value:{notCopiedRelations:{name:"arrayOf",value:{name:"custom",raw:"entityWarningPropType"},required:!1},notDeletedEntities:{name:"arrayOf",value:{name:"custom",raw:"entityWarningPropType"},required:!1},showPermissionMessage:{name:"bool",required:!0}}},required:!1,description:""},navigationStrategy:{type:{name:"custom",raw:"navigationStrategy.propTypes"},required:!1,description:""},close:{type:{name:"func"},required:!0,description:""}}};var components_MergeSummary_MergeSummary=MergeSummary_MergeSummary;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeSummary/MergeSummary.js"]={name:"MergeSummary",docgenInfo:MergeSummary_MergeSummary.__docgenInfo,path:"packages/merge/src/components/MergeSummary/MergeSummary.js"});var MergeSummaryContainer_mapActionCreators={close:function close(){return{type:"merge/CLOSE"}}},components_MergeSummary=Object(es.connect)((function mapStateToProps(state){return{mergeResponse:state.merge.mergeResponse,navigationStrategy:state.input.navigationStrategy}}),MergeSummaryContainer_mapActionCreators)(Object(injectIntl.c)(components_MergeSummary_MergeSummary));function Merge_StyledComponents_templateObject(){var data=taggedTemplateLiteral_default()(["\n  height: 100%;\n  overflow: hidden;\n  background-color: ",";\n  display: flex;\n  flex-direction: column;\n"]);return Merge_StyledComponents_templateObject=function _templateObject(){return data},data}var StyledMerge=styled_components_browser_esm.default.div(Merge_StyledComponents_templateObject(),resolveThemePath.a.color("paper")),Merge_ref2=Object(jsx_runtime.jsx)(components_MergeSummary,{}),Merge_ref3=Object(jsx_runtime.jsx)(components_MergeTable,{}),Merge_Merge=function Merge(_ref){var initialize=_ref.initialize,mergeDone=_ref.mergeDone;return Object(react.useEffect)((function(){initialize()}),[]),Object(jsx_runtime.jsx)(StyledMerge,{children:mergeDone?Merge_ref2:Merge_ref3})};Merge_Merge.displayName="Merge",Merge_Merge.__docgenInfo={description:"",methods:[],displayName:"Merge",props:{initialize:{type:{name:"func"},required:!0,description:""},mergeDone:{type:{name:"bool"},required:!0,description:""}}};var components_Merge_Merge=Merge_Merge;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/Merge/Merge.js"]={name:"Merge",docgenInfo:Merge_Merge.__docgenInfo,path:"packages/merge/src/components/Merge/Merge.js"});var MergeContainer_mapActionCreators={initialize:function initialize(){return{type:"merge/INITIALIZE"}}},components_Merge=Object(es.connect)((function mapStateToProps(state){return{mergeDone:!!state.merge.mergeResponse}}),MergeContainer_mapActionCreators)(Object(injectIntl.c)(components_Merge_Merge)),regenerator=__webpack_require__(3),regenerator_default=__webpack_require__.n(regenerator),redux_saga_effects_npm_proxy_esm=__webpack_require__(2),rest=__webpack_require__(19),uniq=__webpack_require__(270),uniq_default=__webpack_require__.n(uniq),_marked=regenerator_default.a.mark(mainSagas),_marked2=regenerator_default.a.mark(sagas_initialize),_marked3=regenerator_default.a.mark(loadSourceData),_marked4=regenerator_default.a.mark(getMergeBody),_marked5=regenerator_default.a.mark(sagas_executeMerge),_marked6=regenerator_default.a.mark(sagas_close),mergeSelector=function mergeSelector(state){return state.merge};function mainSagas(){return regenerator_default.a.wrap((function mainSagas$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,Object(redux_saga_effects_npm_proxy_esm.a)([Object(redux_saga_effects_npm_proxy_esm.j)("merge/INITIALIZE",sagas_initialize),Object(redux_saga_effects_npm_proxy_esm.j)("merge/EXECUTE_MERGE",sagas_executeMerge),Object(redux_saga_effects_npm_proxy_esm.j)("merge/CLOSE",sagas_close)]);case 2:case"end":return _context.stop()}}),_marked)}function sagas_initialize(){var _yield$select,selection;return regenerator_default.a.wrap((function initialize$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,Object(redux_saga_effects_npm_proxy_esm.f)(mergeSelector);case 2:return _yield$select=_context2.sent,selection=_yield$select.selection,_context2.next=6,Object(redux_saga_effects_npm_proxy_esm.b)(loadSourceData,selection);case 6:case"end":return _context2.stop()}}),_marked2)}function loadSourceData(selection){var options,response,sourceData;return regenerator_default.a.wrap((function loadSourceData$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return"merge/sourceData",options={method:"POST",body:selection},_context3.next=4,Object(redux_saga_effects_npm_proxy_esm.b)(rest.a.requestSaga,"merge/sourceData",options);case 4:return response=_context3.sent,sourceData=response.body,_context3.next=8,Object(redux_saga_effects_npm_proxy_esm.e)(setSourceData(sourceData));case 8:return _context3.next=10,Object(redux_saga_effects_npm_proxy_esm.e)(actions_setTargetEntity(sourceData.entities[0].key));case 10:case"end":return _context3.stop()}}),_marked3)}function getMergeBody(){var _yield$select2,selection,selected,sourceData,paths,_loop,_i,_Object$entries,_ref3,_ref2,name,entityKey,_loop2,_i2,_Object$entries2,_ref6,_ref5,_name2,obj,mergeRelations;return regenerator_default.a.wrap((function getMergeBody$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,Object(redux_saga_effects_npm_proxy_esm.f)(mergeSelector);case 2:for(_yield$select2=_context4.sent,selection=_yield$select2.selection,selected=_yield$select2.selected,sourceData=_yield$select2.sourceData,paths={},_loop=function _loop(name,entityKey){var path=sourceData.entities.find((function(e){return e.key===entityKey})).paths[name];path.writable&&("entity"===path.type?null===path.value?paths[name]=null:paths[name]={key:path.value.key}:paths[name]=entityKey)},_i=0,_Object$entries=Object.entries(selected.single);_i<_Object$entries.length;_i++)_ref3=_Object$entries[_i],_ref2=slicedToArray_default()(_ref3,2),name=_ref2[0],entityKey=_ref2[1],_loop(name,entityKey);for(_loop2=function _loop2(obj,_name){paths[_name]=[],Object.keys(obj).forEach((function(value){return paths[_name].push({key:value})}))},_i2=0,_Object$entries2=Object.entries(selected.multiple);_i2<_Object$entries2.length;_i2++)_ref6=_Object$entries2[_i2],_ref5=slicedToArray_default()(_ref6,2),_name2=_ref5[0],obj=_ref5[1],_loop2(obj,_name2);return mergeRelations=uniq_default()(sourceData.relations.map((function(r){return r.relationName}))).map((function(relationName){return{relationName:relationName,sourceKey:selected.multipleAll[relationName]||[]}})),_context4.abrupt("return",{selection:selection,targetEntity:{key:selected.targetEntity,paths:paths},mergeRelations:mergeRelations});case 13:case"end":return _context4.stop()}}),_marked4)}function sagas_executeMerge(){var resource,options,response;return regenerator_default.a.wrap((function executeMerge$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return resource="merge/merge",_context5.t0=[400,500],_context5.t1={"X-Client-Questions":"true"},_context5.next=5,Object(redux_saga_effects_npm_proxy_esm.b)(getMergeBody);case 5:return _context5.t2=_context5.sent,options={method:"POST",acceptedStatusCodes:_context5.t0,headers:_context5.t1,body:_context5.t2},_context5.next=9,Object(redux_saga_effects_npm_proxy_esm.b)(rest.a.requestSaga,resource,options);case 9:if(200!==(response=_context5.sent).status){_context5.next=15;break}return _context5.next=13,Object(redux_saga_effects_npm_proxy_esm.e)(setMergeResponse(response.body));case 13:_context5.next=22;break;case 15:if(!response.body||"VALIDATION_FAILED"!==response.body.errorCode){_context5.next=20;break}return _context5.next=18,Object(redux_saga_effects_npm_proxy_esm.e)(setMergeError(null,response.body.errors));case 18:_context5.next=22;break;case 20:return _context5.next=22,Object(redux_saga_effects_npm_proxy_esm.e)(setMergeError(response.body.message,[]));case 22:case"end":return _context5.stop()}}),_marked5)}function sagas_close(){var _yield$select3,sourceData,entities,remoteEvents;return regenerator_default.a.wrap((function close$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,Object(redux_saga_effects_npm_proxy_esm.f)(mergeSelector);case 2:return _yield$select3=_context6.sent,sourceData=_yield$select3.sourceData,entities=sourceData.entities.map((function(entitiy){return{entityName:entitiy.model,key:entitiy.key}})),remoteEvents=[{type:"entity-update-event",payload:{entities:entities}}],_context6.next=8,Object(redux_saga_effects_npm_proxy_esm.e)(externalEvents.a.fireExternalEvent("onSuccess",{remoteEvents:remoteEvents}));case 8:case"end":return _context6.stop()}}),_marked6)}var _ACTION_HANDLERS,omit=__webpack_require__(288),omit_default=__webpack_require__.n(omit),setWith=__webpack_require__(5196),setWith_default=__webpack_require__.n(setWith),reducer_setTargetEntityMultiple=function setTargetEntityMultiple(multiple,entity){for(var _loop=function _loop(key,obj){"entity-list"===obj.type&&obj.value.map((function(e){return e.key})).forEach((function(relatedEntityKey){setWith_default()(multiple,[key,relatedEntityKey],entity.key,Object)}))},_i2=0,_Object$entries2=Object.entries(entity.paths);_i2<_Object$entries2.length;_i2++){var _ref12=_Object$entries2[_i2],_ref11=slicedToArray_default()(_ref12,2);_loop(_ref11[0],_ref11[1])}},ACTION_HANDLERS=(_ACTION_HANDLERS={},defineProperty_default()(_ACTION_HANDLERS,"merge/SET_SELECTION",reducer.a.singleTransferReducer("selection")),defineProperty_default()(_ACTION_HANDLERS,"merge/SET_SOURCE_DATA",reducer.a.singleTransferReducer("sourceData")),defineProperty_default()(_ACTION_HANDLERS,"merge/EXECUTE_MERGE",(function executeMerge(state){return Object.assign({},state,{mergePending:!0})})),defineProperty_default()(_ACTION_HANDLERS,"merge/SET_MERGE_RESPONSE",(function mergeResponse(state,_ref){var mergeResponse=_ref.payload.mergeResponse;return Object.assign({},state,{mergePending:!1,mergeResponse:mergeResponse})})),defineProperty_default()(_ACTION_HANDLERS,"merge/SET_MERGE_ERROR",(function mergeErrors(state,_ref2){var _ref2$payload=_ref2.payload,errorMsg=_ref2$payload.errorMsg,validationErrors=_ref2$payload.validationErrors;return Object.assign({},state,{mergePending:!1,mergeErrorMsg:errorMsg,mergeValidationErrors:validationErrors})})),defineProperty_default()(_ACTION_HANDLERS,"merge/SET_SELECTED_SINGLE",(function setSelectedSingle(state,_ref3){var _ref3$payload=_ref3.payload,name=_ref3$payload.name,entityKey=_ref3$payload.entityKey;return Object.assign({},state,{selected:Object.assign({},state.selected,{single:Object.assign({},state.selected.single,defineProperty_default()({},name,entityKey))})})})),defineProperty_default()(_ACTION_HANDLERS,"merge/SET_SELECTED_MULTIPLE",(function setSelectedMultiple(state,_ref4){var multiple,_ref4$payload=_ref4.payload,name=_ref4$payload.name,entityKey=_ref4$payload.entityKey,relatedEntityKey=_ref4$payload.relatedEntityKey;return _ref4$payload.isSelected?multiple=Object.assign({},state.selected.multiple,defineProperty_default()({},name,Object.assign({},state.selected.multiple[name],defineProperty_default()({},relatedEntityKey,entityKey)))):(multiple=Object.assign({},state.selected.multiple))[name]=omit_default()(multiple[name],[relatedEntityKey]),Object.assign({},state,{selected:Object.assign({},state.selected,{multiple:multiple})})})),defineProperty_default()(_ACTION_HANDLERS,"merge/SET_SELECTED_MULTIPLE_ALL",(function setSelectedMultipleAll(state,_ref5){var array,_ref5$payload=_ref5.payload,name=_ref5$payload.name,entityKey=_ref5$payload.entityKey;return array=_ref5$payload.isSelected?[].concat(toConsumableArray_default()(state.selected.multipleAll[name]||[]),[entityKey]):state.selected.multipleAll[name].filter((function(key){return key!==entityKey})),Object.assign({},state,{selected:Object.assign({},state.selected,{multipleAll:Object.assign({},state.selected.multipleAll,defineProperty_default()({},name,array))})})})),defineProperty_default()(_ACTION_HANDLERS,"merge/SET_TARGET_ENTITY",(function setTargetEntity(state,_ref6){for(var entityKey=_ref6.payload.entityKey,single={},multiple={},targetEntity=state.sourceData.entities.find((function(e){return e.key===entityKey})),_i=0,_Object$entries=Object.entries(targetEntity.paths);_i<_Object$entries.length;_i++){var _ref9=_Object$entries[_i],_ref8=slicedToArray_default()(_ref9,2),_key=_ref8[0];"entity-list"!==_ref8[1].type&&(single[_key]=entityKey)}state.sourceData.entities.filter((function(e){return e.key!==entityKey})).forEach((function(e){return reducer_setTargetEntityMultiple(multiple,e)})),reducer_setTargetEntityMultiple(multiple,targetEntity);var multipleAll=state.sourceData.relations.reduce((function(acc,val){return Object.assign({},acc,defineProperty_default()({},val.relationName,[].concat(toConsumableArray_default()(acc[val.relationName]||[]),[val.entityKey])))}),{});return Object.assign({},state,{selected:Object.assign({},state.selected,{targetEntity:entityKey,single:single,multiple:multiple,multipleAll:multipleAll})})})),_ACTION_HANDLERS),initialState={selection:null,sourceData:null,mergePending:!1,mergeResponse:null,mergeErrorMsg:null,mergeValidationErrors:[],selected:{targetEntity:null,single:{},multiple:{},multipleAll:{}}};function reducer_reducer(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:initialState,action=arguments.length>1?arguments[1]:void 0,handler=ACTION_HANDLERS[action.type];return handler?handler(state,action):state}reducer_reducer.__docgenInfo={description:"",methods:[],displayName:"reducer"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/modules/merge/reducer.js"]={name:"reducer",docgenInfo:reducer_reducer.__docgenInfo,path:"packages/merge/src/modules/merge/reducer.js"});var merge_marked=regenerator_default.a.mark(sagas);function sagas(){return regenerator_default.a.wrap((function sagas$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,Object(redux_saga_effects_npm_proxy_esm.a)([Object(redux_saga_effects_npm_proxy_esm.d)(mainSagas)]);case 2:case"end":return _context.stop()}}),merge_marked)}var reducers={merge:reducer_reducer},reducers_sagas=[sagas],EXTERNAL_EVENTS=["emitAction","onSuccess"],main_ref=Object(jsx_runtime.jsx)(GlobalStyles.a,{}),main_ref2=Object(jsx_runtime.jsx)(notification.a.Notifications,{}),main_ref3=Object(jsx_runtime.jsx)(components_Merge,{}),main_initApp=function initApp(id,input){var events=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},publicPath=arguments.length>3?arguments[3]:void 0,store=appFactory.a.createStore(reducers,reducers_sagas,input,"merge");actionEmitter.a.addToStore(store,events.emitAction),externalEvents.a.addToStore(store,events);var handleNotifications=!events.emitAction;notification.a.addToStore(store,handleNotifications);var content=Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[main_ref,handleNotifications&&main_ref2,main_ref3]});return appFactory.a.createApp("merge",content,store,{input:input,events:events,actions:[setSelection(input.selection)],publicPath:publicPath,textResourceModules:["component","common","merge"]})},MergeApp=function MergeApp(props){var events=EXTERNAL_EVENTS.reduce((function(events,event){return props[event]&&(events[event]=props[event]),events}),{});return main_initApp("merge",props,events).component};MergeApp.propTypes=Object.assign({selection:prop_types_default.a.object},EXTERNAL_EVENTS.reduce((function(propTypes,event){return propTypes[event]=prop_types_default.a.func,propTypes}),{}));var main=MergeApp},5222:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",(function(){return main}));var react=__webpack_require__(1),reducer=__webpack_require__(18),appFactory=__webpack_require__(58),prop_types=__webpack_require__(6),prop_types_default=__webpack_require__.n(prop_types),setData=function setData(data){return{type:"qrCode/SET_DATA",payload:{data:data}}},defineProperty=__webpack_require__(8),ACTION_HANDLERS=__webpack_require__.n(defineProperty)()({},"qrCode/SET_DATA",reducer.a.singleTransferReducer("data")),initialState={data:void 0};function reducer_reducer(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:initialState,action=arguments.length>1?arguments[1]:void 0,handler=ACTION_HANDLERS[action.type];return handler?handler(state,action):state}reducer_reducer.__docgenInfo={description:"",methods:[],displayName:"reducer"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/user-qr-action/src/modules/qrCode/reducer.js"]={name:"reducer",docgenInfo:reducer_reducer.__docgenInfo,path:"packages/user-qr-action/src/modules/qrCode/reducer.js"});var slicedToArray=__webpack_require__(31),slicedToArray_default=__webpack_require__.n(slicedToArray),regenerator=__webpack_require__(3),regenerator_default=__webpack_require__.n(regenerator),redux_saga_effects_npm_proxy_esm=(__webpack_require__(153),__webpack_require__(154),__webpack_require__(341),__webpack_require__(2)),rest=__webpack_require__(19),consoleLogger=__webpack_require__(72),_marked=regenerator_default.a.mark(sagas),_marked2=regenerator_default.a.mark(sagas_fetchData),inputSelector=function inputSelector(state){return state.input};function sagas(){return regenerator_default.a.wrap((function sagas$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,Object(redux_saga_effects_npm_proxy_esm.a)([Object(redux_saga_effects_npm_proxy_esm.i)("qrCode/FETCH_DATA",sagas_fetchData)]);case 2:case"end":return _context.stop()}}),_marked)}function sagas_fetchData(){var _yield$select,selection,userKey,query,entity,data;return regenerator_default.a.wrap((function fetchData$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,Object(redux_saga_effects_npm_proxy_esm.f)(inputSelector);case 2:return _yield$select=_context2.sent,selection=_yield$select.selection,userKey=getSingleKey(selection),query={paths:["firstname","lastname","c_address","phone_mobile","phone_company","phone_private","email","email_alternative","birthdate"]},_context2.prev=6,_context2.next=9,Object(redux_saga_effects_npm_proxy_esm.b)(rest.a.fetchEntity,"User",userKey,query);case 9:return entity=_context2.sent,data=null,entity&&(data={},Object.entries(entity.paths).forEach((function(_ref){var _ref2=slicedToArray_default()(_ref,2),path=_ref2[0],bean=_ref2[1];bean&&bean.value&&(data[path]=bean.value)}))),_context2.next=14,Object(redux_saga_effects_npm_proxy_esm.e)(setData(data));case 14:_context2.next=21;break;case 16:return _context2.prev=16,_context2.t0=_context2.catch(6),consoleLogger.a.logError("Failed to fetch data",_context2.t0),_context2.next=21,Object(redux_saga_effects_npm_proxy_esm.e)(setData(null));case 21:case"end":return _context2.stop()}}),_marked2,null,[[6,16]])}var getSingleKey=function getSingleKey(selection){if("User"!==selection.entityName)throw new Error("Only selection of User supported");if("ID"!==selection.type)throw new Error("Only ID selection type supported");if(!selection.ids||1!==selection.ids.length)throw new Error("Exactly one user must be selected");return selection.ids[0]},reducers={qrCode:reducer_reducer},reducers_sagas=[sagas],es=__webpack_require__(25),taggedTemplateLiteral=__webpack_require__(13),taggedTemplateLiteral_default=__webpack_require__.n(taggedTemplateLiteral),LazyLoadingSpinner=__webpack_require__(4964),Typography=__webpack_require__(17),QRCode=__webpack_require__(2276),styled_components_browser_esm=__webpack_require__(5),message=__webpack_require__(1974),appendField=(__webpack_require__(30),__webpack_require__(195),__webpack_require__(75),function appendField(data,fieldName,outputPrefix,output){var handler=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(fieldData){return fieldData};return data[fieldName]&&data[fieldName].length>0&&(output+="".concat(outputPrefix,":").concat(handler(data[fieldName]),";")),output}),jsx_runtime=__webpack_require__(0);function _templateObject2(){var data=taggedTemplateLiteral_default()(["\n  margin: 0;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n"]);return _templateObject2=function _templateObject2(){return data},data}function _templateObject(){var data=taggedTemplateLiteral_default()(["\n  width: 148px;\n  height: 148px;\n  position: relative;\n  align-self: center;\n"]);return _templateObject=function _templateObject(){return data},data}var StyledContainer=styled_components_browser_esm.default.div(_templateObject()),StyledContent=styled_components_browser_esm.default.div(_templateObject2()),UserQrCode_ref2=Object(jsx_runtime.jsx)(LazyLoadingSpinner.a,{}),_ref3=Object(jsx_runtime.jsx)(Typography.a.P,{children:Object(jsx_runtime.jsx)(message.a,{id:"client.user-qr-action.fetchFailed"})}),UserQrCode_UserQrCode=function UserQrCode(_ref){var content,data=_ref.data,fetchData=_ref.fetchData;if(Object(react.useEffect)((function(){fetchData()}),[]),void 0===data)content=UserQrCode_ref2;else if(null===data)content=_ref3;else{var string=function buildUserMecardString(data){var string="MECARD:N:".concat(data.lastname,",").concat(data.firstname,";");return string=appendField(data,"c_address","ADR",string,(function(address){return address.replace(/\s*<br\s?\/?>\s*/gi,",")})),string=appendField(data,"phone_mobile","TEL",string),string=appendField(data,"phone_company","TEL",string),string=appendField(data,"phone_private","TEL",string),string=appendField(data,"email","EMAIL",string),string=appendField(data,"email_alternative","EMAIL",string),string=appendField(data,"birthdate","BDAY",string,(function(date){return date.replace(/-/gi,"")}))}(data);content=Object(jsx_runtime.jsx)(QRCode.a,{value:string})}return Object(jsx_runtime.jsx)(StyledContainer,{children:Object(jsx_runtime.jsx)(StyledContent,{children:content})})};UserQrCode_UserQrCode.displayName="UserQrCode",UserQrCode_UserQrCode.__docgenInfo={description:"",methods:[],displayName:"UserQrCode",props:{data:{type:{name:"shape",value:{firstname:{name:"string",required:!0},lastname:{name:"string",required:!0},c_address:{name:"string",required:!1},phone_mobile:{name:"string",required:!1},phone_company:{name:"string",required:!1},phone_private:{name:"string",required:!1},email:{name:"string",required:!1},email_alternative:{name:"string",required:!1},birthdate:{name:"string",required:!1}}},required:!1,description:""},fetchData:{type:{name:"func"},required:!0,description:""}}};var components_UserQrCode_UserQrCode=UserQrCode_UserQrCode;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/user-qr-action/src/components/UserQrCode/UserQrCode.js"]={name:"UserQrCode",docgenInfo:UserQrCode_UserQrCode.__docgenInfo,path:"packages/user-qr-action/src/components/UserQrCode/UserQrCode.js"});var components_UserQrCode=components_UserQrCode_UserQrCode,mapActionCreators={fetchData:function fetchData(){return{type:"qrCode/FETCH_DATA"}}},UserQrCodeContainer=Object(es.connect)((function mapStateToProps(state){return{data:state.qrCode.data}}),mapActionCreators)(components_UserQrCode),main_initApp=function initApp(id,input,events,publicPath){var content=Object(jsx_runtime.jsx)(UserQrCodeContainer,{selection:input.selection}),store=appFactory.a.createStore(reducers,reducers_sagas,input,"user-qr-action");return appFactory.a.createApp("user-qr-action",content,store,{input:input,events:events,actions:[],publicPath:publicPath,textResourceModules:["component","common","user-qr-action"]})},UserQrActionApp=function UserQrActionApp(props){return main_initApp(0,props).component};UserQrActionApp.propTypes={selection:prop_types_default.a.object};var main=UserQrActionApp},5223:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",(function(){return main}));__webpack_require__(79),__webpack_require__(11);var react=__webpack_require__(1),src_selection=(__webpack_require__(18),__webpack_require__(1382)),src_navigationStrategy=__webpack_require__(2282),appFactory=__webpack_require__(58),externalEvents=__webpack_require__(57),prop_types=__webpack_require__(6),prop_types_default=__webpack_require__.n(prop_types),es=__webpack_require__(25),taggedTemplateLiteral=__webpack_require__(13),taggedTemplateLiteral_default=__webpack_require__.n(taggedTemplateLiteral),LazyLoadingSpinner=__webpack_require__(4964),styled_components_browser_esm=__webpack_require__(5),jsx_runtime=__webpack_require__(0);function _templateObject(){var data=taggedTemplateLiteral_default()(["\n  text-align: center;\n  display: block;\n  margin-left: auto;\n  margin-right: auto;\n  width: 100%;\n  height: 40px;\n"]);return _templateObject=function _templateObject(){return data},data}var StyledDiv=styled_components_browser_esm.default.div(_templateObject()),CopyProgress_ref2=Object(jsx_runtime.jsx)(StyledDiv,{children:Object(jsx_runtime.jsx)(LazyLoadingSpinner.a,{size:"30px"})}),CopyProgress_CopyProgress=function CopyProgress(_ref){var startCopy=_ref.startCopy;return Object(react.useEffect)((function(){startCopy()}),[]),CopyProgress_ref2};CopyProgress_CopyProgress.displayName="CopyProgress",CopyProgress_CopyProgress.__docgenInfo={description:"",methods:[],displayName:"CopyProgress",props:{startCopy:{type:{name:"func"},required:!0,description:""}}};var components_CopyProgress_CopyProgress=CopyProgress_CopyProgress;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/copy/src/components/CopyProgress/CopyProgress.js"]={name:"CopyProgress",docgenInfo:CopyProgress_CopyProgress.__docgenInfo,path:"packages/copy/src/components/CopyProgress/CopyProgress.js"});var mapActionCreators={startCopy:function startCopy(){return{type:"copy/START_COPY"}}},components_CopyProgress=Object(es.connect)(null,mapActionCreators)(components_CopyProgress_CopyProgress),helpers_typeof=__webpack_require__(208),typeof_default=__webpack_require__.n(helpers_typeof),slicedToArray=__webpack_require__(31),slicedToArray_default=__webpack_require__.n(slicedToArray),regenerator=__webpack_require__(3),regenerator_default=__webpack_require__.n(regenerator),redux_saga_effects_npm_proxy_esm=(__webpack_require__(35),__webpack_require__(64),__webpack_require__(68),__webpack_require__(82),__webpack_require__(28),__webpack_require__(341),__webpack_require__(105),__webpack_require__(2)),rest=__webpack_require__(19),src_form=__webpack_require__(83),_marked=regenerator_default.a.mark(sagas),_marked2=regenerator_default.a.mark(copy),_marked3=regenerator_default.a.mark(getValues),_marked4=regenerator_default.a.mark(getPaths),inputSelector=function inputSelector(state){return state.input};function sagas(){return regenerator_default.a.wrap((function sagas$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,Object(redux_saga_effects_npm_proxy_esm.a)([Object(redux_saga_effects_npm_proxy_esm.j)("copy/START_COPY",copy)]);case 2:case"end":return _context.stop()}}),_marked)}function copy(){var _yield$select,selection,navigationStrategy,formName,entities,values;return regenerator_default.a.wrap((function copy$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,Object(redux_saga_effects_npm_proxy_esm.f)(inputSelector);case 2:return _yield$select=_context2.sent,selection=_yield$select.selection,navigationStrategy=_yield$select.navigationStrategy,formName=_yield$select.context.formName,_context2.next=8,Object(redux_saga_effects_npm_proxy_esm.b)(src_selection.a.getEntities,selection,rest.a.fetchEntities);case 8:if(1!==(entities=_context2.sent).keys.length){_context2.next=19;break}return _context2.next=12,Object(redux_saga_effects_npm_proxy_esm.b)(getValues,entities.entityName,entities.keys[0],formName);case 12:return values=_context2.sent,_context2.next=15,Object(redux_saga_effects_npm_proxy_esm.e)(externalEvents.a.fireExternalEvent("onCancel"));case 15:return _context2.next=17,Object(redux_saga_effects_npm_proxy_esm.b)(navigationStrategy.navigateToCreateRelative,null,{defaultValues:values});case 17:_context2.next=20;break;case 19:throw new Error("Invalid selection");case 20:case"end":return _context2.stop()}}),_marked2)}function getValues(entityName,entityKey,formName){var paths,sourceEntity;return regenerator_default.a.wrap((function getValues$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,Object(redux_saga_effects_npm_proxy_esm.b)(getPaths,formName);case 2:return paths=_context3.sent,_context3.next=5,Object(redux_saga_effects_npm_proxy_esm.b)(rest.a.fetchEntity,entityName,entityKey,{paths:paths});case 5:return sourceEntity=_context3.sent,_context3.abrupt("return",Object.entries(sourceEntity.paths).map((function(_ref){var _ref2=slicedToArray_default()(_ref,2),id=_ref2[0],value=_ref2[1].value;return null===value||""===value||Array.isArray(value)&&0===value.length?null:{id:id,value:Array.isArray(value)?value.map((function(v){return v.key})):"object"===typeof_default()(value)?value.key:value}})).filter((function(d){return!!d})));case 7:case"end":return _context3.stop()}}),_marked3)}function getPaths(formName){var formDefinition,fields;return regenerator_default.a.wrap((function getPaths$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,Object(redux_saga_effects_npm_proxy_esm.b)(rest.a.fetchForm,formName,"create");case 2:return formDefinition=_context4.sent,_context4.next=5,Object(redux_saga_effects_npm_proxy_esm.b)(src_form.a.getFieldDefinitions,formDefinition);case 5:return fields=_context4.sent,_context4.abrupt("return",fields.filter((function(f){return!0!==f.ignoreCopy&&f.path})).map((function(e){return e.path})));case 7:case"end":return _context4.stop()}}),_marked4)}var reducers={},reducers_sagas=[sagas],EXTERNAL_EVENTS=["emitAction","onSuccess","onCancel","onError"],main_ref=Object(jsx_runtime.jsx)(components_CopyProgress,{}),main_initApp=function initApp(id,input,events,publicPath){var content=main_ref,store=appFactory.a.createStore(reducers,reducers_sagas,input,"copy");return externalEvents.a.addToStore(store,events),appFactory.a.createApp("copy",content,store,{input:input,events:events,actions:[],publicPath:publicPath,textResourceModules:["component","common","copy"]})};appFactory.a.registerAppInRegistry("copy",main_initApp);var CopyApp=function CopyApp(props){var events=EXTERNAL_EVENTS.reduce((function(events,event){return props[event]&&(events[event]=props[event]),events}),{});return main_initApp(0,props,events).component};CopyApp.propTypes=Object.assign({selection:src_selection.a.propType.isRequired,navigationStrategy:src_navigationStrategy.a.propTypes.isRequired,context:prop_types_default.a.shape({formName:prop_types_default.a.string})},EXTERNAL_EVENTS.reduce((function(propTypes,event){return propTypes[event]=prop_types_default.a.func,propTypes}),{}));var main=CopyApp}}]);