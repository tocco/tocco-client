(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{4987:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__(135),__webpack_require__(36),__webpack_require__(65);var _ACTION_HANDLERS,classCallCheck=__webpack_require__(116),classCallCheck_default=__webpack_require__.n(classCallCheck),createClass=__webpack_require__(117),createClass_default=__webpack_require__.n(createClass),inherits=__webpack_require__(118),inherits_default=__webpack_require__.n(inherits),possibleConstructorReturn=__webpack_require__(119),possibleConstructorReturn_default=__webpack_require__.n(possibleConstructorReturn),getPrototypeOf=__webpack_require__(73),getPrototypeOf_default=__webpack_require__.n(getPrototypeOf),react=(__webpack_require__(80),__webpack_require__(6),__webpack_require__(1)),react_default=__webpack_require__.n(react),reducer=__webpack_require__(18),appFactory=(__webpack_require__(2278),__webpack_require__(58)),notification=__webpack_require__(26),errorLogging=__webpack_require__(95),actionEmitter=__webpack_require__(76),externalEvents=__webpack_require__(57),actions=__webpack_require__(148),formData=__webpack_require__(419),keyDown=__webpack_require__(929),main=__webpack_require__(928),src_main=__webpack_require__(1381),es_reducer=__webpack_require__(916),defineProperty=__webpack_require__(8),defineProperty_default=__webpack_require__.n(defineProperty),SET_LAST_SAVE=(__webpack_require__(980),"entityDetail/SET_LAST_SAVE"),setFormDefinition=function setFormDefinition(formDefinition){return{type:"entityDetail/SET_FORM_DEFINITION",payload:{formDefinition:formDefinition}}},loadDetailView=function loadDetailView(modelPaths,entityId){return{type:"entityDetail/LOAD_DETAIL_VIEW",payload:{modelPaths:modelPaths,entityId:entityId}}},setEntity=function setEntity(entity){return{type:"entityDetail/SET_ENTITY",payload:{entity:entity}}},actions_submitForm=function submitForm(){return{type:"entityDetail/SUBMIT_FORM"}},setLastSave=function setLastSave(){var lastSave=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return{type:SET_LAST_SAVE,payload:{lastSave:lastSave}}},setEntityModel=function setEntityModel(entityModel){return{type:"entityDetail/SET_ENTITY_MODEL",payload:{entityModel:entityModel}}},unloadDetailView=function unloadDetailView(){return{type:"entityDetail/UNLOAD_DETAIL_VIEW"}},setTouched=function setTouched(touched){return{type:"entityDetail/SET_TOUCHED",payload:{touched:touched}}},setEntityName=function setEntityName(entityName){return{type:"entityDetail/SET_ENTITY_NAME",payload:{entityName:entityName}}},setEntityId=function setEntityId(entityId){return{type:"entityDetail/SET_ENTITY_ID",payload:{entityId:entityId}}},setMode=function setMode(mode){return{type:"entityDetail/SET_MODE",payload:{mode:mode}}},setFormName=function setFormName(formName){return{type:"entityDetail/SET_FORM_NAME",payload:{formName:formName}}},setAppId=function setAppId(appId){return{type:"entityDetail/SET_APP_ID",payload:{appId:appId}}},setDefaultValues=function setDefaultValues(defaultValues){return{type:"entityDetail/SET_DEFAULT_VALUES",payload:{defaultValues:defaultValues}}},navigateToCreate=function navigateToCreate(relationName){return{type:"entityDetail/NAVIGATE_TO_CREATE",payload:{relationName:relationName}}},setFieldDefinitions=function setFieldDefinitions(fieldDefinitions){return{type:"entityDetail/SET_FIELD_DEFINITIONS",payload:{fieldDefinitions:fieldDefinitions}}},navigateToAction=function navigateToAction(definition,selection){return{type:"entityDetail/NAVIGATE_TO_ACTION",payload:{definition:definition,selection:selection}}},setMarked=function setMarked(marked){return{type:"entityDetail/SET_MARKED",payload:{marked:marked}}},ACTION_HANDLERS=(_ACTION_HANDLERS={},defineProperty_default()(_ACTION_HANDLERS,"entityDetail/SET_ENTITY_NAME",reducer.a.singleTransferReducer("entityName")),defineProperty_default()(_ACTION_HANDLERS,"entityDetail/SET_FORM_NAME",reducer.a.singleTransferReducer("formName")),defineProperty_default()(_ACTION_HANDLERS,"entityDetail/SET_ENTITY_ID",reducer.a.singleTransferReducer("entityId")),defineProperty_default()(_ACTION_HANDLERS,"entityDetail/SET_MODE",reducer.a.singleTransferReducer("mode")),defineProperty_default()(_ACTION_HANDLERS,"entityDetail/SET_FORM_DEFINITION",reducer.a.singleTransferReducer("formDefinition")),defineProperty_default()(_ACTION_HANDLERS,"entityDetail/SET_ENTITY",reducer.a.singleTransferReducer("entity")),defineProperty_default()(_ACTION_HANDLERS,SET_LAST_SAVE,reducer.a.singleTransferReducer("lastSave")),defineProperty_default()(_ACTION_HANDLERS,"entityDetail/SET_ENTITY_MODEL",reducer.a.singleTransferReducer("entityModel")),defineProperty_default()(_ACTION_HANDLERS,"entityDetail/SET_TOUCHED",reducer.a.singleTransferReducer("touched")),defineProperty_default()(_ACTION_HANDLERS,"entityDetail/SET_APP_ID",reducer.a.singleTransferReducer("appId")),defineProperty_default()(_ACTION_HANDLERS,"entityDetail/SET_DEFAULT_VALUES",reducer.a.singleTransferReducer("defaultValues")),defineProperty_default()(_ACTION_HANDLERS,"entityDetail/SET_FIELD_DEFINITIONS",reducer.a.singleTransferReducer("fieldDefinitions")),defineProperty_default()(_ACTION_HANDLERS,"entityDetail/SET_MARKED",reducer.a.singleTransferReducer("marked")),_ACTION_HANDLERS),initialState={appId:"",entityName:"",entityId:"",formName:"",mode:"",formDefinition:{},entity:{},entityModel:{},touched:!1,defaultValues:{},fieldDefinitions:[],marked:!1};function reducer_reducer(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:initialState,action=arguments.length>1?arguments[1]:void 0,handler=ACTION_HANDLERS[action.type];return handler?handler(state,action):state}reducer_reducer.__docgenInfo={description:"",methods:[],displayName:"reducer"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/entity-detail/src/modules/entityDetail/reducer.js"]={name:"reducer",docgenInfo:reducer_reducer.__docgenInfo,path:"packages/entity-detail/src/modules/entityDetail/reducer.js"});var toConsumableArray=__webpack_require__(22),toConsumableArray_default=__webpack_require__.n(toConsumableArray),regenerator=__webpack_require__(3),regenerator_default=__webpack_require__.n(regenerator),es_actions=(__webpack_require__(64),__webpack_require__(68),__webpack_require__(27),__webpack_require__(56),__webpack_require__(236),__webpack_require__(33),__webpack_require__(11),__webpack_require__(152),__webpack_require__(82),__webpack_require__(153),__webpack_require__(154),__webpack_require__(106),__webpack_require__(141),__webpack_require__(105),__webpack_require__(96)),getFormAsyncErrors=__webpack_require__(1404),getFormSubmitErrors=__webpack_require__(1402),getFormSyncErrors=__webpack_require__(1403),getFormValues=__webpack_require__(547),es_isValid=__webpack_require__(2203),SubmissionError=__webpack_require__(698),actionTypes=__webpack_require__(28),src_form=__webpack_require__(83),remoteEvents=__webpack_require__(546),rest=__webpack_require__(19),api=__webpack_require__(133),redux_saga_effects_npm_proxy_esm=__webpack_require__(2),diff=__webpack_require__(4981),components_message=__webpack_require__(1972),relative=__webpack_require__(1971),_marked=(__webpack_require__(237),__webpack_require__(75),regenerator_default.a.mark(updateEntity)),_marked2=regenerator_default.a.mark(createEntity);function updateEntity(entity){var paths,options,resource,resp,_args=arguments;return regenerator_default.a.wrap((function updateEntity$(_context){for(;;)switch(_context.prev=_context.next){case 0:return paths=_args.length>1&&void 0!==_args[1]?_args[1]:[],options={method:"PATCH",queryParams:{_paths:paths.join(",")},body:entity,acceptedErrorCodes:["VALIDATION_FAILED"],acceptedStatusCodes:[404,409]},resource="entities/2.0/".concat(entity.model,"/").concat(entity.key),_context.next=5,Object(redux_saga_effects_npm_proxy_esm.b)(rest.a.requestSaga,resource,options);case 5:if("VALIDATION_FAILED"!==(resp=_context.sent).body.errorCode){_context.next=8;break}throw new SubmissionError.a(src_form.a.validationErrorToFormError(entity,resp.body.errors));case 8:if(409!==resp.status||!resp.body.information){_context.next=10;break}throw new rest.a.InformationError(resp.body.information);case 10:return _context.abrupt("return",resp.body);case 11:case"end":return _context.stop()}}),_marked)}function createEntity(entity){var paths,options,resource,resp,location,id,_args2=arguments;return regenerator_default.a.wrap((function createEntity$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return paths=_args2.length>1&&void 0!==_args2[1]?_args2[1]:[],options={method:"POST",queryParams:{_paths:paths.join(",")},body:entity,acceptedErrorCodes:["VALIDATION_FAILED"],acceptedStatusCodes:[409]},resource="entities/2.0/".concat(entity.model),_context2.next=5,Object(redux_saga_effects_npm_proxy_esm.b)(rest.a.requestSaga,resource,options);case 5:if(201!==(resp=_context2.sent).status){_context2.next=12;break}return location=resp.headers.get("Location"),id=location.split("/").pop(),_context2.abrupt("return",id);case 12:if(!resp.body||"VALIDATION_FAILED"!==resp.body.errorCode){_context2.next=14;break}throw new SubmissionError.a(src_form.a.validationErrorToFormError(entity,resp.body.errors));case 14:if(409!==resp.status||!resp.body.information){_context2.next=16;break}throw new rest.a.InformationError(resp.body.information);case 16:throw new Error("unexpected error during save",resp);case 17:case"end":return _context2.stop()}}),_marked2)}var modes_CREATE="create",modes_UPDATE="update",taggedTemplateLiteral=__webpack_require__(13),taggedTemplateLiteral_default=__webpack_require__.n(taggedTemplateLiteral),Typography=__webpack_require__(17),styled_components_browser_esm=__webpack_require__(5),modularScale=__webpack_require__(29),lib=__webpack_require__(5143),jsx_runtime=__webpack_require__(0);function _templateObject(){var data=taggedTemplateLiteral_default()(["\n  &:not(:last-child) {\n    margin-bottom: ",";\n  }\n"]);return _templateObject=function _templateObject(){return data},data}var ErrorItems_ErrorItem=function ErrorItem(_ref){var message=_ref.message;return Object(jsx_runtime.jsx)("div",{children:Object(lib.decode)(message)})};ErrorItems_ErrorItem.displayName="ErrorItem";var StyledErrorItemWrapper=styled_components_browser_esm.default.div(_templateObject(),modularScale.a.space(.4)),ErrorItems_ref3=Object(jsx_runtime.jsx)(StyledErrorItemWrapper,{children:Object(jsx_runtime.jsx)(components_message.a,{id:"client.entity-detail.invalidFieldsError"})},"hasFieldErrors"),ErrorItems_ref4=Object(jsx_runtime.jsx)(StyledErrorItemWrapper,{children:Object(jsx_runtime.jsx)(Typography.a.H5,{children:Object(jsx_runtime.jsx)(components_message.a,{id:"client.entity-detail.invalidFieldsError"})})},"hasFieldErrors"),ErrorItems_ref5=Object(jsx_runtime.jsx)(Typography.a.H5,{children:Object(jsx_runtime.jsx)(components_message.a,{id:"client.entity-detail.validatorErrors"})}),ErrorItems_ref6=Object(jsx_runtime.jsx)(Typography.a.H5,{children:Object(jsx_runtime.jsx)(components_message.a,{id:"client.entity-detail.invalidRelationErrors"})}),components_ErrorItems_ErrorItems=function ErrorItems(_ref2){var formErrors=_ref2.formErrors,output=null,elements=[],hasFieldErrors=src_form.a.formErrorsUtil.hasFieldErrors(formErrors),hasValidatorErrors=src_form.a.formErrorsUtil.hasValidatorErrors(formErrors),hasRelatedEntityErrors=src_form.a.formErrorsUtil.hasRelatedEntityErrors(formErrors),validatorErrors=src_form.a.formErrorsUtil.getValidatorErrors(formErrors),relatedEntityErrorsCompact=src_form.a.formErrorsUtil.getRelatedEntityErrorsCompact(formErrors);if(src_form.a.formErrorsUtil.hasOutdatedError(formErrors)){var outdatedError=src_form.a.formErrorsUtil.getOutdatedError(formErrors),_selectUnit=Object(diff.a)(new Date(outdatedError.updateTimestamp)),timeStampValue=_selectUnit.value,unit=_selectUnit.unit,titleId="client.entity-detail.".concat(outdatedError.sameEntity?"outdated":"relatedOutdated","ErrorTitle");elements.push(Object(jsx_runtime.jsxs)(StyledErrorItemWrapper,{children:[Object(jsx_runtime.jsx)(Typography.a.H5,{children:Object(jsx_runtime.jsx)(components_message.a,{id:titleId,values:{model:outdatedError.model,key:outdatedError.key}})}),Object(jsx_runtime.jsx)(components_message.a,{id:"client.entity-detail.outdatedErrorDescription",values:{ago:Object(jsx_runtime.jsx)(relative.a,{value:timeStampValue,unit:unit}),user:outdatedError.updateUser}})]},"outDatedError"))}return hasFieldErrors&&elements.push(hasValidatorErrors||hasRelatedEntityErrors?ErrorItems_ref4:ErrorItems_ref3),hasValidatorErrors&&elements.push(Object(jsx_runtime.jsxs)(StyledErrorItemWrapper,{children:[ErrorItems_ref5,validatorErrors.map((function(message,idx){return Object(jsx_runtime.jsx)(ErrorItems_ErrorItem,{message:message},idx)}))]},"hasValidatorErrors")),hasRelatedEntityErrors&&elements.push(Object(jsx_runtime.jsxs)(StyledErrorItemWrapper,{children:[ErrorItems_ref6,relatedEntityErrorsCompact.map((function(message,idx){return Object(jsx_runtime.jsx)(ErrorItems_ErrorItem,{message:message},idx)}))]},"hasRelatedEntityErrors")),elements.length>0&&(output=Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:elements.map((function(el){return el}))})),output};ErrorItems_ErrorItem.__docgenInfo={description:"",methods:[],displayName:"ErrorItem",props:{message:{type:{name:"string"},required:!0,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/entity-detail/src/components/ErrorItems/ErrorItems.js"]={name:"ErrorItem",docgenInfo:ErrorItems_ErrorItem.__docgenInfo,path:"packages/entity-detail/src/components/ErrorItems/ErrorItems.js"});var detailFooter_types={NONE:"none",REDUCED:"reduced",FULL:"full"},helpers_getFooterType=function getFooterType(mode,entityModel){var useNiceFields=entityModel.useNiceFields;return mode===modes_CREATE?detailFooter_types.NONE:useNiceFields?detailFooter_types.FULL:detailFooter_types.REDUCED},helpers_paths=["create_timestamp","update_timestamp","create_user","update_user","version"],helpers_getFooterPaths=function getFooterPaths(mode,entityModel){var type=helpers_getFooterType(mode,entityModel),keyField=entityModel.keyField;switch(type){case detailFooter_types.FULL:return[keyField].concat(helpers_paths);case detailFooter_types.REDUCED:return[keyField];case detailFooter_types.NONE:default:return[]}},sagas_marked=regenerator_default.a.mark(sagas),sagas_marked2=regenerator_default.a.mark(autoComplete),_marked3=regenerator_default.a.mark(onBlur),_marked4=regenerator_default.a.mark(loadDetailFormDefinition),_marked5=regenerator_default.a.mark(loadEntity),_marked6=regenerator_default.a.mark(sagas_unloadDetailView),_marked7=regenerator_default.a.mark(loadEntityModel),_marked8=regenerator_default.a.mark(sagas_loadDetailView),_marked9=regenerator_default.a.mark(updateFormSubmit),_marked10=regenerator_default.a.mark(createFormSubmit),_marked11=regenerator_default.a.mark(sagas_touchAllFields),_marked12=regenerator_default.a.mark(handleSubmitError),_marked13=regenerator_default.a.mark(getCurrentEntityState),_marked14=regenerator_default.a.mark(submitValidate),_marked15=regenerator_default.a.mark(getEntityForSubmit),_marked17=regenerator_default.a.mark(getFormErrors),_marked18=regenerator_default.a.mark(locationFieldFocus),_marked19=regenerator_default.a.mark(focusErrorField),_marked20=regenerator_default.a.mark(handleInvalidForm),_marked21=regenerator_default.a.mark(sagas_submitForm),_marked22=regenerator_default.a.mark(sagas_fireTouched),_marked23=regenerator_default.a.mark(showNotification),_marked24=regenerator_default.a.mark(loadDisplayExpressions),_marked25=regenerator_default.a.mark(loadRelationDisplays),_marked26=regenerator_default.a.mark(enhanceEntityWithDisplayExpressions),_marked27=regenerator_default.a.mark(enhanceEntityWithDisplays),_marked28=regenerator_default.a.mark(loadData),_marked29=regenerator_default.a.mark(loadMarked),_marked30=regenerator_default.a.mark(sagas_updateMarked),_marked31=regenerator_default.a.mark(sagas_navigateToCreate),_marked32=regenerator_default.a.mark(sagas_navigateToAction),_marked33=regenerator_default.a.mark(remoteEvent),_marked34=regenerator_default.a.mark(asyncValidationStop),formInitialValueSelector=function formInitialValueSelector(state,formId){return state.form[formId].initial},entityDetailSelector=function entityDetailSelector(state){return state.entityDetail},FORM_ID="detailForm",inputSelector=function inputSelector(state){return state.input};function sagas(){return regenerator_default.a.wrap((function sagas$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,Object(redux_saga_effects_npm_proxy_esm.a)([Object(redux_saga_effects_npm_proxy_esm.j)("entityDetail/LOAD_DETAIL_VIEW",sagas_loadDetailView),Object(redux_saga_effects_npm_proxy_esm.j)("entityDetail/UNLOAD_DETAIL_VIEW",sagas_unloadDetailView),Object(redux_saga_effects_npm_proxy_esm.j)("entityDetail/TOCH_ALL_FIELDS",sagas_touchAllFields),Object(redux_saga_effects_npm_proxy_esm.i)("entityDetail/SUBMIT_FORM",sagas_submitForm),Object(redux_saga_effects_npm_proxy_esm.i)("entityDetail/FIRE_TOUCHED",sagas_fireTouched),Object(redux_saga_effects_npm_proxy_esm.i)("entityDetail/NAVIGATE_TO_CREATE",sagas_navigateToCreate),Object(redux_saga_effects_npm_proxy_esm.i)(remoteEvents.a.REMOTE_EVENT,remoteEvent),Object(redux_saga_effects_npm_proxy_esm.j)("entityDetail/NAVIGATE_TO_ACTION",sagas_navigateToAction),Object(redux_saga_effects_npm_proxy_esm.i)(actionTypes.l,onBlur),Object(redux_saga_effects_npm_proxy_esm.i)(actionTypes.m,onBlur),Object(redux_saga_effects_npm_proxy_esm.i)(actionTypes.B,asyncValidationStop),Object(redux_saga_effects_npm_proxy_esm.j)("entityDetail/UPDATE_MARKED",sagas_updateMarked),Object(redux_saga_effects_npm_proxy_esm.j)(actions.a.actions.ACTION_INVOKED,sagas_loadDetailView)]);case 2:case"end":return _context.stop()}}),sagas_marked)}function autoComplete(fieldName,autoCompleteEndpoint){var options,response,values,formValues;return regenerator_default.a.wrap((function autoComplete$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.t0=fieldName,_context2.next=3,Object(redux_saga_effects_npm_proxy_esm.b)(getEntityForSubmit);case 3:return _context2.t1=_context2.sent,_context2.t2={triggerField:_context2.t0,entity:_context2.t1},options={method:"POST",body:_context2.t2},_context2.next=8,Object(redux_saga_effects_npm_proxy_esm.b)(rest.a.requestSaga,autoCompleteEndpoint,options);case 8:return response=_context2.sent,values=response.body.values,_context2.next=12,Object(redux_saga_effects_npm_proxy_esm.f)(Object(getFormValues.a)(FORM_ID));case 12:return formValues=_context2.sent,_context2.next=15,Object(redux_saga_effects_npm_proxy_esm.a)(Object.keys(values).map((function(fieldName){var value=values[fieldName],currentFieldValue=formValues[fieldName];return"override"===value.mode||"if_empty"===value.mode&&src_form.a.isValueEmpty(currentFieldValue)?Object(redux_saga_effects_npm_proxy_esm.e)(es_actions.a.change(FORM_ID,fieldName,value.value)):null})));case 15:case"end":return _context2.stop()}}),sagas_marked2)}function onBlur(_ref){var meta,field,fieldDefinition;return regenerator_default.a.wrap((function onBlur$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return meta=_ref.meta,field=meta.field,_context3.next=4,Object(redux_saga_effects_npm_proxy_esm.f)(entityDetailSelector);case 4:if(!(fieldDefinition=_context3.sent.fieldDefinitions.find((function(fd){return fd.id===field})))||!fieldDefinition.autoCompleteEndpoint){_context3.next=8;break}return _context3.next=8,Object(redux_saga_effects_npm_proxy_esm.b)(autoComplete,field,fieldDefinition.autoCompleteEndpoint);case 8:case"end":return _context3.stop()}}),_marked3)}function loadDetailFormDefinition(formName,mode){var formDefinition,fieldDefinitions;return regenerator_default.a.wrap((function loadDetailFormDefinition$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,Object(redux_saga_effects_npm_proxy_esm.b)(rest.a.fetchForm,formName,mode);case 2:return formDefinition=_context4.sent,_context4.next=5,Object(redux_saga_effects_npm_proxy_esm.e)(setFormDefinition(formDefinition));case 5:return _context4.next=7,Object(redux_saga_effects_npm_proxy_esm.b)(src_form.a.getFieldDefinitions,formDefinition);case 7:return fieldDefinitions=_context4.sent,_context4.next=10,Object(redux_saga_effects_npm_proxy_esm.e)(setFieldDefinitions(fieldDefinitions));case 10:return _context4.abrupt("return",{formDefinition:formDefinition,fieldDefinitions:fieldDefinitions});case 11:case"end":return _context4.stop()}}),_marked4)}function loadEntity(entityName,entityId,fieldDefinitions){var formPaths,_yield$select,mode,entityModel,footerPaths,paths,entity;return regenerator_default.a.wrap((function loadEntity$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,Object(redux_saga_effects_npm_proxy_esm.b)(src_form.a.getUsedPaths,fieldDefinitions);case 2:return formPaths=_context5.sent,_context5.next=5,Object(redux_saga_effects_npm_proxy_esm.f)(entityDetailSelector);case 5:return _yield$select=_context5.sent,mode=_yield$select.mode,entityModel=_yield$select.entityModel,_context5.next=10,Object(redux_saga_effects_npm_proxy_esm.b)(helpers_getFooterPaths,mode,entityModel);case 10:return footerPaths=_context5.sent,paths=[].concat(toConsumableArray_default()(formPaths),toConsumableArray_default()(footerPaths)),_context5.next=14,Object(redux_saga_effects_npm_proxy_esm.b)(rest.a.fetchEntity,entityName,entityId,{paths:paths});case 14:return entity=_context5.sent,_context5.next=17,Object(redux_saga_effects_npm_proxy_esm.e)(setEntity(entity));case 17:return _context5.abrupt("return",entity);case 18:case"end":return _context5.stop()}}),_marked5)}function sagas_unloadDetailView(){return regenerator_default.a.wrap((function unloadDetailView$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,Object(redux_saga_effects_npm_proxy_esm.e)(setEntity(null));case 2:return _context6.next=4,Object(redux_saga_effects_npm_proxy_esm.e)(es_actions.a.destroy(FORM_ID));case 4:case"end":return _context6.stop()}}),_marked6)}function loadEntityModel(entityName){var entityModel;return regenerator_default.a.wrap((function loadEntityModel$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,Object(redux_saga_effects_npm_proxy_esm.b)(rest.a.fetchModel,entityName);case 2:return entityModel=_context7.sent,_context7.next=5,Object(redux_saga_effects_npm_proxy_esm.e)(setEntityModel(entityModel));case 5:return _context7.abrupt("return",entityModel);case 6:case"end":return _context7.stop()}}),_marked7)}function sagas_loadDetailView(){var _yield$select2,entityName,formName,mode,defaultValues,model,_yield$call,fieldDefinitions,formDefaultValues,inputDefaultValues,defaultValuesFields,flattenEntity,formValues;return regenerator_default.a.wrap((function loadDetailView$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,Object(redux_saga_effects_npm_proxy_esm.f)(entityDetailSelector);case 2:return _yield$select2=_context8.sent,entityName=_yield$select2.entityName,formName=_yield$select2.formName,mode=_yield$select2.mode,defaultValues=_yield$select2.defaultValues,_context8.next=9,Object(redux_saga_effects_npm_proxy_esm.b)(loadEntityModel,entityName);case 9:return model=_context8.sent,_context8.next=12,Object(redux_saga_effects_npm_proxy_esm.b)(loadDetailFormDefinition,formName,mode);case 12:if(_yield$call=_context8.sent,fieldDefinitions=_yield$call.fieldDefinitions,mode!==modes_CREATE){_context8.next=39;break}return _context8.next=17,Object(redux_saga_effects_npm_proxy_esm.e)(setEntity({paths:{},model:entityName}));case 17:return _context8.next=19,Object(redux_saga_effects_npm_proxy_esm.b)(src_form.a.getDefaultValues,fieldDefinitions);case 19:if(formDefaultValues=_context8.sent,!defaultValues){_context8.next=26;break}return _context8.next=23,Object(redux_saga_effects_npm_proxy_esm.b)(src_form.a.transformInputValues,defaultValues,model);case 23:_context8.t0=_context8.sent,_context8.next=27;break;case 26:_context8.t0={};case 27:return inputDefaultValues=_context8.t0,defaultValuesFields=Object.assign({},formDefaultValues,inputDefaultValues),_context8.next=31,Object(redux_saga_effects_npm_proxy_esm.b)(api.a.getFlattenEntity,{model:entityName});case 31:return flattenEntity=_context8.sent,_context8.next=34,Object(redux_saga_effects_npm_proxy_esm.b)(src_form.a.entityToFormValues,Object.assign({},flattenEntity,defaultValuesFields));case 34:return formValues=_context8.sent,_context8.next=37,Object(redux_saga_effects_npm_proxy_esm.e)(es_actions.a.initialize(FORM_ID,formValues));case 37:_context8.next=41;break;case 39:return _context8.next=41,Object(redux_saga_effects_npm_proxy_esm.b)(loadData);case 41:case"end":return _context8.stop()}}),_marked8)}function updateFormSubmit(entity){return regenerator_default.a.wrap((function updateFormSubmit$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,Object(redux_saga_effects_npm_proxy_esm.b)(updateEntity,entity);case 2:if(404!==_context9.sent.status){_context9.next=8;break}return _context9.next=6,Object(redux_saga_effects_npm_proxy_esm.e)(externalEvents.a.fireExternalEvent("onEntityDeleted"));case 6:_context9.next=18;break;case 8:return _context9.next=10,Object(redux_saga_effects_npm_proxy_esm.b)(loadData);case 10:return _context9.next=12,Object(redux_saga_effects_npm_proxy_esm.e)(externalEvents.a.fireExternalEvent("onEntityUpdated"));case 12:return _context9.next=14,Object(redux_saga_effects_npm_proxy_esm.b)(showNotification,"success","saveSuccessfulTitle","saveSuccessfulMessage");case 14:return _context9.next=16,Object(redux_saga_effects_npm_proxy_esm.e)(setLastSave());case 16:return _context9.next=18,Object(redux_saga_effects_npm_proxy_esm.e)(es_actions.a.stopSubmit(FORM_ID));case 18:case"end":return _context9.stop()}}),_marked9)}function createFormSubmit(entity){var createdEntityId;return regenerator_default.a.wrap((function createFormSubmit$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:return _context10.next=2,Object(redux_saga_effects_npm_proxy_esm.b)(createEntity,entity);case 2:return createdEntityId=_context10.sent,_context10.next=5,Object(redux_saga_effects_npm_proxy_esm.e)(externalEvents.a.fireExternalEvent("onEntityCreated",{id:createdEntityId}));case 5:return _context10.next=7,Object(redux_saga_effects_npm_proxy_esm.b)(showNotification,"success","createSuccessfulTitle","createSuccessfulMessage");case 7:case"end":return _context10.stop()}}),_marked10)}function sagas_touchAllFields(){var _yield$select3,fieldDefinitions;return regenerator_default.a.wrap((function touchAllFields$(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:return _context11.next=2,Object(redux_saga_effects_npm_proxy_esm.f)(entityDetailSelector);case 2:return _yield$select3=_context11.sent,fieldDefinitions=_yield$select3.fieldDefinitions,_context11.next=6,Object(redux_saga_effects_npm_proxy_esm.e)(es_actions.a.touch.apply(es_actions.a,[FORM_ID].concat(toConsumableArray_default()(fieldDefinitions.map((function(f){return src_form.a.transformFieldName(f.path||f.id)}))))));case 6:case"end":return _context11.stop()}}),_marked11)}function handleSubmitError(error){var validationErrors,message,_ref2;return regenerator_default.a.wrap((function handleSubmitError$(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:if(!(error instanceof SubmissionError.a)){_context12.next=13;break}return _context12.next=3,Object(redux_saga_effects_npm_proxy_esm.e)(es_actions.a.stopSubmit(FORM_ID,error.errors));case 3:return _context12.next=5,Object(redux_saga_effects_npm_proxy_esm.b)(handleInvalidForm);case 5:return _context12.next=7,Object(redux_saga_effects_npm_proxy_esm.b)(src_form.a.formErrorsUtil.getValidatorErrors,error.errors);case 7:return validationErrors=_context12.sent,message=validationErrors&&validationErrors.length>0?validationErrors.join("<br>"):"client.entity-detail.saveAbortedMessage",_ref2=Object(jsx_runtime.jsx)(ErrorItems_ErrorItem,{message:message}),_context12.next=11,Object(redux_saga_effects_npm_proxy_esm.e)(notification.a.toaster({type:"warning",title:"client.entity-detail.saveAbortedTitle",body:function body(){return _ref2},duration:5e3}));case 11:_context12.next=29;break;case 13:if(!(error instanceof rest.a.InformationError)){_context12.next=20;break}return _context12.next=16,Object(redux_saga_effects_npm_proxy_esm.e)(notification.a.toaster({type:"info",title:"client.entity-detail.saveAbortedTitle",body:error.message}));case 16:return _context12.next=18,Object(redux_saga_effects_npm_proxy_esm.e)(es_actions.a.stopSubmit(FORM_ID));case 18:_context12.next=29;break;case 20:if(!(error instanceof rest.a.ClientQuestionCancelledException)){_context12.next=25;break}return _context12.next=23,Object(redux_saga_effects_npm_proxy_esm.e)(es_actions.a.stopSubmit(FORM_ID));case 23:_context12.next=29;break;case 25:return _context12.next=27,Object(redux_saga_effects_npm_proxy_esm.e)(errorLogging.a.logError("client.common.unexpectedError","client.entity-detail.saveError",error));case 27:return _context12.next=29,Object(redux_saga_effects_npm_proxy_esm.e)(es_actions.a.stopSubmit(FORM_ID));case 29:case"end":return _context12.stop()}}),_marked12)}function getCurrentEntityState(){var formValues,initialFormValues,_yield$select4,mode,initialValues,dirtyFields;return regenerator_default.a.wrap((function getCurrentEntityState$(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:return _context13.next=2,Object(redux_saga_effects_npm_proxy_esm.f)(Object(getFormValues.a)(FORM_ID));case 2:return formValues=_context13.sent,_context13.next=5,Object(redux_saga_effects_npm_proxy_esm.f)(formInitialValueSelector,FORM_ID);case 5:return initialFormValues=_context13.sent,_context13.next=8,Object(redux_saga_effects_npm_proxy_esm.f)(entityDetailSelector);case 8:return _yield$select4=_context13.sent,mode=_yield$select4.mode,initialValues=mode===modes_CREATE?{}:initialFormValues,_context13.next=13,Object(redux_saga_effects_npm_proxy_esm.b)(src_form.a.getDirtyFields,initialValues,formValues,mode===modes_CREATE);case 13:return dirtyFields=_context13.sent,_context13.abrupt("return",{formValues:formValues,initialValues:initialValues,mode:mode,dirtyFields:dirtyFields});case 15:case"end":return _context13.stop()}}),_marked13)}function submitValidate(){var _yield$call2,formValues,initialValues,mode;return regenerator_default.a.wrap((function submitValidate$(_context14){for(;;)switch(_context14.prev=_context14.next){case 0:return _context14.next=2,Object(redux_saga_effects_npm_proxy_esm.b)(getCurrentEntityState);case 2:return _yield$call2=_context14.sent,formValues=_yield$call2.formValues,initialValues=_yield$call2.initialValues,mode=_yield$call2.mode,_context14.next=8,Object(redux_saga_effects_npm_proxy_esm.b)(src_form.a.submitValidation,formValues,initialValues,mode);case 8:case"end":return _context14.stop()}}),_marked14)}function getEntityForSubmit(){var _yield$call3,formValues,dirtyFields,flattenEntity,dirtyFieldNames;return regenerator_default.a.wrap((function getEntityForSubmit$(_context15){for(;;)switch(_context15.prev=_context15.next){case 0:return _context15.next=2,Object(redux_saga_effects_npm_proxy_esm.b)(getCurrentEntityState);case 2:return _yield$call3=_context15.sent,formValues=_yield$call3.formValues,dirtyFields=_yield$call3.dirtyFields,_context15.next=7,Object(redux_saga_effects_npm_proxy_esm.b)(src_form.a.formValuesToFlattenEntity,formValues);case 7:return flattenEntity=_context15.sent,dirtyFieldNames=dirtyFields.map((function(fieldName){return src_form.a.transformFieldNameBack(fieldName)})),_context15.next=11,Object(redux_saga_effects_npm_proxy_esm.b)(api.a.toEntity,flattenEntity,dirtyFieldNames);case 11:return _context15.abrupt("return",_context15.sent);case 12:case"end":return _context15.stop()}}),_marked15)}function getFormErrors(){return regenerator_default.a.wrap((function getFormErrors$(_context17){for(;;)switch(_context17.prev=_context17.next){case 0:return _context17.t0=Object,_context17.t1={},_context17.next=4,Object(redux_saga_effects_npm_proxy_esm.f)(Object(getFormSyncErrors.a)(FORM_ID));case 4:return _context17.t2=_context17.sent,_context17.next=7,Object(redux_saga_effects_npm_proxy_esm.f)(Object(getFormAsyncErrors.a)(FORM_ID));case 7:return _context17.t3=_context17.sent,_context17.next=10,Object(redux_saga_effects_npm_proxy_esm.f)(Object(getFormSubmitErrors.a)(FORM_ID));case 10:return _context17.t4=_context17.sent,_context17.abrupt("return",_context17.t0.assign.call(_context17.t0,_context17.t1,_context17.t2,_context17.t3,_context17.t4));case 12:case"end":return _context17.stop()}}),_marked17)}function focusField(fieldName){var element=document.getElementById(src_form.a.getFieldId(FORM_ID,fieldName));return!!element&&(element.focus(),!0)}function locationFieldFocus(errorField){var _yield$select6,fieldDefinitions,locationField;return regenerator_default.a.wrap((function locationFieldFocus$(_context18){for(;;)switch(_context18.prev=_context18.next){case 0:return _context18.next=2,Object(redux_saga_effects_npm_proxy_esm.f)(entityDetailSelector);case 2:return _yield$select6=_context18.sent,fieldDefinitions=_yield$select6.fieldDefinitions,locationField=fieldDefinitions.find((function(f){return f.locationMapping&&f.locationMapping.postcode===errorField})),_context18.next=7,Object(redux_saga_effects_npm_proxy_esm.b)(focusField,locationField.id);case 7:case"end":return _context18.stop()}}),_marked18)}function focusErrorField(){var formErrors,firstErrorField;return regenerator_default.a.wrap((function focusErrorField$(_context19){for(;;)switch(_context19.prev=_context19.next){case 0:return _context19.next=2,Object(redux_saga_effects_npm_proxy_esm.b)(getFormErrors);case 2:return formErrors=_context19.sent,_context19.next=5,Object(redux_saga_effects_npm_proxy_esm.b)(src_form.a.formErrorsUtil.getFirstErrorField,formErrors);case 5:if(!(firstErrorField=_context19.sent)){_context19.next=13;break}return _context19.next=9,Object(redux_saga_effects_npm_proxy_esm.b)(focusField,firstErrorField);case 9:if(_context19.sent){_context19.next=13;break}return _context19.next=13,Object(redux_saga_effects_npm_proxy_esm.b)(locationFieldFocus,firstErrorField);case 13:case"end":return _context19.stop()}}),_marked19)}function handleInvalidForm(){return regenerator_default.a.wrap((function handleInvalidForm$(_context20){for(;;)switch(_context20.prev=_context20.next){case 0:return _context20.next=2,Object(redux_saga_effects_npm_proxy_esm.b)(sagas_touchAllFields);case 2:return _context20.next=4,Object(redux_saga_effects_npm_proxy_esm.b)(focusErrorField);case 4:case"end":return _context20.stop()}}),_marked20)}function sagas_submitForm(){var _yield$select7,mode,entity;return regenerator_default.a.wrap((function submitForm$(_context21){for(;;)switch(_context21.prev=_context21.next){case 0:return _context21.prev=0,_context21.next=3,Object(redux_saga_effects_npm_proxy_esm.f)(Object(es_isValid.a)(FORM_ID));case 3:if(_context21.sent){_context21.next=9;break}return _context21.next=7,Object(redux_saga_effects_npm_proxy_esm.b)(handleInvalidForm);case 7:_context21.next=28;break;case 9:return _context21.next=11,Object(redux_saga_effects_npm_proxy_esm.e)(es_actions.a.startSubmit(FORM_ID));case 11:return _context21.next=13,Object(redux_saga_effects_npm_proxy_esm.f)(entityDetailSelector);case 13:return _yield$select7=_context21.sent,mode=_yield$select7.mode,_context21.next=17,Object(redux_saga_effects_npm_proxy_esm.b)(submitValidate);case 17:return _context21.next=19,Object(redux_saga_effects_npm_proxy_esm.b)(getEntityForSubmit);case 19:if(entity=_context21.sent,mode!==modes_UPDATE){_context21.next=25;break}return _context21.next=23,Object(redux_saga_effects_npm_proxy_esm.b)(updateFormSubmit,entity);case 23:_context21.next=28;break;case 25:if(mode!==modes_CREATE){_context21.next=28;break}return _context21.next=28,Object(redux_saga_effects_npm_proxy_esm.b)(createFormSubmit,entity);case 28:_context21.next=34;break;case 30:return _context21.prev=30,_context21.t0=_context21.catch(0),_context21.next=34,Object(redux_saga_effects_npm_proxy_esm.b)(handleSubmitError,_context21.t0);case 34:case"end":return _context21.stop()}}),_marked21,null,[[0,30]])}function sagas_fireTouched(_ref3){var payload,actionTouched,_yield$select8,stateTouched;return regenerator_default.a.wrap((function fireTouched$(_context22){for(;;)switch(_context22.prev=_context22.next){case 0:return payload=_ref3.payload,actionTouched=payload.touched,_context22.next=4,Object(redux_saga_effects_npm_proxy_esm.f)(entityDetailSelector);case 4:if(_yield$select8=_context22.sent,stateTouched=_yield$select8.touched,actionTouched===stateTouched){_context22.next=11;break}return _context22.next=9,Object(redux_saga_effects_npm_proxy_esm.e)(externalEvents.a.fireExternalEvent("onTouchedChange",{touched:actionTouched}));case 9:return _context22.next=11,Object(redux_saga_effects_npm_proxy_esm.e)(setTouched(actionTouched));case 11:case"end":return _context22.stop()}}),_marked22)}function showNotification(type,titleResourceName,messageResourceName){return regenerator_default.a.wrap((function showNotification$(_context23){for(;;)switch(_context23.prev=_context23.next){case 0:return _context23.next=2,Object(redux_saga_effects_npm_proxy_esm.e)(notification.a.toaster({type:type,title:"client.entity-detail.".concat(titleResourceName),body:"client.entity-detail.".concat(messageResourceName)}));case 2:case"end":return _context23.stop()}}),_marked23)}function loadDisplayExpressions(formName,mode,paths,entities){var keys,entityName,result;return regenerator_default.a.wrap((function loadDisplayExpressions$(_context24){for(;;)switch(_context24.prev=_context24.next){case 0:if(!(paths&&paths.length>0)){_context24.next=7;break}return keys=entities.map((function(e){return e.__key})),entityName=entities[0].__model,_context24.next=5,Object(redux_saga_effects_npm_proxy_esm.b)(rest.a.fetchDisplayExpressions,formName,mode,keys,paths,entityName);case 5:return result=_context24.sent,_context24.abrupt("return",result);case 7:case"end":return _context24.stop()}}),_marked24)}function loadRelationDisplays(relationFields,entities){var request;return regenerator_default.a.wrap((function loadRelationDisplays$(_context25){for(;;)switch(_context25.prev=_context25.next){case 0:if(!(relationFields&&relationFields.length>0)){_context25.next=7;break}return _context25.next=3,Object(redux_saga_effects_npm_proxy_esm.b)(api.a.getPathDisplayRequest,entities,relationFields,{});case 3:return request=_context25.sent,_context25.next=6,Object(redux_saga_effects_npm_proxy_esm.b)(rest.a.fetchDisplays,request);case 6:return _context25.abrupt("return",_context25.sent);case 7:case"end":return _context25.stop()}}),_marked25)}function enhanceEntityWithDisplayExpressions(entity){var _yield$select9,fieldDefinitions,formName,mode,displayExpressions,displayExpressionsL;return regenerator_default.a.wrap((function enhanceEntityWithDisplayExpressions$(_context26){for(;;)switch(_context26.prev=_context26.next){case 0:return _context26.next=2,Object(redux_saga_effects_npm_proxy_esm.f)(entityDetailSelector);case 2:return _yield$select9=_context26.sent,fieldDefinitions=_yield$select9.fieldDefinitions,formName=_yield$select9.formName,mode=_yield$select9.mode,displayExpressions=fieldDefinitions.filter((function(f){return"display"===f.componentType})).map((function(f){return f.id})),_context26.next=9,Object(redux_saga_effects_npm_proxy_esm.b)(loadDisplayExpressions,formName,mode,displayExpressions,[entity]);case 9:(displayExpressionsL=_context26.sent)&&Object.keys(displayExpressionsL[entity.__key]).forEach((function(dE){entity[dE]=displayExpressionsL[entity.__key][dE]}));case 11:case"end":return _context26.stop()}}),_marked26)}function enhanceEntityWithDisplays(entity){var _yield$select10,fieldDefinitions,relationFields,displays;return regenerator_default.a.wrap((function enhanceEntityWithDisplays$(_context27){for(;;)switch(_context27.prev=_context27.next){case 0:return _context27.next=2,Object(redux_saga_effects_npm_proxy_esm.f)(entityDetailSelector);case 2:return _yield$select10=_context27.sent,fieldDefinitions=_yield$select10.fieldDefinitions,relationFields=fieldDefinitions.filter((function(f){return api.a.relationFieldTypes.includes(f.dataType)})).map((function(f){return f.path})),_context27.next=7,Object(redux_saga_effects_npm_proxy_esm.b)(loadRelationDisplays,relationFields,[entity]);case 7:displays=_context27.sent,relationFields.forEach((function(relationField){var value=entity[relationField];if(value){var newValue=Array.isArray(value)?value.map((function(v2){return Object.assign({},v2,{display:displays[v2.model][v2.key]})})):Object.assign({},value,{display:displays[value.model][value.key]});entity[relationField]=newValue}}));case 9:case"end":return _context27.stop()}}),_marked27)}function loadData(){var reset,_yield$select11,entityName,entityId,fieldDefinitions,entity,flattenEntity,formValues,options,_args28=arguments;return regenerator_default.a.wrap((function loadData$(_context28){for(;;)switch(_context28.prev=_context28.next){case 0:return reset=!(_args28.length>0&&void 0!==_args28[0])||_args28[0],_context28.next=3,Object(redux_saga_effects_npm_proxy_esm.f)(entityDetailSelector);case 3:if(_yield$select11=_context28.sent,entityName=_yield$select11.entityName,entityId=_yield$select11.entityId,fieldDefinitions=_yield$select11.fieldDefinitions,!0!==_yield$select11.entityModel.markable){_context28.next=11;break}return _context28.next=11,Object(redux_saga_effects_npm_proxy_esm.d)(loadMarked,entityName,entityId);case 11:return _context28.next=13,Object(redux_saga_effects_npm_proxy_esm.b)(loadEntity,entityName,entityId,fieldDefinitions);case 13:return entity=_context28.sent,_context28.next=16,Object(redux_saga_effects_npm_proxy_esm.b)(api.a.getFlattenEntity,entity);case 16:return flattenEntity=_context28.sent,_context28.next=19,Object(redux_saga_effects_npm_proxy_esm.b)(enhanceEntityWithDisplayExpressions,flattenEntity);case 19:return _context28.next=21,Object(redux_saga_effects_npm_proxy_esm.b)(enhanceEntityWithDisplays,flattenEntity);case 21:return _context28.next=23,Object(redux_saga_effects_npm_proxy_esm.b)(src_form.a.entityToFormValues,flattenEntity);case 23:return formValues=_context28.sent,options=reset?{}:{keepDirty:!0,keepValues:!1},_context28.next=27,Object(redux_saga_effects_npm_proxy_esm.e)(es_actions.a.initialize(FORM_ID,formValues,options));case 27:case"end":return _context28.stop()}}),_marked28)}function loadMarked(entityName,entityId){var marked;return regenerator_default.a.wrap((function loadMarked$(_context29){for(;;)switch(_context29.prev=_context29.next){case 0:return _context29.next=2,Object(redux_saga_effects_npm_proxy_esm.b)(rest.a.fetchMarked,entityName,entityId);case 2:return marked=_context29.sent,_context29.next=5,Object(redux_saga_effects_npm_proxy_esm.e)(setMarked(marked));case 5:case"end":return _context29.stop()}}),_marked29)}function sagas_updateMarked(_ref4){var _ref4$payload,entityName,entityId,marked;return regenerator_default.a.wrap((function updateMarked$(_context30){for(;;)switch(_context30.prev=_context30.next){case 0:return _ref4$payload=_ref4.payload,entityName=_ref4$payload.entityName,entityId=_ref4$payload.entityId,marked=_ref4$payload.marked,_context30.next=3,Object(redux_saga_effects_npm_proxy_esm.e)(setMarked(marked));case 3:return _context30.next=5,Object(redux_saga_effects_npm_proxy_esm.b)(rest.a.setMarked,entityName,entityId,marked);case 5:case"end":return _context30.stop()}}),_marked30)}function sagas_navigateToCreate(_ref5){var payload,_yield$select12,navigationStrategy;return regenerator_default.a.wrap((function navigateToCreate$(_context31){for(;;)switch(_context31.prev=_context31.next){case 0:return payload=_ref5.payload,_context31.next=3,Object(redux_saga_effects_npm_proxy_esm.f)(inputSelector);case 3:return _yield$select12=_context31.sent,navigationStrategy=_yield$select12.navigationStrategy,_context31.next=7,Object(redux_saga_effects_npm_proxy_esm.b)(navigationStrategy.navigateToCreateRelative,payload.relationName);case 7:case"end":return _context31.stop()}}),_marked31)}function sagas_navigateToAction(_ref6){var payload,definition,selection,_yield$select13,navigationStrategy;return regenerator_default.a.wrap((function navigateToAction$(_context32){for(;;)switch(_context32.prev=_context32.next){case 0:return payload=_ref6.payload,definition=payload.definition,selection=payload.selection,_context32.next=4,Object(redux_saga_effects_npm_proxy_esm.f)(inputSelector);case 4:return _yield$select13=_context32.sent,navigationStrategy=_yield$select13.navigationStrategy,_context32.next=8,Object(redux_saga_effects_npm_proxy_esm.b)(navigationStrategy.navigateToActionRelative,definition,selection);case 8:case"end":return _context32.stop()}}),_marked32)}var isCurrentEntity=function isCurrentEntity(event,entityName,entityId){return!!event.payload.entities.find((function(entity){return entity.entityName===entityName&&entity.key===entityId}))||event.payload.parent&&event.payload.parent.model===entityName&&event.payload.parent.key===entityId};function remoteEvent(action){var event,_yield$select14,entityName,entityId;return regenerator_default.a.wrap((function remoteEvent$(_context33){for(;;)switch(_context33.prev=_context33.next){case 0:return event=action.payload.event,_context33.next=3,Object(redux_saga_effects_npm_proxy_esm.f)(entityDetailSelector);case 3:if(_yield$select14=_context33.sent,entityName=_yield$select14.entityName,entityId=_yield$select14.entityId,!isCurrentEntity(event,entityName,entityId)){_context33.next=16;break}_context33.t0=event.type,_context33.next="entity-delete-event"===_context33.t0?10:"entity-update-event"===_context33.t0?13:16;break;case 10:return _context33.next=12,Object(redux_saga_effects_npm_proxy_esm.e)(externalEvents.a.fireExternalEvent("onEntityDeleted"));case 12:return _context33.abrupt("break",16);case 13:return _context33.next=15,Object(redux_saga_effects_npm_proxy_esm.b)(loadData,!1);case 15:return _context33.abrupt("break",16);case 16:case"end":return _context33.stop()}}),_marked33)}function asyncValidationStop(_ref7){var payload,outdatedError,_selectUnit,timeStampValue,unit,titleId;return regenerator_default.a.wrap((function asyncValidationStop$(_context34){for(;;)switch(_context34.prev=_context34.next){case 0:if(!(payload=_ref7.payload)){_context34.next=9;break}if(!src_form.a.formErrorsUtil.hasOutdatedError(payload)){_context34.next=9;break}return outdatedError=src_form.a.formErrorsUtil.getOutdatedError(payload),_selectUnit=Object(diff.a)(new Date(outdatedError.updateTimestamp)),timeStampValue=_selectUnit.value,unit=_selectUnit.unit,titleId="client.entity-detail.".concat(outdatedError.sameEntity?"outdated":"relatedOutdated","ErrorTitle"),_context34.next=9,Object(redux_saga_effects_npm_proxy_esm.e)(notification.a.toaster({type:"warning",key:"outdated-warning",title:Object(jsx_runtime.jsx)(components_message.a,{id:titleId,values:{model:outdatedError.model,key:outdatedError.key}}),body:Object(jsx_runtime.jsx)(components_message.a,{id:"client.entity-detail.outdatedErrorDescription",values:{ago:Object(jsx_runtime.jsx)(relative.a,{value:timeStampValue,unit:unit}),user:outdatedError.updateUser}})}));case 9:case"end":return _context34.stop()}}),_marked34)}var reducers={entityDetail:reducer_reducer,form:es_reducer.a},reducers_sagas=[sagas],es=__webpack_require__(25),injectIntl=__webpack_require__(374),getFormInitialValues=__webpack_require__(5037),isEmpty=__webpack_require__(2209),isEmpty_default=__webpack_require__.n(isEmpty),LoadMask=__webpack_require__(2276),get=__webpack_require__(21),get_default=__webpack_require__.n(get),reduxForm=__webpack_require__(545),viewPersistor=__webpack_require__(4984);function SubGrid_templateObject(){var data=taggedTemplateLiteral_default()(["\n  width: 100%;\n"]);return SubGrid_templateObject=function _templateObject(){return data},data}var StyledListApp=styled_components_browser_esm.default.div(SubGrid_templateObject()),SubGrid_SubGrid=function SubGrid(props){var formBase="".concat(props.detailFormName,"_").concat(props.formField.path),id="".concat(props.appId,"-subgrid-").concat(props.entityName,"-").concat(props.entityKey,"-").concat(props.formField.reverseRelation);return Object(jsx_runtime.jsx)(StyledListApp,{children:Object(jsx_runtime.jsx)(src_main.a,{id:id,entityName:props.formField.targetEntity,formName:formBase,limit:props.limit,searchFormType:props.showSearchForm?"basic":"none",navigationStrategy:props.navigationStrategy,showLink:!0,onRowClick:function onRowClick(e){props.onRowClick&&props.onRowClick({id:e.id,gridName:props.formField.path,relationName:props.formField.path})},onNavigateToCreate:function onNavigateToCreate(){props.navigateToCreate(props.formField.path)},parent:{key:props.entityKey,reverseRelationName:props.formField.reverseRelation,model:props.entityName,relationName:props.formField.path},emitAction:props.emitAction,store:viewPersistor.a.viewInfoSelector(id).store,onStoreCreate:function onStoreCreate(store){viewPersistor.a.persistViewInfo(id,{store:store})}})})};SubGrid_SubGrid.displayName="SubGrid",SubGrid_SubGrid.defaultProps={limit:5},SubGrid_SubGrid.__docgenInfo={description:"",methods:[],displayName:"SubGrid",props:{limit:{defaultValue:{value:"5",computed:!1},type:{name:"number"},required:!1,description:""},entityKey:{type:{name:"union",value:[{name:"string"},{name:"number"}]},required:!1,description:""},entityName:{type:{name:"string"},required:!0,description:""},detailFormName:{type:{name:"string"},required:!0,description:""},formField:{type:{name:"shape",value:{path:{name:"string",required:!1},targetEntity:{name:"string",required:!1},reverseRelation:{name:"string",required:!1}}},required:!0,description:""},onRowClick:{type:{name:"func"},required:!1,description:""},navigateToCreate:{type:{name:"func"},required:!0,description:""},showSubGridsCreateButton:{type:{name:"bool"},required:!1,description:""},appId:{type:{name:"string"},required:!1,description:""},showSearchForm:{type:{name:"bool"},required:!1,description:""},emitAction:{type:{name:"func"},required:!0,description:""},navigationStrategy:{type:{name:"objectOf",value:{name:"func"}},required:!1,description:""}}};var components_SubGrid_SubGrid=SubGrid_SubGrid;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/entity-detail/src/components/SubGrid/SubGrid.js"]={name:"SubGrid",docgenInfo:SubGrid_SubGrid.__docgenInfo,path:"packages/entity-detail/src/components/SubGrid/SubGrid.js"});var components_SubGrid=components_SubGrid_SubGrid,mapActionCreators={onRowClick:function onRowClick(e){return externalEvents.a.fireExternalEvent("onSubGridRowClick",{id:e.id,gridName:e.gridName,relationName:e.relationName})},navigateToCreate:navigateToCreate,emitAction:function emitAction(action){return actionEmitter.a.dispatchEmittedAction(action)}},SubGridContainer=Object(es.connect)((function mapStateToProps(state,props){return{appId:state.entityDetail.appId,entityKey:state.entityDetail.entity.key,entityName:state.entityDetail.entity.model,detailFormName:state.entityDetail.formDefinition.id,navigationStrategy:state.input.navigationStrategy}}),mapActionCreators)(components_SubGrid),subGrid=function(formField,key){return Object(jsx_runtime.jsx)(SubGridContainer,{formField:formField,showSearchForm:formField.showSearchForm,limit:formField.limit||void 0},key)},Popover=__webpack_require__(551),components_ErrorItems=components_ErrorItems_ErrorItems,StyledScrollbar=__webpack_require__(946),Button=__webpack_require__(71),resolveThemePath=__webpack_require__(35);function _templateObject4(){var data=taggedTemplateLiteral_default()(["\n  cursor: pointer;\n  display: flex;\n  height: 100%;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n\n  &:hover {\n    color: ",";\n  }\n  ","\n"]);return _templateObject4=function _templateObject4(){return data},data}function _templateObject3(){var data=taggedTemplateLiteral_default()(["\n  "," {\n    width: 100%;\n    max-width: fit-content;\n    justify-content: center;\n    box-sizing: border-box;\n\n    > * {\n      overflow: hidden;\n    }\n  }\n"]);return _templateObject3=function _templateObject3(){return data},data}function _templateObject2(){var data=taggedTemplateLiteral_default()(["\n  ",";\n"]);return _templateObject2=function _templateObject2(){return data},data}function StyledComponents_templateObject(){var data=taggedTemplateLiteral_default()(["\n  display: flex;\n  flex-direction: column;\n  padding-bottom: ",";\n  height: 100%;\n  overflow-y: auto;\n  ","\n"]);return StyledComponents_templateObject=function _templateObject(){return data},data}var StyledForm=styled_components_browser_esm.default.form(StyledComponents_templateObject(),modularScale.a.space(-.5),StyledScrollbar.a),StyledButton=Object(styled_components_browser_esm.default)(Button.a)(_templateObject2(),(function(_ref){return _ref.hasErrors&&"\n    background-color: ".concat(resolveThemePath.a.color("paper"),";\n  ")})),StyledActionSpan=(styled_components_browser_esm.default.div(_templateObject3(),StyledButton),styled_components_browser_esm.default.span(_templateObject4(),resolveThemePath.a.color("secondaryLight"),(function(_ref2){var marked=_ref2.marked,theme=_ref2.theme;return marked&&"color: ".concat(theme.colors.secondary,";")}))),SaveButton_SaveButton=function SaveButton(_ref){var submitting=_ref.submitting,mode=_ref.mode,intl=_ref.intl,hasErrors=_ref.hasErrors,formErrors=_ref.formErrors,icon=_ref.icon;return Object(jsx_runtime.jsx)(Popover.a,{content:hasErrors?Object(jsx_runtime.jsx)(components_ErrorItems,{formErrors:formErrors}):null,placement:"bottom",children:Object(jsx_runtime.jsx)(StyledButton,{"data-cy":"detail-form_submit-button",id:"detail-save_button",disabled:submitting,ink:"primary",label:function msg(id){return intl.formatMessage({id:id})}("client.entity-detail.".concat(mode===modes_CREATE?"create":"save")),look:hasErrors?"flat":"raised",pending:submitting,type:"submit",hasErrors:hasErrors,icon:hasErrors?"exclamation":icon})})};SaveButton_SaveButton.displayName="SaveButton",SaveButton_SaveButton.__docgenInfo={description:"",methods:[],displayName:"SaveButton",props:{intl:{type:{name:"object"},required:!0,description:""},submitting:{type:{name:"bool"},required:!1,description:""},mode:{type:{name:"enum",computed:!0,value:"Object.values(modes)"},required:!1,description:""},hasErrors:{type:{name:"bool"},required:!1,description:""},formErrors:{type:{name:"object"},required:!1,description:""},icon:{type:{name:"string"},required:!1,description:""}}};var DetailForm_SaveButton=SaveButton_SaveButton;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/entity-detail/src/components/DetailForm/SaveButton.js"]={name:"SaveButton",docgenInfo:SaveButton_SaveButton.__docgenInfo,path:"packages/entity-detail/src/components/DetailForm/SaveButton.js"});var slicedToArray=__webpack_require__(34),slicedToArray_default=__webpack_require__.n(slicedToArray),LazyIcon=__webpack_require__(713),MarkButton_MarkButton=function MarkButton(_ref){var entityName=_ref.entityName,entityId=_ref.entityId,marked=_ref.marked,updateMarked=_ref.updateMarked,_useState=Object(react.useState)(!1),_useState2=slicedToArray_default()(_useState,2),mouseOver=_useState2[0],setMouseOver=_useState2[1];Object(react.useEffect)((function(){marked||setMouseOver(!1)}),[marked]);return Object(jsx_runtime.jsx)(Typography.a.Span,{children:Object(jsx_runtime.jsx)(StyledActionSpan,{marked:marked,onClick:function handleClick(e){e.stopPropagation(),updateMarked(entityName,entityId,!marked)},onMouseEnter:function onMouseEnter(){return setMouseOver(!0)},onMouseLeave:function onMouseLeave(){return setMouseOver(!1)},children:Object(jsx_runtime.jsx)(LazyIcon.a,{icon:marked||mouseOver?"star-full":"star"})})})};MarkButton_MarkButton.displayName="MarkButton";var MarkButton_mapActionCreators={updateMarked:function updateMarked(entityName,entityId,marked){return{type:"entityDetail/UPDATE_MARKED",payload:{entityName:entityName,entityId:entityId,marked:marked}}}};MarkButton_MarkButton.__docgenInfo={description:"",methods:[],displayName:"MarkButton",props:{entityName:{type:{name:"string"},required:!0,description:""},entityId:{type:{name:"string"},required:!0,description:""},marked:{type:{name:"bool"},required:!0,description:""},updateMarked:{type:{name:"func"},required:!0,description:""}}};var DetailForm_MarkButton=Object(es.connect)((function mapStateToProps(state){return{entityName:state.entityDetail.entityName,entityId:state.entityDetail.entityId,marked:state.entityDetail.marked}}),MarkButton_mapActionCreators)(MarkButton_MarkButton);"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/entity-detail/src/components/DetailForm/MarkButton.js"]={name:"MarkButton",docgenInfo:MarkButton_MarkButton.__docgenInfo,path:"packages/entity-detail/src/components/DetailForm/MarkButton.js"});var Layout=__webpack_require__(150),colorMap=__webpack_require__(2270),StyledLayoutBox=__webpack_require__(926),StyledMisc=__webpack_require__(52),declareWrapping=__webpack_require__(40);function _templateObject6(){var data=taggedTemplateLiteral_default()(["\n  && {\n    margin-left: 5px;\n  }\n"]);return _templateObject6=function _templateObject6(){return data},data}function _templateObject5(){var data=taggedTemplateLiteral_default()(["\n  display: flex;\n"]);return _templateObject5=function _templateObject5(){return data},data}function StyledComponents_templateObject4(){var data=taggedTemplateLiteral_default()(["\n  width: 80%;\n  flex-shrink: 1;\n  flex-grow: 1;\n  overflow: hidden;\n"]);return StyledComponents_templateObject4=function _templateObject4(){return data},data}function StyledComponents_templateObject3(){var data=taggedTemplateLiteral_default()(["\n  && {\n    margin-right: 5px;\n    width: 80px;\n    flex-shrink: 0;\n    font-weight: ",";\n    ","\n  }\n"]);return StyledComponents_templateObject3=function _templateObject3(){return data},data}function StyledComponents_templateObject2(){var data=taggedTemplateLiteral_default()(["\n  display: flex;\n"]);return StyledComponents_templateObject2=function _templateObject2(){return data},data}function DetailFooter_StyledComponents_templateObject(){var data=taggedTemplateLiteral_default()(["\n  && {\n    * {\n      color: ",";\n    }\n\n    "," {\n      margin-bottom: 0;\n    }\n  }\n"]);return DetailFooter_StyledComponents_templateObject=function _templateObject(){return data},data}var StyledFooterWrapper=styled_components_browser_esm.default.div(DetailFooter_StyledComponents_templateObject(),colorMap.b.shade2,StyledLayoutBox.a),StyledFooterItemWrapper=styled_components_browser_esm.default.div(StyledComponents_templateObject2()),StyledFooterItemLabel=Object(styled_components_browser_esm.default)(StyledMisc.p)(StyledComponents_templateObject3(),resolveThemePath.a.fontWeight("bold"),declareWrapping.a),StyledFooterItemValue=styled_components_browser_esm.default.span(StyledComponents_templateObject4()),StyledTimestampValueWrapper=styled_components_browser_esm.default.span(_templateObject5()),StyledTimestampRelativeValue=Object(styled_components_browser_esm.default)(StyledMisc.p)(_templateObject6()),FooterItem_FooterItem=function FooterItem(_ref){var labelId=_ref.labelId,ValueComp=_ref.valueComponent;return Object(jsx_runtime.jsxs)(StyledFooterItemWrapper,{children:[Object(jsx_runtime.jsxs)(StyledFooterItemLabel,{children:[Object(jsx_runtime.jsx)(components_message.a,{id:labelId}),":"]}),Object(jsx_runtime.jsx)(StyledFooterItemValue,{children:Object(jsx_runtime.jsx)(ValueComp,{})})]})};FooterItem_FooterItem.displayName="FooterItem",FooterItem_FooterItem.__docgenInfo={description:"",methods:[],displayName:"FooterItem",props:{labelId:{type:{name:"string"},required:!0,description:""},valueComponent:{type:{name:"func"},required:!0,description:""}}};var DetailFooter_FooterItem=FooterItem_FooterItem;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/entity-detail/src/components/DetailFooter/FooterItem.js"]={name:"FooterItem",docgenInfo:FooterItem_FooterItem.__docgenInfo,path:"packages/entity-detail/src/components/DetailFooter/FooterItem.js"});var TextValue_TextValue=function TextValue(_ref){var value=_ref.value;return Object(jsx_runtime.jsx)(Typography.a.Span,{children:value})};TextValue_TextValue.displayName="TextValue",TextValue_TextValue.__docgenInfo={description:"",methods:[],displayName:"TextValue",props:{value:{type:{name:"union",value:[{name:"string"},{name:"number"}]},required:!0,description:""}}};var DetailFooter_TextValue=TextValue_TextValue;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/entity-detail/src/components/DetailFooter/TextValue.js"]={name:"TextValue",docgenInfo:TextValue_TextValue.__docgenInfo,path:"packages/entity-detail/src/components/DetailFooter/TextValue.js"});var DetailFooterReduced_DetailFooterReduced=function DetailFooterReduced(_ref){var entity=_ref.entity,keyField=_ref.keyField;return Object(jsx_runtime.jsx)(StyledFooterWrapper,{children:Object(jsx_runtime.jsx)(Layout.a.Container,{children:Object(jsx_runtime.jsx)(Layout.a.Box,{children:Object(jsx_runtime.jsx)(DetailFooter_FooterItem,{labelId:"client.entity-detail.footer.key",valueComponent:function valueComponent(){return Object(jsx_runtime.jsx)(DetailFooter_TextValue,{value:entity.paths[keyField].value})}})})})})};DetailFooterReduced_DetailFooterReduced.displayName="DetailFooterReduced",DetailFooterReduced_DetailFooterReduced.__docgenInfo={description:"",methods:[],displayName:"DetailFooterReduced",props:{entity:{type:{name:"object"},required:!0,description:""},keyField:{type:{name:"string"},required:!0,description:""}}};var DetailFooter_DetailFooterReduced=DetailFooterReduced_DetailFooterReduced;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/entity-detail/src/components/DetailFooter/DetailFooterReduced.js"]={name:"DetailFooterReduced",docgenInfo:DetailFooterReduced_DetailFooterReduced.__docgenInfo,path:"packages/entity-detail/src/components/DetailFooter/DetailFooterReduced.js"});var FormattedValue=__webpack_require__(140),TimestampValue_TimestampValue=function TimestampValue(_ref){var value=_ref.value,_selectUnit=Object(diff.a)(new Date(value)),diffValue=_selectUnit.value,unit=_selectUnit.unit;return Object(jsx_runtime.jsxs)(StyledTimestampValueWrapper,{children:[Object(jsx_runtime.jsx)(FormattedValue.a,{value:value,type:"datetime"}),Object(jsx_runtime.jsxs)(StyledTimestampRelativeValue,{children:["(",Object(jsx_runtime.jsx)(relative.a,{value:diffValue,unit:unit}),")"]})]})};TimestampValue_TimestampValue.displayName="TimestampValue",TimestampValue_TimestampValue.__docgenInfo={description:"",methods:[],displayName:"TimestampValue",props:{value:{type:{name:"string"},required:!0,description:""}}};var DetailFooter_TimestampValue=TimestampValue_TimestampValue;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/entity-detail/src/components/DetailFooter/TimestampValue.js"]={name:"TimestampValue",docgenInfo:TimestampValue_TimestampValue.__docgenInfo,path:"packages/entity-detail/src/components/DetailFooter/TimestampValue.js"});var DetailFooterFull_DetailFooterFull=function DetailFooterFull(_ref){var entity=_ref.entity,keyField=_ref.keyField;return Object(jsx_runtime.jsx)(StyledFooterWrapper,{children:Object(jsx_runtime.jsxs)(Layout.a.Container,{children:[Object(jsx_runtime.jsxs)(Layout.a.Box,{children:[Object(jsx_runtime.jsx)(DetailFooter_FooterItem,{labelId:"client.entity-detail.footer.created",valueComponent:function valueComponent(){return Object(jsx_runtime.jsx)(DetailFooter_TimestampValue,{value:entity.paths.create_timestamp.value})}}),Object(jsx_runtime.jsx)(DetailFooter_FooterItem,{labelId:"client.entity-detail.footer.by",valueComponent:function valueComponent(){return Object(jsx_runtime.jsx)(DetailFooter_TextValue,{value:entity.paths.create_user.value})}})]}),Object(jsx_runtime.jsxs)(Layout.a.Box,{children:[Object(jsx_runtime.jsx)(DetailFooter_FooterItem,{labelId:"client.entity-detail.footer.updated",valueComponent:function valueComponent(){return Object(jsx_runtime.jsx)(DetailFooter_TimestampValue,{value:entity.paths.update_timestamp.value})}}),Object(jsx_runtime.jsx)(DetailFooter_FooterItem,{labelId:"client.entity-detail.footer.by",valueComponent:function valueComponent(){return Object(jsx_runtime.jsx)(DetailFooter_TextValue,{value:entity.paths.update_user.value})}})]}),Object(jsx_runtime.jsxs)(Layout.a.Box,{children:[Object(jsx_runtime.jsx)(DetailFooter_FooterItem,{labelId:"client.entity-detail.footer.version",valueComponent:function valueComponent(){return Object(jsx_runtime.jsx)(DetailFooter_TextValue,{value:entity.paths.version.value})}}),Object(jsx_runtime.jsx)(DetailFooter_FooterItem,{labelId:"client.entity-detail.footer.key",valueComponent:function valueComponent(){return Object(jsx_runtime.jsx)(DetailFooter_TextValue,{value:entity.paths[keyField].value})}})]})]})})};DetailFooterFull_DetailFooterFull.displayName="DetailFooterFull",DetailFooterFull_DetailFooterFull.__docgenInfo={description:"",methods:[],displayName:"DetailFooterFull",props:{entity:{type:{name:"object"},required:!0,description:""},keyField:{type:{name:"string"},required:!0,description:""}}};var DetailFooter_DetailFooterFull=DetailFooterFull_DetailFooterFull;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/entity-detail/src/components/DetailFooter/DetailFooterFull.js"]={name:"DetailFooterFull",docgenInfo:DetailFooterFull_DetailFooterFull.__docgenInfo,path:"packages/entity-detail/src/components/DetailFooter/DetailFooterFull.js"});var DetailFooter_DetailFooter=function DetailFooter(_ref){var mode=_ref.mode,entity=_ref.entity,entityModel=_ref.entityModel;switch(helpers_getFooterType(mode,entityModel)){case detailFooter_types.FULL:return Object(jsx_runtime.jsx)(DetailFooter_DetailFooterFull,{entity:entity,keyField:entityModel.keyField});case detailFooter_types.REDUCED:return Object(jsx_runtime.jsx)(DetailFooter_DetailFooterReduced,{entity:entity,keyField:entityModel.keyField});case detailFooter_types.NONE:default:return null}};DetailFooter_DetailFooter.__docgenInfo={description:"",methods:[],displayName:"DetailFooter",props:{mode:{type:{name:"string"},required:!0,description:""},entity:{type:{name:"object"},required:!0,description:""},entityModel:{type:{name:"object"},required:!0,description:""}}};var components_DetailFooter_DetailFooter=DetailFooter_DetailFooter;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/entity-detail/src/components/DetailFooter/DetailFooter.js"]={name:"DetailFooter",docgenInfo:DetailFooter_DetailFooter.__docgenInfo,path:"packages/entity-detail/src/components/DetailFooter/DetailFooter.js"});var DetailFooterContainer=Object(es.connect)((function mapStateToProps(state){return{mode:state.entityDetail.mode,entity:state.entityDetail.entity,entityModel:state.entityDetail.entityModel}}))(Object(injectIntl.c)(components_DetailFooter_DetailFooter)),DetailForm_ref2=Object(jsx_runtime.jsx)(DetailFooterContainer,{}),DetailForm_DetailForm=function DetailForm(props){var fireTouched=props.fireTouched,dirty=props.dirty,intl=props.intl,submitting=props.submitting,mode=props.mode,formErrors=props.formErrors,valid=props.valid,submitForm=props.submitForm,entity=props.entity,formDefinition=props.formDefinition,formValues=props.formValues,anyTouched=props.anyTouched,formName=props.form,formEl=Object(react.useRef)(null);Object(react.useEffect)((function(){fireTouched(dirty)}),[dirty]),Object(react.useLayoutEffect)((function(){var firstInput=formEl.current.querySelector("input:not([disabled]),textarea:not([disabled])");null!=firstInput&&firstInput.focus()}),[]);var customRenderedActions=Object(react.useMemo)((function(){return{save:function save(actionDefinition){return Object(jsx_runtime.jsx)(DetailForm_SaveButton,Object.assign({intl:intl,submitting:submitting,mode:mode,hasErrors:!valid&&anyTouched,formErrors:formErrors},actionDefinition))},mark:function mark(actionDefinition){return Object(jsx_runtime.jsx)(DetailForm_MarkButton,Object.assign({},actionDefinition))}}}),[submitting,mode,valid,anyTouched,formErrors]);return Object(jsx_runtime.jsxs)(StyledForm,{onSubmit:function handleSubmit(event){event.preventDefault(),submitForm()},onKeyDown:function handleKeyPress(event){"Enter"===event.key&&"TEXTAREA"!==event.target.tagName&&event.preventDefault()},ref:formEl,children:[Object(jsx_runtime.jsx)(src_form.a.FormBuilder,{entity:entity,formName:formName,formDefinition:formDefinition,formValues:formValues,fieldMappingType:formDefinition.readOnly?"readonly":"editable",mode:mode,componentMapping:defineProperty_default()({},src_form.a.componentTypes.SUB_TABLE,subGrid),customRenderedActions:customRenderedActions}),DetailForm_ref2]})};DetailForm_DetailForm.displayName="DetailForm",DetailForm_DetailForm.__docgenInfo={description:"",methods:[],displayName:"DetailForm",props:{intl:{type:{name:"object"},required:!0,description:""},mode:{type:{name:"enum",value:[{value:"'update'",computed:!1},{value:"'create'",computed:!1}]},required:!1,description:""},submitForm:{type:{name:"func"},required:!0,description:""},formDefinition:{type:{name:"object"},required:!0,description:""},entity:{type:{name:"object"},required:!0,description:""},form:{type:{name:"string"},required:!0,description:""},touch:{type:{name:"func"},required:!0,description:""},formValues:{type:{name:"object"},required:!1,description:""},submitting:{type:{name:"bool"},required:!1,description:""},formErrors:{type:{name:"object"},required:!1,description:""},valid:{type:{name:"bool"},required:!1,description:""},dirty:{type:{name:"bool"},required:!1,description:""},lastSave:{type:{name:"number"},required:!1,description:""},fireTouched:{type:{name:"func"},required:!0,description:""},anyTouched:{type:{name:"bool"},required:!1,description:""}}};var components_DetailForm_DetailForm=Object(reduxForm.a)({form:"detailForm",destroyOnUnmount:!1})(DetailForm_DetailForm);"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/entity-detail/src/components/DetailForm/DetailForm.js"]={name:"DetailForm",docgenInfo:DetailForm_DetailForm.__docgenInfo,path:"packages/entity-detail/src/components/DetailForm/DetailForm.js"});var DetailFormContainer_mapActionCreators={unloadDetailView:unloadDetailView,submitForm:actions_submitForm,fireTouched:function fireTouched(touched){return{type:"entityDetail/FIRE_TOUCHED",payload:{touched:touched}}},logError:errorLogging.a.logError},DetailFormContainer_getFormGeneralErrors=function getFormGeneralErrors(formName){return function(state){return get_default()(state,"form.".concat(formName,".error"),{})}},DetailFormContainer=Object(es.connect)((function mapStateToProps(state){return{formDefinition:state.entityDetail.formDefinition,entity:state.entityDetail.entity,formValues:Object(getFormValues.a)("detailForm")(state),formErrors:Object.assign({},Object(getFormSyncErrors.a)("detailForm")(state),Object(getFormAsyncErrors.a)("detailForm")(state),Object(getFormSubmitErrors.a)("detailForm")(state),{_error:DetailFormContainer_getFormGeneralErrors("detailForm")(state)}),formInitialValues:Object(getFormInitialValues.a)("detailForm")(state),lastSave:state.entityDetail.lastSave}}),DetailFormContainer_mapActionCreators)(Object(injectIntl.c)(components_DetailForm_DetailForm));function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=getPrototypeOf_default()(Derived);if(hasNativeReflectConstruct){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var DetailView_DetailView=function(_React$Component){inherits_default()(DetailView,_React$Component);var _super=_createSuper(DetailView);function DetailView(){var _this;classCallCheck_default()(this,DetailView);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).handledAsyncValidate=function(formValues){return src_form.a.asyncValidation(formValues,_this.props.mode===modes_CREATE?{}:_this.props.formInitialValues,_this.props.fieldDefinitions,_this.props.mode)},_this.getSyncValidation=function(){return _this.validateSingleton||isEmpty_default()(_this.props.fieldDefinitions)||(_this.validateSingleton=src_form.a.syncValidation(_this.props.fieldDefinitions)),_this.validateSingleton},_this.msg=function(id){return _this.props.intl.formatMessage({id:id})},_this}return createClass_default()(DetailView,[{key:"componentWillUnmount",value:function componentWillUnmount(){this.props.unloadDetailView()}},{key:"render",value:function render(){var props=this.props;return Object(jsx_runtime.jsx)(LoadMask.a,{required:[props.formInitialValues],loadingText:this.msg("client.entity-detail.loadingText"),children:Object(jsx_runtime.jsx)(DetailFormContainer,{mode:this.props.mode,validate:this.getSyncValidation(),asyncValidate:this.handledAsyncValidate,asyncBlurFields:this.props.fieldDefinitions.map((function(fD){return fD.path}))})})}}]),DetailView}(react_default.a.Component);DetailView_DetailView.__docgenInfo={description:"",methods:[{name:"handledAsyncValidate",docblock:null,modifiers:[],params:[{name:"formValues",type:null}],returns:null},{name:"getSyncValidation",docblock:null,modifiers:[],params:[],returns:null},{name:"msg",docblock:null,modifiers:[],params:[{name:"id",type:null}],returns:null}],displayName:"DetailView",props:{intl:{type:{name:"object"},required:!0,description:""},mode:{type:{name:"enum",value:[{value:"'update'",computed:!1},{value:"'create'",computed:!1}]},required:!1,description:""},loadDetailView:{type:{name:"func"},required:!0,description:""},unloadDetailView:{type:{name:"func"},required:!0,description:""},logError:{type:{name:"func"},required:!0,description:""},entityModel:{type:{name:"object"},required:!0,description:""},fieldDefinitions:{type:{name:"arrayOf",value:{name:"shape",value:{path:{name:"string",required:!1},id:{name:"string",required:!1},validation:{name:"object",required:!1}}}},required:!0,description:""},entityName:{type:{name:"string"},required:!0,description:""},entityId:{type:{name:"string"},required:!1,description:""},formInitialValues:{type:{name:"shape",value:{initial:{name:"objectOf",value:{name:"string"},required:!1}}},required:!1,description:""}}};var components_DetailView_DetailView=DetailView_DetailView;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/entity-detail/src/components/DetailView/DetailView.js"]={name:"DetailView",docgenInfo:DetailView_DetailView.__docgenInfo,path:"packages/entity-detail/src/components/DetailView/DetailView.js"});var DetailViewContainer_mapActionCreators={loadDetailView:loadDetailView,unloadDetailView:unloadDetailView,logError:errorLogging.a.logError},DetailViewContainer=Object(es.connect)((function mapStateToProps(state,props){return{entityName:state.entityDetail.entityName,entityId:state.entityDetail.entityId,entityModel:state.entityDetail.entityModel,fieldDefinitions:state.entityDetail.fieldDefinitions,mode:state.entityDetail.mode,formInitialValues:Object(getFormInitialValues.a)("detailForm")(state)}}),DetailViewContainer_mapActionCreators)(Object(injectIntl.c)(components_DetailView_DetailView)),input_getDispatchActions=function getDispatchActions(input){return[setEntityName(input.entityName),setEntityId(input.entityId?input.entityId:null),setMode(input.mode),setFormName(input.formName),setAppId(input.id),setDefaultValues(input.defaultValues),loadDetailView()]},customActions={new:regenerator_default.a.mark((function _new(){return regenerator_default.a.wrap((function _new$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,Object(redux_saga_effects_npm_proxy_esm.e)(navigateToCreate());case 2:case"end":return _context.stop()}}),_new)})),fullscreen:regenerator_default.a.mark((function fullscreen(definition,selection){return regenerator_default.a.wrap((function fullscreen$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,Object(redux_saga_effects_npm_proxy_esm.e)(navigateToAction(definition,selection));case 2:case"end":return _context2.stop()}}),fullscreen)}))},shortcuts=[{ctrl:!0,key:"s",actions:[{type:"entityDetail/SUBMIT_FORM"}]}];function main_createSuper(Derived){var hasNativeReflectConstruct=function main_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=getPrototypeOf_default()(Derived);if(hasNativeReflectConstruct){var NewTarget=getPrototypeOf_default()(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return possibleConstructorReturn_default()(this,result)}}var EXTERNAL_EVENTS=["onSubGridRowClick","onEntityCreated","onEntityUpdated","onEntityDeleted","onTouchedChange","emitAction"],main_ref=Object(jsx_runtime.jsx)(DetailViewContainer,{}),main_initApp=function initApp(id,input){var events=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},publicPath=arguments.length>3?arguments[3]:void 0,content=main_ref,store=appFactory.a.createStore(reducers,reducers_sagas,input,"entity-detail");externalEvents.a.addToStore(store,events),actionEmitter.a.addToStore(store,events.emitAction),errorLogging.a.addToStore(store,!1),notification.a.addToStore(store,!1),actions.a.addToStore(store,{formApp:main.a,listApp:src_main.a,customActions:customActions,appComponent:input.actionAppComponent,navigationStrategy:input.navigationStrategy,context:{viewName:"detail",formName:input.formName}}),formData.a.addToStore(store,{listApp:src_main.a,detailApp:main_EntityDetailApp,navigationStrategy:input.navigationStrategy}),keyDown.a.addToStore(store,shortcuts);var dispatchActions=input_getDispatchActions(input),app=appFactory.a.createApp("entity-detail",content,store,{input:input,events:events,actions:dispatchActions,publicPath:publicPath,textResourceModules:["component","common","entity-list","entity-detail"]});return app};appFactory.a.registerAppInRegistry("entity-detail",main_initApp);var main_EntityDetailApp=function(_React$Component){inherits_default()(EntityDetailApp,_React$Component);var _super=main_createSuper(EntityDetailApp);function EntityDetailApp(props){var _this;classCallCheck_default()(this,EntityDetailApp),_this=_super.call(this,props);var events=EXTERNAL_EVENTS.reduce((function(events,event){return props[event]&&(events[event]=props[event]),events}),{});return _this.app=main_initApp(props.id,props,events),_this}return createClass_default()(EntityDetailApp,[{key:"render",value:function render(){return this.app.component}}]),EntityDetailApp}(react_default.a.Component);main_EntityDetailApp.__docgenInfo={description:"",methods:[],displayName:"EntityDetailApp",props:{entityName:{type:{name:"string"},required:!0,description:""},formName:{type:{name:"string"},required:!0,description:""},mode:{type:{name:"enum",value:[{value:"'update'",computed:!1},{value:"'create'",computed:!1}]},required:!1,description:""},navigationStrategy:{type:{name:"custom",raw:"navigationStrategy.propTypes"},required:!1,description:""},actionAppComponent:{type:{name:"func"},required:!1,description:""}}};__webpack_exports__.a=main_EntityDetailApp;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/entity-detail/src/main.js"]={name:"EntityDetailApp",docgenInfo:main_EntityDetailApp.__docgenInfo,path:"packages/entity-detail/src/main.js"})}}]);