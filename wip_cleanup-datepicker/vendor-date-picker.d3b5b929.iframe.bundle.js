(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{4977:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"DatePicker",(function(){return DatePicker_DatePicker}));var react=__webpack_require__(1),injectIntl=(__webpack_require__(10),__webpack_require__(377)),styled_components_browser_esm=__webpack_require__(5),resolveThemePath=__webpack_require__(37),useDatePickr=__webpack_require__(5040),taggedTemplateLiteral=__webpack_require__(9),taggedTemplateLiteral_default=__webpack_require__.n(taggedTemplateLiteral),modularScale=__webpack_require__(27);function _templateObject(){var data=taggedTemplateLiteral_default()(["\n  cursor: pointer;\n\n  .flatpickr-calendar.open  {\n    margin-top: ",";\n  }\n\n  .flatpickr-calendar.arrowTop:before,\n  .flatpickr-calendar.arrowTop:after {\n    left: 83%;\n  }\n"]);return _templateObject=function _templateObject(){return data},data}var StyledWrapper=styled_components_browser_esm.default.div(_templateObject(),modularScale.a.space(1.2)),jsx_runtime=__webpack_require__(0),DatePicker_DatePicker=function DatePicker(props){var value=props.value,children=props.children,intl=props.intl,onChange=props.onChange,wrapperElement=Object(react.useRef)(null),locale=intl.locale,fontFamily=resolveThemePath.a.fontFamily("regular")(props),initializeFlatPickr=Object(useDatePickr.a)(wrapperElement,{value:value,onChange:onChange,fontFamily:fontFamily,locale:locale,flatpickrOptions:{},shouldAppend:!0});return Object(react.useEffect)((function(){wrapperElement.current&&initializeFlatPickr()}),[]),Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:Object(jsx_runtime.jsx)(StyledWrapper,{"data-wrap":!0,ref:wrapperElement,children:Object(jsx_runtime.jsxs)("div",{"data-toggle":!0,children:[Object(jsx_runtime.jsx)("input",{style:{display:"none"},type:"text","data-input":!0,"aria-label":function msg(id){return intl.formatMessage({id:id})}("client.component.datePicker.label")}),children]})})})};DatePicker_DatePicker.__docgenInfo={description:"",methods:[],displayName:"DatePicker",props:{children:{type:{name:"node"},required:!0,description:"Any content to wrap a onclick around to open a calendar"},onChange:{type:{name:"func"},required:!0,description:"Function triggered on every date selection. First parameter is the picked date as iso string."},value:{type:{name:"any"},required:!1,description:"To set the selected date from outside the component."},intl:{type:{name:"object"},required:!0,description:""}}};__webpack_exports__.default=Object(styled_components_browser_esm.withTheme)(Object(injectIntl.c)(DatePicker_DatePicker));"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/tocco-ui/src/DatePicker/DatePicker.js"]={name:"DatePicker",docgenInfo:DatePicker_DatePicker.__docgenInfo,path:"packages/tocco-ui/src/DatePicker/DatePicker.js"})},5040:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useDatePickr}));var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(40),_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0__),flatpickr__WEBPACK_IMPORTED_MODULE_8__=(__webpack_require__(2304),__webpack_require__(11),__webpack_require__(58),__webpack_require__(166),__webpack_require__(167),__webpack_require__(384),__webpack_require__(5122),__webpack_require__(5124)),flatpickr__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(flatpickr__WEBPACK_IMPORTED_MODULE_8__),flatpickr_dist_l10n_de_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(5125),flatpickr_dist_l10n_fr_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(5126),flatpickr_dist_l10n_it_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(5127),react__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(1),tocco_util_src_react__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(237),tocco_util_src_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(189),localeMap={"de-CH":flatpickr_dist_l10n_de_js__WEBPACK_IMPORTED_MODULE_9__.German,de:flatpickr_dist_l10n_de_js__WEBPACK_IMPORTED_MODULE_9__.German,fr:flatpickr_dist_l10n_fr_js__WEBPACK_IMPORTED_MODULE_10__.French,it:flatpickr_dist_l10n_it_js__WEBPACK_IMPORTED_MODULE_11__.Italian},handleOnChange=function handleOnChange(onChange){return function(selectedDates){selectedDates&&selectedDates.length>0?onChange(selectedDates[0].toISOString()):onChange(null)}},useDatePickr=function useDatePickr(element,config){var value=config.value,locale=config.locale,flatpickrOptions=config.flatpickrOptions,flatpickr=Object(react__WEBPACK_IMPORTED_MODULE_12__.useRef)(null),prevFlatpickrOptions=tocco_util_src_react__WEBPACK_IMPORTED_MODULE_13__.a.usePrevious(flatpickrOptions);return Object(react__WEBPACK_IMPORTED_MODULE_12__.useEffect)((function(){return function(){flatpickr.current&&flatpickr.current.destroy()}}),[]),Object(react__WEBPACK_IMPORTED_MODULE_12__.useEffect)((function(){flatpickr.current&&(flatpickr.current.setDate(value,!1),flatpickr.current.redraw())}),[JSON.stringify(value)]),Object(react__WEBPACK_IMPORTED_MODULE_12__.useEffect)((function(){var _flatpickr$current,_flatpickr$current$l,calendarLocale=localeMap[locale]||(null===(_flatpickr$current=flatpickr.current)||void 0===_flatpickr$current||null===(_flatpickr$current$l=_flatpickr$current.l10ns)||void 0===_flatpickr$current$l?void 0:_flatpickr$current$l.en);flatpickr.current&&calendarLocale&&(flatpickr.current.localize(calendarLocale),flatpickr.current.set("locale",calendarLocale),flatpickr.current.redraw())}),[locale]),Object(react__WEBPACK_IMPORTED_MODULE_12__.useEffect)((function(){if(flatpickr.current){var optionsDiff=tocco_util_src_js__WEBPACK_IMPORTED_MODULE_14__.a.difference(flatpickrOptions,prevFlatpickrOptions);Object.keys(optionsDiff).length>0&&(Object.entries(optionsDiff).forEach((function(_ref2){var _ref3=_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default()(_ref2,2),key=_ref3[0],value=_ref3[1];flatpickr.current.set(key,value)})),flatpickr.current.redraw())}}),[flatpickrOptions]),function init(){return flatpickr.current=function initializeFlatPickr(element,_ref){var shouldAppend=_ref.shouldAppend,onChange=_ref.onChange,value=_ref.value,fontFamily=_ref.fontFamily,locale=_ref.locale,flatpickrOptions=_ref.flatpickrOptions,calendarLocale=localeMap[locale],options=Object.assign({wrap:!0,onChange:handleOnChange(onChange),altInput:!1,enableTime:!1,defaultDate:value},shouldAppend?{appendTo:element.current}:{},calendarLocale?{locale:calendarLocale}:{},flatpickrOptions),flatpickrInstance=flatpickr__WEBPACK_IMPORTED_MODULE_8___default()(element.current,options);return fontFamily&&(flatpickrInstance.calendarContainer.style.fontFamily=fontFamily),flatpickrInstance}(element,config),flatpickr.current}}},5231:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var slicedToArray=__webpack_require__(40),slicedToArray_default=__webpack_require__.n(slicedToArray),react=(__webpack_require__(11),__webpack_require__(345),__webpack_require__(723),__webpack_require__(1)),injectIntl=(__webpack_require__(10),__webpack_require__(377)),styled_components_browser_esm=__webpack_require__(5),taggedTemplateLiteral=__webpack_require__(9),taggedTemplateLiteral_default=__webpack_require__.n(taggedTemplateLiteral),StyledEditableValue=__webpack_require__(56);function _templateObject4(){var data=taggedTemplateLiteral_default()(["\n  && {\n    ","\n\n    input {\n      display: ",";\n\n      &:last-of-type {\n        display: ",";\n      }\n    }\n  }\n"]);return _templateObject4=function _templateObject4(){return data},data}function _templateObject3(){var data=taggedTemplateLiteral_default()(["\n  outline: ",";\n"]);return _templateObject3=function _templateObject3(){return data},data}function _templateObject2(){var data=taggedTemplateLiteral_default()(["\n  && {\n    ","\n    display: flex;\n    align-items: center;\n  }\n"]);return _templateObject2=function _templateObject2(){return data},data}function _templateObject(){var data=taggedTemplateLiteral_default()(["\n  &&& {\n    ","\n  }\n"]);return _templateObject=function _templateObject(){return data},data}var StyledDatePickerInput=styled_components_browser_esm.default.input(_templateObject(),StyledEditableValue.e),StyledDatePickerValue=styled_components_browser_esm.default.div(_templateObject2(),StyledEditableValue.e),StyledDatePickerOuterWrapper=styled_components_browser_esm.default.div(_templateObject3(),(function(_ref){return _ref.immutable?0:"initial"})),StyledDatePickerWrapper=styled_components_browser_esm.default.div(_templateObject4(),StyledEditableValue.d,(function(_ref2){return _ref2.immutable?"none":"block"}),(function(_ref3){return _ref3.immutable?"block":"none"})),Ball=__webpack_require__(1375),useDatePickr=__webpack_require__(5040),resolveThemePath=__webpack_require__(37),jsx_runtime=__webpack_require__(0),focusFlatpickrInput=function focusFlatpickrInput(wrapper){var inputElement=wrapper.querySelector('input.flatpickr-input:not([type="hidden"])');inputElement&&inputElement.focus()},DatePicker_DatePicker=function DatePicker(props){var _flatpickr$current,_flatpickr$current$al,immutable=props.immutable,id=props.id,options=props.options,value=props.value,onChange=props.onChange,parseDate=props.parseDate,formatDate=props.formatDate,intl=props.intl,_useState=Object(react.useState)(!1),_useState2=slicedToArray_default()(_useState,2),initialized=_useState2[0],setInitialized=_useState2[1],flatpickr=Object(react.useRef)(null),wrapper=Object(react.useRef)(null),locale=intl.locale,fontFamily=resolveThemePath.a.fontFamily("regular")(props),flatpickrOptions=Object.assign({altInput:!0,altInputClass:"",clickOpens:!immutable},options?options.flatpickrOptions:{}),initializeFlatPickr=Object(useDatePickr.a)(wrapper,{value:value,onChange:function handleOnChange(val){val&&onChange([val])},fontFamily:fontFamily,locale:locale,flatpickrOptions:flatpickrOptions}),altInput=(null===(_flatpickr$current=flatpickr.current)||void 0===_flatpickr$current||null===(_flatpickr$current$al=_flatpickr$current.altInput)||void 0===_flatpickr$current$al?void 0:_flatpickr$current$al.value)||"",handleOnBlur=function handleOnBlur(){var parsed=parseDate(flatpickr.current.altInput.value);flatpickr.current.setDate(parsed,!0)},focusInput=function focusInput(){initialized?focusFlatpickrInput(wrapper.current):(!function init(){flatpickr.current=initializeFlatPickr(),flatpickr.current.calendarContainer.classList.add("tocco-ui-theme"),flatpickr.current.calendarContainer.addEventListener("keydown",handleConfirmKey),setInitialized(!0)}(),setTimeout((function(){focusFlatpickrInput(wrapper.current)})))},handleConfirmKey=function handleConfirmKey(e){(e.target.classList.contains("flatpickr-hour")||"Tab"!==e.key||e.shiftKey)&&"Enter"!==e.key||(handleOnBlur(),setTimeout((function(){flatpickr.current.close()}))),"Enter"===e.key&&(e.preventDefault(),e.stopPropagation())},hasValue=value&&value.length>0&&value.every((function(v){return v}));return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:Object(jsx_runtime.jsx)(StyledDatePickerOuterWrapper,{immutable:immutable,id:id,tabIndex:"-1",onFocus:function onFocus(){focusInput(),flatpickr.current&&flatpickr.current.open()},onKeyDown:handleConfirmKey,children:Object(jsx_runtime.jsxs)(StyledDatePickerWrapper,{"data-wrap":!0,onBlur:handleOnBlur,immutable:immutable,ref:wrapper,children:[Object(jsx_runtime.jsx)(StyledDatePickerInput,Object.assign({},immutable?{disabled:"disabled"}:{},{type:"hidden","data-input":!0,immutable:immutable},options?{placeholder:options.placeholderText}:{})),!initialized&&Object(jsx_runtime.jsx)(StyledDatePickerValue,{tabIndex:0,children:hasValue?formatDate(value[0]):""}),Object(jsx_runtime.jsx)(StyledDatePickerInput,{disabled:!0,immutable:immutable,value:altInput}),!immutable&&hasValue&&Object(jsx_runtime.jsx)(Ball.a,{icon:"times",tabIndex:-1,"aria-label":function msg(id){return intl.formatMessage({id:id})}("client.component.dateAbstract.clearDateLabel"),onMouseDown:function onMouseDown(e){e.preventDefault(),onChange(null)}})]})})})};DatePicker_DatePicker.__docgenInfo={description:"",methods:[],displayName:"DatePicker",props:{id:{type:{name:"string"},required:!1,description:""},intl:{type:{name:"object"},required:!0,description:""},onChange:{type:{name:"func"},required:!0,description:""},value:{type:{name:"arrayOf",value:{name:"string"}},required:!1,description:""},options:{type:{name:"shape",value:{placeholderText:{name:"string",required:!1},flatpickrOptions:{name:"object",required:!1}}},required:!1,description:""},parseDate:{type:{name:"func"},required:!1,description:""},formatDate:{type:{name:"func"},required:!1,description:""},immutable:{type:{name:"bool"},required:!1,description:""},initialized:{type:{name:"func"},required:!1,description:""},events:{type:{name:"shape",value:{onFocus:{name:"func",required:!1}}},required:!1,description:""}}};__webpack_exports__.default=Object(styled_components_browser_esm.withTheme)(Object(injectIntl.c)(DatePicker_DatePicker));"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/tocco-ui/src/EditableValue/typeEditors/DatePicker.js"]={name:"DatePicker",docgenInfo:DatePicker_DatePicker.__docgenInfo,path:"packages/tocco-ui/src/EditableValue/typeEditors/DatePicker.js"})}}]);