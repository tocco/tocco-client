(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{2318:function(module,exports,__webpack_require__){var baseFlatten=__webpack_require__(469),baseOrderBy=__webpack_require__(2319),baseRest=__webpack_require__(468),isIterateeCall=__webpack_require__(1030),sortBy=baseRest((function(collection,iteratees){if(null==collection)return[];var length=iteratees.length;return length>1&&isIterateeCall(collection,iteratees[0],iteratees[1])?iteratees=[]:length>2&&isIterateeCall(iteratees[0],iteratees[1],iteratees[2])&&(iteratees=[iteratees[0]]),baseOrderBy(collection,baseFlatten(iteratees,1),[])}));module.exports=sortBy},2319:function(module,exports,__webpack_require__){var arrayMap=__webpack_require__(311),baseIteratee=__webpack_require__(362),baseMap=__webpack_require__(2320),baseSortBy=__webpack_require__(2321),baseUnary=__webpack_require__(365),compareMultiple=__webpack_require__(2322),identity=__webpack_require__(366);module.exports=function baseOrderBy(collection,iteratees,orders){var index=-1;iteratees=arrayMap(iteratees.length?iteratees:[identity],baseUnary(baseIteratee));var result=baseMap(collection,(function(value,key,collection){return{criteria:arrayMap(iteratees,(function(iteratee){return iteratee(value)})),index:++index,value:value}}));return baseSortBy(result,(function(object,other){return compareMultiple(object,other,orders)}))}},2320:function(module,exports,__webpack_require__){var baseEach=__webpack_require__(1035),isArrayLike=__webpack_require__(271);module.exports=function baseMap(collection,iteratee){var index=-1,result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,(function(value,key,collection){result[++index]=iteratee(value,key,collection)})),result}},2321:function(module,exports){module.exports=function baseSortBy(array,comparer){var length=array.length;for(array.sort(comparer);length--;)array[length]=array[length].value;return array}},2322:function(module,exports,__webpack_require__){var compareAscending=__webpack_require__(2323);module.exports=function compareMultiple(object,other,orders){for(var index=-1,objCriteria=object.criteria,othCriteria=other.criteria,length=objCriteria.length,ordersLength=orders.length;++index<length;){var result=compareAscending(objCriteria[index],othCriteria[index]);if(result)return index>=ordersLength?result:result*("desc"==orders[index]?-1:1)}return object.index-other.index}},2323:function(module,exports,__webpack_require__){var isSymbol=__webpack_require__(312);module.exports=function compareAscending(value,other){if(value!==other){var valIsDefined=void 0!==value,valIsNull=null===value,valIsReflexive=value==value,valIsSymbol=isSymbol(value),othIsDefined=void 0!==other,othIsNull=null===other,othIsReflexive=other==other,othIsSymbol=isSymbol(other);if(!othIsNull&&!othIsSymbol&&!valIsSymbol&&value>other||valIsSymbol&&othIsDefined&&othIsReflexive&&!othIsNull&&!othIsSymbol||valIsNull&&othIsDefined&&othIsReflexive||!valIsDefined&&othIsReflexive||!valIsReflexive)return 1;if(!valIsNull&&!valIsSymbol&&!othIsSymbol&&value<other||othIsSymbol&&valIsDefined&&valIsReflexive&&!valIsNull&&!valIsSymbol||othIsNull&&valIsDefined&&valIsReflexive||!othIsDefined&&valIsReflexive||!othIsReflexive)return-1}return 0}},2336:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _ACTION_HANDLERS,react=__webpack_require__(0),react_default=__webpack_require__.n(react),appFactory=(__webpack_require__(24),__webpack_require__(74)),errorLogging=__webpack_require__(113),externalEvents=__webpack_require__(72),es=__webpack_require__(37),index_es=__webpack_require__(14),classCallCheck=__webpack_require__(45),classCallCheck_default=__webpack_require__.n(classCallCheck),createClass=__webpack_require__(49),createClass_default=__webpack_require__.n(createClass),possibleConstructorReturn=__webpack_require__(46),possibleConstructorReturn_default=__webpack_require__.n(possibleConstructorReturn),getPrototypeOf=__webpack_require__(47),getPrototypeOf_default=__webpack_require__.n(getPrototypeOf),inherits=__webpack_require__(48),inherits_default=__webpack_require__.n(inherits),taggedTemplateLiteral=__webpack_require__(22),taggedTemplateLiteral_default=__webpack_require__.n(taggedTemplateLiteral),styled_components_browser_esm=(__webpack_require__(9),__webpack_require__(7)),src=__webpack_require__(5),changeTargetEntity=function(pk){return{type:"MergeMatrix/CHANGE_TARGET_ENTITY",payload:{pk:pk}}},selectSourceField=function(field,entityPk){return{type:"MergeMatrix/SELECT_SOURCE_FIELD",payload:{entityPk:entityPk,field:field}}},selectSourceRelation=function(relationName,entityPk){return{type:"MergeMatrix/SELECT_SOURCE_RELATION",payload:{relationName:relationName,entityPk:entityPk}}},toggleRelationMany=function(relationName,relationPk,entityPk){return{type:"MergeMatrix/TOGGLE_RELATION_MANY",payload:{relationName:relationName,relationPk:relationPk,entityPk:entityPk}}},defineProperty=(__webpack_require__(16),__webpack_require__(25),__webpack_require__(19),__webpack_require__(81),__webpack_require__(363),__webpack_require__(26),__webpack_require__(23),__webpack_require__(30),__webpack_require__(31),__webpack_require__(15),__webpack_require__(20),__webpack_require__(4)),defineProperty_default=__webpack_require__.n(defineProperty);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var source,i=1;i<arguments.length;i++)source=null!=arguments[i]?arguments[i]:{},i%2?ownKeys(source,!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}));return target}var ACTION_HANDLERS=(_ACTION_HANDLERS={},defineProperty_default()(_ACTION_HANDLERS,"MergeMatrix/SELECT_SOURCE_FIELD",(function changeSourceField(state,_ref){var payload=_ref.payload;return _objectSpread({},state,{fields:_objectSpread({},state.fields,defineProperty_default()({},payload.field,payload.entityPk))})})),defineProperty_default()(_ACTION_HANDLERS,"MergeMatrix/SELECT_SOURCE_RELATION",(function changeSourceRelation(state,_ref2){var payload=_ref2.payload;return _objectSpread({},state,{relations:_objectSpread({},state.relations,defineProperty_default()({},payload.relationName,payload.entityPk))})})),defineProperty_default()(_ACTION_HANDLERS,"MergeMatrix/TOGGLE_RELATION_MANY",(function reducer_toggleRelationMany(state,_ref3){var payload=_ref3.payload,newState=_objectSpread({},state);newState.toManyRelations[payload.relationName]||(newState.toManyRelations[payload.relationName]={});var relation=newState.toManyRelations[payload.relationName];relation[payload.entityPk]||(relation[payload.entityPk]=[]);var idx=relation[payload.entityPk].indexOf(payload.relationPk);return 0<=idx?relation[payload.entityPk].splice(idx,1):relation[payload.entityPk].push(payload.relationPk),newState})),defineProperty_default()(_ACTION_HANDLERS,"MergeMatrix/CLEAR_RELATION_MANY",(function reducer_clearRelationMany(state){return _objectSpread({},state,{toManyRelations:{}})})),_ACTION_HANDLERS),initialState={fields:{},relations:{},toManyRelations:{}};function reducer_reducer(){var state=0<arguments.length&&void 0!==arguments[0]?arguments[0]:initialState,action=1<arguments.length?arguments[1]:void 0,handler=ACTION_HANDLERS[action.type];return handler?handler(state,action):state}reducer_reducer.__docgenInfo={description:"",methods:[],displayName:"reducer"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/modules/mergeMatrix/selections/reducer.js"]={name:"reducer",docgenInfo:reducer_reducer.__docgenInfo,path:"packages/merge/src/modules/mergeMatrix/selections/reducer.js"});var selections=reducer_reducer,helpers_extends=(__webpack_require__(142),__webpack_require__(29),__webpack_require__(40)),extends_default=__webpack_require__.n(helpers_extends);__webpack_require__(190);function _templateObject5(){var data=taggedTemplateLiteral_default()(["\n  && {\n    display: flex;\n    width: 100%;\n    max-width: 100%;\n  }\n"]);return _templateObject5=function(){return data},data}function _templateObject4(){var data=taggedTemplateLiteral_default()(["\n  && {\n    ","\n    border-bottom: 0;\n    cursor: pointer;\n    text-align: left;\n  }\n"]);return _templateObject4=function(){return data},data}function _templateObject3(){var data=taggedTemplateLiteral_default()(["\n  && {\n    ","\n    border-top: 1px solid ",";\n  }\n"]);return _templateObject3=function(){return data},data}function _templateObject2(){var data=taggedTemplateLiteral_default()(["\n  ","\n  background-color: ",";\n  font-weight: ",";\n  padding: "," ",";\n  vertical-align: top;\n\n  > label {\n    margin: 0;\n    cursor: ",";\n    opacity: ",";\n\n    :not(:last-child) {\n      margin-right: ",";\n    }\n\n    input {\n      margin-right: ",';\n    }\n  }\n\n  time {\n    vertical-align: bottom; // realignment needed because of "display: inline-block;" in declareNoneWrappingText.js\n  }\n']);return _templateObject2=function(){return data},data}function _templateObject(){var data=taggedTemplateLiteral_default()(["\n  && {\n    width: 100%;\n    max-width: 100%;\n    margin-bottom: ",";\n    border-collapse: collapse;\n    border-spacing: 0;\n\n    > tbody {\n      > tr:nth-of-type(odd) {\n        background-color: ",";\n      }\n    }\n  }\n"]);return _templateObject=function(){return data},data}var StyledMergeMatrixTable=styled_components_browser_esm.default.table(_templateObject(),src.L.space(-1),(function(props){return Object(src.M)(src.N.color("paper")(props),.2)})),StyledMergeMatrixCell=Object(styled_components_browser_esm.css)(_templateObject2(),Object(src.J)(),(function(props){return props.selected?src.N.color("backgroundBody"):"transparent"}),(function(props){return props.bold?src.N.fontWeight("bold"):src.N.fontWeight("regular")}),src.L.space(-2),src.L.space(-1),(function(props){return props.disabled?"not-allowed":"pointer"}),(function(props){return props.disabled?.6:1}),src.L.space(-1),src.L.space(-2)),StyledMergeMatrixTd=styled_components_browser_esm.default.td(_templateObject3(),StyledMergeMatrixCell,(function(props){return src.I.shade2(props)})),StyledMergeMatrixTh=styled_components_browser_esm.default.th(_templateObject4(),StyledMergeMatrixCell),StyledMergeMatrixLabel=styled_components_browser_esm.default.label(_templateObject5()),HeaderRow_ref=react_default.a.createElement(StyledMergeMatrixTh,null),HeaderRow=function(props){var isTargetEntity=function(pk){return pk===props.targetEntityPk};return react_default.a.createElement("tr",null,HeaderRow_ref,props.entities.map((function(entity,idx){var attributes={};return isTargetEntity(entity.pk)||(attributes.title=props.intl.formatMessage({id:"client.merge.selectTargetTitle"})),react_default.a.createElement(StyledMergeMatrixTh,extends_default()({bold:!0,onClick:function onClick(){isTargetEntity(entity.pk)||props.changeTargetEntity(entity.pk)},key:"th"+idx},attributes,{selected:isTargetEntity(entity.pk)}),react_default.a.createElement(src.j,{icon:"crosshairs",position:src.K.position.PREPEND}),react_default.a.createElement(src.H.B,null,entity.label))})))};HeaderRow.displayName="HeaderRow",HeaderRow.__docgenInfo={description:"",methods:[],displayName:"HeaderRow",props:{intl:{type:{name:"custom",raw:"intlShape.isRequired"},required:!1,description:""},entities:{type:{name:"array"},required:!0,description:""},changeTargetEntity:{type:{name:"func"},required:!0,description:""},targetEntityPk:{type:{name:"string"},required:!0,description:""}}};var table_components_HeaderRow=HeaderRow;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeMatrix/table-components/HeaderRow.js"]={name:"HeaderRow",docgenInfo:HeaderRow.__docgenInfo,path:"packages/merge/src/components/MergeMatrix/table-components/HeaderRow.js"});__webpack_require__(79);var SingleSelectionCell=function(props){return react_default.a.createElement(StyledMergeMatrixLabel,null,react_default.a.createElement("input",{type:"radio",disabled:props.disabled,onChange:function clickFnc(){return props.onChange(props.identifier,props.pk)},checked:props.checked,name:props.identifier}),react_default.a.createElement(src.H.Span,null,props.children))};SingleSelectionCell.displayName="SingleSelectionCell",SingleSelectionCell.__docgenInfo={description:"",methods:[],displayName:"SingleSelectionCell",props:{checked:{type:{name:"bool"},required:!0,description:""},onChange:{type:{name:"func"},required:!0,description:""},identifier:{type:{name:"string"},required:!0,description:""},pk:{type:{name:"string"},required:!0,description:""},disabled:{type:{name:"bool"},required:!0,description:""},children:{type:{name:"node"},required:!1,description:""}}};var SingleSelection=SingleSelectionCell;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeMatrix/table-components/SingleSelection.js"]={name:"SingleSelectionCell",docgenInfo:SingleSelectionCell.__docgenInfo,path:"packages/merge/src/components/MergeMatrix/table-components/SingleSelection.js"});var FieldRow=function(props){var isWritableRow=props.targetEntity.fields[props.field.name].writable;return react_default.a.createElement("tr",null,react_default.a.createElement(StyledMergeMatrixTd,{bold:!0},props.field.label),props.entities.map((function(entity,idx){var pk,entityField=entity.fields[props.field.name];return react_default.a.createElement(StyledMergeMatrixTd,{disabled:!isWritableRow,selected:(pk=entity.pk,pk===props.targetEntity.pk),key:"td"+idx},react_default.a.createElement(SingleSelection,{identifier:props.field.name,pk:entity.pk,onChange:props.selectSourceField,checked:props.selections.fields[props.field.name]===entity.pk,disabled:!isWritableRow},react_default.a.createElement(src.i,{type:entityField.type,value:entityField.value})))})))};FieldRow.displayName="FieldRow",FieldRow.__docgenInfo={description:"",methods:[],displayName:"FieldRow",props:{field:{type:{name:"object"},required:!0,description:""},entities:{type:{name:"array"},required:!0,description:""},targetEntity:{type:{name:"object"},required:!0,description:""},selections:{type:{name:"object"},required:!0,description:""},selectSourceField:{type:{name:"func"},required:!0,description:""}}};var table_components_FieldRow=FieldRow;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeMatrix/table-components/FieldRow.js"]={name:"FieldRow",docgenInfo:FieldRow.__docgenInfo,path:"packages/merge/src/components/MergeMatrix/table-components/FieldRow.js"});__webpack_require__(57),__webpack_require__(39),__webpack_require__(59);var RelationRow=function(props){var isWritableRow=!props.targetEntity.relations[props.relation.name].writable;return react_default.a.createElement("tr",null,react_default.a.createElement(StyledMergeMatrixTd,{bold:!0},props.relation.label),props.entities.map((function(entity,idx){var pk,entityRelationValue=entity.relations[props.relation.name].values[0];return react_default.a.createElement(StyledMergeMatrixTd,{disabled:isWritableRow,selected:(pk=entity.pk,pk===props.targetEntity.pk),key:"td"+idx},react_default.a.createElement(SingleSelection,{identifier:props.relation.name,pk:entity.pk,onChange:props.selectSourceRelation,checked:props.selections.relations[props.relation.name]===entity.pk,disabled:isWritableRow},react_default.a.createElement(src.H.Span,null,entityRelationValue&&entityRelationValue.label)))})))};RelationRow.displayName="RelationRow",RelationRow.__docgenInfo={description:"",methods:[],displayName:"RelationRow",props:{relation:{type:{name:"object"},required:!0,description:""},entities:{type:{name:"array"},required:!0,description:""},selectSourceRelation:{type:{name:"func"},required:!0,description:""},targetEntity:{type:{name:"object"},required:!0,description:""},selections:{type:{name:"object"},required:!0,description:""}}};var table_components_RelationRow=RelationRow;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeMatrix/table-components/RelationRow.js"]={name:"RelationRow",docgenInfo:RelationRow.__docgenInfo,path:"packages/merge/src/components/MergeMatrix/table-components/RelationRow.js"});var sortBy=__webpack_require__(2318),sortBy_default=__webpack_require__.n(sortBy),MultiSelection=function(props){var disabled=props.disabled?"disabled":"";return react_default.a.createElement(react_default.a.Fragment,null,sortBy_default()(props.values,(function(v){return v.pk})).map((function(value,idx){return react_default.a.createElement(StyledMergeMatrixLabel,{key:"multiselection".concat(idx)},react_default.a.createElement("input",{type:"checkbox",disabled:disabled,onChange:function onChange(){return function(value){return props.onChange(props.relationName,value.pk,props.entity.pk)}(value)},checked:(relationPk=value.pk,function(toManySelections,relationName,toManyPk,entityPk){var toManyRelationSelection=toManySelections[relationName];if(!toManyRelationSelection)return!1;var entitySelection=toManyRelationSelection[entityPk];return!!entitySelection&&0<=entitySelection.indexOf(toManyPk)}(props.selections.toManyRelations,props.relationName,relationPk,props.entity.pk))}),react_default.a.createElement(src.H.Span,null,value.label));var relationPk})))};MultiSelection.displayName="MultiSelection",MultiSelection.__docgenInfo={description:"",methods:[],displayName:"MultiSelection",props:{values:{type:{name:"array"},required:!0,description:""},entity:{type:{name:"object"},required:!0,description:""},relationName:{type:{name:"string"},required:!0,description:""},onChange:{type:{name:"func"},required:!0,description:""},selections:{type:{name:"object"},required:!0,description:""},disabled:{type:{name:"bool"},required:!0,description:""}}};var table_components_MultiSelection=MultiSelection;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeMatrix/table-components/MultiSelection.js"]={name:"MultiSelection",docgenInfo:MultiSelection.__docgenInfo,path:"packages/merge/src/components/MergeMatrix/table-components/MultiSelection.js"});var ToManyRelationRow=function(props){var isWritableRow=props.targetEntity.relations[props.relation.name].writable;return react_default.a.createElement("tr",null,react_default.a.createElement(StyledMergeMatrixTd,{bold:!0},props.relation.label),props.entities.map((function(entity,idx){var pk,disabled=!(props.targetEntity.pk===entity.pk),values=entity.relations[props.relation.name].values;return react_default.a.createElement(StyledMergeMatrixTd,{disabled:disabled||!isWritableRow,key:"td"+idx,selected:(pk=entity.pk,pk===props.targetEntity.pk)},react_default.a.createElement(table_components_MultiSelection,{relationName:props.relation.name,values:values,entity:entity,onChange:props.toggleRelationMany,selections:props.selections,disabled:disabled||!isWritableRow}))})))};ToManyRelationRow.displayName="ToManyRelationRow",ToManyRelationRow.__docgenInfo={description:"",methods:[],displayName:"ToManyRelationRow",props:{relation:{type:{name:"object"},required:!0,description:""},entities:{type:{name:"array"},required:!0,description:""},toggleRelationMany:{type:{name:"func"},required:!0,description:""},targetEntity:{type:{name:"object"},required:!0,description:""},selections:{type:{name:"object"},required:!0,description:""}}};var table_components_ToManyRelationRow=ToManyRelationRow;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeMatrix/table-components/ToManyRelationRow.js"]={name:"ToManyRelationRow",docgenInfo:ToManyRelationRow.__docgenInfo,path:"packages/merge/src/components/MergeMatrix/table-components/ToManyRelationRow.js"});var MergeMatrix=function(props){var targetEntity=props.entities.find((function(e){return e.pk===props.targetEntityPk}));return react_default.a.createElement(StyledMergeMatrixTable,null,react_default.a.createElement("thead",null,react_default.a.createElement(table_components_HeaderRow,{entities:props.entities,changeTargetEntity:props.changeTargetEntity,selectSourceField:props.selectSourceField,targetEntityPk:props.targetEntityPk,intl:props.intl})),react_default.a.createElement("tbody",null,props.model.fields.map((function(field,idx){return react_default.a.createElement(table_components_FieldRow,{key:"fieldrow".concat(idx),field:field,selections:props.selections,targetEntity:targetEntity,entities:props.entities,selectSourceField:props.selectSourceField})})),props.model.relations.filter((function(r){return!r.toMany})).map((function(relation,idx){return react_default.a.createElement(table_components_RelationRow,{key:"relationrow".concat(idx),relation:relation,selections:props.selections,targetEntity:targetEntity,entities:props.entities,selectSourceRelation:props.selectSourceRelation,toggleRelationMany:props.toggleRelationMany})})),props.model.relations.filter((function(r){return r.toMany})).map((function(relation,idx){return react_default.a.createElement(table_components_ToManyRelationRow,{key:"relationrow".concat(idx),relation:relation,selections:props.selections,targetEntity:targetEntity,entities:props.entities,toggleRelationMany:props.toggleRelationMany})}))))};MergeMatrix.displayName="MergeMatrix",MergeMatrix.__docgenInfo={description:"",methods:[],displayName:"MergeMatrix",props:{entities:{type:{name:"array"},required:!0,description:""},model:{type:{name:"shape",value:{fields:{name:"arrayOf",value:{name:"custom",raw:"fieldsPropType"},required:!0},relations:{name:"arrayOf",value:{name:"custom",raw:"relationsPropType"},required:!0}}},required:!0,description:""},targetEntityPk:{type:{name:"string"},required:!1,description:""},selections:{type:{name:"object"},required:!1,description:""},changeTargetEntity:{type:{name:"func"},required:!0,description:""},selectSourceField:{type:{name:"func"},required:!0,description:""},selectSourceRelation:{type:{name:"func"},required:!0,description:""},toggleRelationMany:{type:{name:"func"},required:!0,description:""},intl:{type:{name:"custom",raw:"intlShape.isRequired"},required:!1,description:""}}};var MergeMatrix_MergeMatrix=MergeMatrix;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeMatrix/MergeMatrix.js"]={name:"MergeMatrix",docgenInfo:MergeMatrix.__docgenInfo,path:"packages/merge/src/components/MergeMatrix/MergeMatrix.js"});var components_MergeMatrix=MergeMatrix_MergeMatrix,mapActionCreators={changeTargetEntity:changeTargetEntity,selectSourceField:selectSourceField,selectSourceRelation:selectSourceRelation,toggleRelationMany:toggleRelationMany},MergeMatrixContainer=Object(es.connect)((function(state){return{entities:state.mergeMatrix.entities,model:state.mergeMatrix.model,targetEntityPk:state.mergeMatrix.targetEntityPk,selections:state.mergeMatrix.selections}}),mapActionCreators)(Object(index_es.injectIntl)(components_MergeMatrix)),FieldOption=function(props){return react_default.a.createElement(src.h,{type:props.fieldType,id:props.name,value:props.value,onChange:function onChange(value){props.onChange(props.name,value)},readOnly:props.disabled})};FieldOption.displayName="FieldOption",FieldOption.__docgenInfo={description:"",methods:[],displayName:"FieldOption",props:{name:{type:{name:"string"},required:!0,description:""},fieldType:{type:{name:"string"},required:!0,description:""},value:{type:{name:"string"},required:!0,description:""},onChange:{type:{name:"func"},required:!0,description:""},disabled:{type:{name:"bool"},required:!1,description:""}}};var MergeStrategy_FieldOption=FieldOption;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeStrategy/FieldOption.js"]={name:"FieldOption",docgenInfo:FieldOption.__docgenInfo,path:"packages/merge/src/components/MergeStrategy/FieldOption.js"});__webpack_require__(27);function StyledRelationOption_templateObject(){var data=taggedTemplateLiteral_default()(["\n  cursor: ",";\n  opacity: ",";\n"]);return StyledRelationOption_templateObject=function(){return data},data}var StyledRelationOptionSelect=styled_components_browser_esm.default.select(StyledRelationOption_templateObject(),(function(props){return props.disabled?"not-allowed":"pointer"}),(function(props){return props.disabled?.6:1})),RelationOption=function(props){var options=[];for(var propertyName in props.values)options.push(react_default.a.createElement("option",{key:"fieldset".concat(props.name).concat(propertyName),value:propertyName},props.values[propertyName]));return react_default.a.createElement(StyledRelationOptionSelect,{disabled:props.disabled,value:props.value,onChange:function handleOnChange(event){props.onChange(props.name,event.target.value)}},options)};RelationOption.displayName="RelationOption",RelationOption.__docgenInfo={description:"",methods:[],displayName:"RelationOption",props:{name:{type:{name:"string"},required:!0,description:""},values:{type:{name:"object"},required:!0,description:""},value:{type:{name:"string"},required:!0,description:""},onChange:{type:{name:"func"},required:!0,description:""},disabled:{type:{name:"bool"},required:!1,description:""}}};var MergeStrategy_RelationOption=RelationOption;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeStrategy/RelationOption.js"]={name:"RelationOption",docgenInfo:RelationOption.__docgenInfo,path:"packages/merge/src/components/MergeStrategy/RelationOption.js"});var EditOptionType_field="set-field-source-entity-strategy",EditOptionType_relation="set-relation-source-entity-strategy";function StyledMergeStrategy_templateObject2(){var data=taggedTemplateLiteral_default()(["\n  && {\n    ","\n    margin: 0 0 ",";\n  }\n"]);return StyledMergeStrategy_templateObject2=function(){return data},data}function StyledMergeStrategy_templateObject(){var data=taggedTemplateLiteral_default()(["\n  && {\n    max-width: 400px;\n\n    input[type='checkbox'],\n    input[type='radio'] {\n      margin-right: ",";\n    }\n  }\n"]);return StyledMergeStrategy_templateObject=function(){return data},data}var StyledMergeStrategyAnswer=styled_components_browser_esm.default.div(StyledMergeStrategy_templateObject(),src.L.space(-2)),StyledMergeStrategyLabel=styled_components_browser_esm.default.label(StyledMergeStrategy_templateObject2(),Object(src.J)(),src.L.space(-2)),EditOption_ref=react_default.a.createElement("br",null),EditOption=function(props){var input;return props.editOption.type===EditOptionType_field?input=react_default.a.createElement(MergeStrategy_FieldOption,{name:props.editOption.name,fieldType:props.editOption.fieldType,value:props.editOption.value,onChange:props.onValueChange,disabled:!props.editOption.active}):props.editOption.type===EditOptionType_relation&&(input=react_default.a.createElement(MergeStrategy_RelationOption,{name:props.editOption.name,value:props.editOption.value,values:props.editOption.values,onChange:props.onValueChange,disabled:!props.editOption.active})),react_default.a.createElement(src.H.P,null,react_default.a.createElement(StyledMergeStrategyLabel,null,react_default.a.createElement("input",{type:"checkbox",checked:props.editOption.active,onClick:function handleCheck(){props.activateEditOption(props.editOption.name,!props.editOption.active)}}),props.editOption.label),EditOption_ref,input)};EditOption.displayName="EditOption",EditOption.__docgenInfo={description:"",methods:[],displayName:"EditOption",props:{editOption:{type:{name:"object"},required:!0,description:""},activateEditOption:{type:{name:"func"},required:!0,description:""},onValueChange:{type:{name:"func"},required:!0,description:""}}};var MergeStrategy_EditOption=EditOption;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeStrategy/EditOption.js"]={name:"EditOption",docgenInfo:EditOption.__docgenInfo,path:"packages/merge/src/components/MergeStrategy/EditOption.js"});var SourceEntityAction_EDIT="EDIT",SourceEntityAction_DELETE="DELETE",SourceEntityAction_NO_ACTION="NO_ACTION",MergeStrategy_MergeStrategy=function(_React$Component){function MergeStrategy(){return classCallCheck_default()(this,MergeStrategy),possibleConstructorReturn_default()(this,getPrototypeOf_default()(MergeStrategy).apply(this,arguments))}return inherits_default()(MergeStrategy,_React$Component),createClass_default()(MergeStrategy,[{key:"msg",value:function msg(id){return this.props.intl.formatMessage({id:id})}},{key:"render",value:function render(){var _this=this;return react_default.a.createElement("form",null,react_default.a.createElement(src.H.H6,null,this.msg("client.merge.copyRelationsTitle")),react_default.a.createElement(src.e,null,react_default.a.createElement(src.d,{look:"raised",aria:{"aria-pressed":this.props.strategies.copyRelations},label:this.msg("client.merge.yes"),onClick:function onClick(){return _this.props.changeStrategy("copyRelations",!0)}}),react_default.a.createElement(src.d,{look:"raised",aria:{"aria-pressed":!this.props.strategies.copyRelations},label:this.msg("client.merge.no"),onClick:function onClick(){return _this.props.changeStrategy("copyRelations",!1)}})),react_default.a.createElement(src.H.H6,null,this.msg("client.merge.strategyTitle")),react_default.a.createElement(StyledMergeStrategyAnswer,null,react_default.a.createElement("select",{value:this.props.strategies.sourceEntityAction,onChange:function onChange(event){return _this.props.changeStrategy("sourceEntityAction",event.target.value)}},react_default.a.createElement("option",{value:SourceEntityAction_NO_ACTION},this.msg("client.merge.strategyNoAction")),react_default.a.createElement("option",{value:SourceEntityAction_DELETE,hidden:!0},this.msg("client.merge.strategyDelete")),0<this.props.editOptions.length&&react_default.a.createElement("option",{value:SourceEntityAction_EDIT},this.msg("client.merge.strategyEdit")))),this.props.strategies.sourceEntityAction===SourceEntityAction_EDIT&&react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(src.H.H6,null,this.msg("client.merge.editTitle")),react_default.a.createElement(StyledMergeStrategyAnswer,null,this.props.editOptions.map((function(editOption,idx){return react_default.a.createElement(MergeStrategy_EditOption,{key:"fieldset".concat(idx),editOption:editOption,activateEditOption:_this.props.activateEditOption,onValueChange:_this.props.changeEditOptionValue})})))))}}]),MergeStrategy}(react_default.a.Component);MergeStrategy_MergeStrategy.displayName="MergeStrategy",MergeStrategy_MergeStrategy.__docgenInfo={description:"",methods:[{name:"msg",docblock:null,modifiers:[],params:[{name:"id",type:null}],returns:null}],displayName:"MergeStrategy",props:{intl:{type:{name:"custom",raw:"intlShape.isRequired"},required:!1,description:""},editOptions:{type:{name:"array"},required:!0,description:""},changeEditOptionValue:{type:{name:"func"},required:!0,description:""},activateEditOption:{type:{name:"func"},required:!0,description:""},strategies:{type:{name:"object"},required:!0,description:""},changeStrategy:{type:{name:"func"},required:!0,description:""}}};var components_MergeStrategy_MergeStrategy=MergeStrategy_MergeStrategy;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeStrategy/MergeStrategy.js"]={name:"MergeStrategy",docgenInfo:MergeStrategy_MergeStrategy.__docgenInfo,path:"packages/merge/src/components/MergeStrategy/MergeStrategy.js"});var components_MergeStrategy=components_MergeStrategy_MergeStrategy,retrieveEditOptions=function(editOptions){return{type:"MergeStrategy/RECEIVE_EDIT_OPTIONS",payload:{editOptions:editOptions}}},MergeStrategyContainer_mapActionCreators={changeEditOptionValue:function(name,value){return{type:"MergeStrategy/CHANGE_EDIT_OPTION_VALUE",payload:{name:name,value:value}}},activateEditOption:function(name,activate){return{type:"MergeStrategy/ACTIVATE_EDIT_OPTION",payload:{name:name,activate:activate}}},changeStrategy:function(name,value){return{type:"MergeStrategy/CHANGE_STRATEGY",payload:{name:name,value:value}}}},MergeStrategyContainer=Object(es.connect)((function(state){return{editOptions:state.mergeStrategy.editOptions,strategies:state.mergeStrategy.strategies}}),MergeStrategyContainer_mapActionCreators)(Object(index_es.injectIntl)(components_MergeStrategy)),assertThisInitialized=__webpack_require__(44),assertThisInitialized_default=__webpack_require__.n(assertThisInitialized);function StyledWizard_templateObject(){var data=taggedTemplateLiteral_default()(["\n  margin-bottom: ",";\n"]);return StyledWizard_templateObject=function(){return data},data}var StyledWizard=styled_components_browser_esm.default.div(StyledWizard_templateObject(),src.L.space(-1)),Wizard_Wizard=function(_React$Component){function Wizard(props){var _this;return classCallCheck_default()(this,Wizard),_this=possibleConstructorReturn_default()(this,getPrototypeOf_default()(Wizard).call(this,props)),defineProperty_default()(assertThisInitialized_default()(_this),"getCurrentPage",(function(){return _this.props.children.find((function(child,idx){return idx===_this.state.index}))})),defineProperty_default()(assertThisInitialized_default()(_this),"backClick",(function(){0<_this.state.index&&_this.setState((function(previousState){return{index:previousState.index-1}}))})),defineProperty_default()(assertThisInitialized_default()(_this),"changeAllowNext",(function(allow){_this.setState((function(){return{allowNext:allow}}))})),defineProperty_default()(assertThisInitialized_default()(_this),"nextClick",(function(){var result=!0;_this.currentRender&&_this.currentRender.getWrappedInstance&&_this.currentRender.getWrappedInstance().wizardNext&&(result=_this.currentRender.getWrappedInstance().wizardNext()),result&&_this.state.index<_this.state.amountPages-1&&_this.setState((function(previousState){return{index:previousState.index+1}}))})),_this.state={index:0,amountPages:props.children.length,allowNext:!0},_this}return inherits_default()(Wizard,_React$Component),createClass_default()(Wizard,[{key:"render",value:function render(){var _this2=this,currentPage=this.getCurrentPage(),t=react_default.a.cloneElement(currentPage,{wizardAllowNext:this.changeAllowNext,ref:function ref(_ref){return _this2.currentRender=_ref}}),buttons=[];return this.state.index===this.state.amountPages-1&&buttons.push(react_default.a.createElement(src.d,{ink:"primary",look:"raised",key:"merge-wizard-button-amount-pages",label:this.props.save.label,onClick:this.props.save.fn})),0<this.state.index&&buttons.push(react_default.a.createElement(src.d,{look:"raised",key:"merge-wizard-button-back",label:this.msg("client.merge.back"),onClick:this.backClick})),this.state.index<this.state.amountPages-1&&buttons.push(react_default.a.createElement(src.d,{look:"raised",disabled:!this.state.allowNext,ink:"primary",key:"merge-wizard-button-next",label:this.msg("client.merge.next"),onClick:this.nextClick})),react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(StyledWizard,null,t),[].concat(buttons))}},{key:"msg",value:function msg(id){return this.props.intl.formatMessage({id:id})}}]),Wizard}(react_default.a.Component);Wizard_Wizard.displayName="Wizard",Wizard_Wizard.__docgenInfo={description:"",methods:[{name:"getCurrentPage",docblock:null,modifiers:[],params:[],returns:null},{name:"backClick",docblock:null,modifiers:[],params:[],returns:null},{name:"changeAllowNext",docblock:null,modifiers:[],params:[{name:"allow",type:null}],returns:null},{name:"nextClick",docblock:null,modifiers:[],params:[],returns:null},{name:"msg",docblock:null,modifiers:[],params:[{name:"id",type:null}],returns:null}],displayName:"Wizard",props:{children:{type:{name:"arrayOf",value:{name:"element"}},required:!1,description:""},intl:{type:{name:"custom",raw:"intlShape.isRequired"},required:!1,description:""},save:{type:{name:"object"},required:!0,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/Wizard/Wizard.js"]={name:"Wizard",docgenInfo:Wizard_Wizard.__docgenInfo,path:"packages/merge/src/components/Wizard/Wizard.js"});var MergeResponse_ref=react_default.a.createElement("div",null),MergeResponse_ref2=react_default.a.createElement("thead",null,react_default.a.createElement("tr",null,react_default.a.createElement(StyledMergeMatrixTh,{bold:!0},react_default.a.createElement(index_es.FormattedMessage,{id:"client.merge.entity"})),react_default.a.createElement(StyledMergeMatrixTh,{bold:!0},react_default.a.createElement(index_es.FormattedMessage,{id:"client.merge.primaryKey"})),react_default.a.createElement(StyledMergeMatrixTh,{bold:!0},react_default.a.createElement(index_es.FormattedMessage,{id:"client.merge.label"})))),EntityResponseTable=function(props){return props.responseEntities&&0!==props.responseEntities.length?react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(src.H.H5,null,props.title),react_default.a.createElement(StyledMergeMatrixTable,null,MergeResponse_ref2,react_default.a.createElement("tbody",null,props.responseEntities.map((function(e,idx){return react_default.a.createElement("tr",{key:idx},react_default.a.createElement(StyledMergeMatrixTd,null,e.entity),react_default.a.createElement(StyledMergeMatrixTd,null,e.pk),react_default.a.createElement(StyledMergeMatrixTd,null,e.name))}))))):MergeResponse_ref};EntityResponseTable.displayName="EntityResponseTable";var _ref3=react_default.a.createElement(src.H.H4,null,react_default.a.createElement(index_es.FormattedMessage,{id:"client.merge.responseTitle"})),_ref4=react_default.a.createElement(src.H.P,null,react_default.a.createElement(index_es.FormattedMessage,{id:"client.merge.responseDescription"})),_ref5=react_default.a.createElement(src.y,{condition:"danger"},react_default.a.createElement(src.H.Span,null,react_default.a.createElement(index_es.FormattedMessage,{id:"client.merge.missingReadPermissions"}))),MergeResponse_MergeResponse=function(_React$Component){function MergeResponse(){return classCallCheck_default()(this,MergeResponse),possibleConstructorReturn_default()(this,getPrototypeOf_default()(MergeResponse).apply(this,arguments))}return inherits_default()(MergeResponse,_React$Component),createClass_default()(MergeResponse,[{key:"render",value:function render(){var _this=this;return react_default.a.createElement(react_default.a.Fragment,null,_ref3,_ref4,react_default.a.createElement(EntityResponseTable,{title:this.props.intl.formatMessage({id:"client.merge.notCopiedRelationsTitle"}),responseEntities:this.props.mergeResponse.notCopiedRelations}),react_default.a.createElement(EntityResponseTable,{title:this.props.intl.formatMessage({id:"client.merge.notDeletedEntitiesTitle"}),responseEntities:this.props.mergeResponse.notDeletedEntities}),this.props.mergeResponse.showPermissionMessage&&_ref5,react_default.a.createElement(src.d,{ink:"primary",label:this.msg("client.merge.close"),look:"raised",onClick:function onClick(){_this.props.fireExternalEvent("close")}}))}},{key:"msg",value:function msg(id){return this.props.intl.formatMessage({id:id})}}]),MergeResponse}(react_default.a.Component);MergeResponse_MergeResponse.displayName="MergeResponse",MergeResponse_MergeResponse.__docgenInfo={description:"",methods:[{name:"msg",docblock:null,modifiers:[],params:[{name:"id",optional:!1,type:null}],returns:null}],displayName:"MergeResponse",props:{fireExternalEvent:{type:{name:"func"},required:!0,description:""},intl:{type:{name:"custom",raw:"intlShape.isRequired"},required:!1,description:""},mergeResponse:{type:{name:"object"},required:!0,description:""}}};var MergeWizard_MergeResponse=MergeResponse_MergeResponse;function MergeWizard_templateObject(){var data=taggedTemplateLiteral_default()(["\n  background-color: ",";\n  padding: 5px;\n"]);return MergeWizard_templateObject=function(){return data},data}EntityResponseTable.__docgenInfo={description:"",methods:[],displayName:"EntityResponseTable",props:{title:{type:{name:"string"},required:!0,description:""},responseEntities:{type:{name:"array"},required:!0,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeWizard/MergeResponse.js"]={name:"EntityResponseTable",docgenInfo:EntityResponseTable.__docgenInfo,path:"packages/merge/src/components/MergeWizard/MergeResponse.js"}),"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeWizard/MergeResponse.js"]={name:"MergeResponse",docgenInfo:MergeResponse_MergeResponse.__docgenInfo,path:"packages/merge/src/components/MergeWizard/MergeResponse.js"});var StyledWizardWrapper=styled_components_browser_esm.default.div(MergeWizard_templateObject(),src.N.color("paper")),MergeWizard_ref=react_default.a.createElement(MergeStrategyContainer,null),MergeWizard_ref2=react_default.a.createElement(MergeMatrixContainer,null),MergeWizard_MergeStrategy=function(_React$Component){function MergeStrategy(){return classCallCheck_default()(this,MergeStrategy),possibleConstructorReturn_default()(this,getPrototypeOf_default()(MergeStrategy).apply(this,arguments))}return inherits_default()(MergeStrategy,_React$Component),createClass_default()(MergeStrategy,[{key:"render",value:function render(){var saveButtonLabel=this.props.intl.formatMessage({id:"client.merge.saveButton"});return this.props.mergeResponse.merged?react_default.a.createElement(MergeWizard_MergeResponse,{mergeResponse:this.props.mergeResponse,intl:this.props.intl,fireExternalEvent:this.props.fireExternalEvent}):react_default.a.createElement(StyledWizardWrapper,null,react_default.a.createElement(Wizard_Wizard,{save:{fn:this.props.saveMerge,label:saveButtonLabel},intl:this.props.intl},MergeWizard_ref,MergeWizard_ref2))}}]),MergeStrategy}(react_default.a.Component);MergeWizard_MergeStrategy.displayName="MergeStrategy",MergeWizard_MergeStrategy.__docgenInfo={description:"",methods:[],displayName:"MergeStrategy",props:{saveMerge:{type:{name:"func"},required:!0,description:""},fireExternalEvent:{type:{name:"func"},required:!0,description:""},intl:{type:{name:"object"},required:!0,description:""},mergeResponse:{type:{name:"object"},required:!1,description:""}}};var MergeWizard=MergeWizard_MergeStrategy;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeWizard/MergeWizard.js"]={name:"MergeStrategy",docgenInfo:MergeWizard_MergeStrategy.__docgenInfo,path:"packages/merge/src/components/MergeWizard/MergeWizard.js"});var components_MergeWizard=MergeWizard;function setMergeResponse(mergeResponse){return{type:"Wizard/SET_MERGE_RESPONSE",payload:{mergeResponse:mergeResponse}}}var reducer_ACTION_HANDLERS,MergeWizardContainer_mapActionCreators={saveMerge:function saveMerge(){return{type:"Wizard/SAVE_MERGE"}},fireExternalEvent:externalEvents.a.fireExternalEvent},MergeWizardContainer=Object(es.connect)((function(state){return{mergeResponse:state.wizard.mergeResponse}}),MergeWizardContainer_mapActionCreators)(Object(index_es.injectIntl)(components_MergeWizard)),toConsumableArray=__webpack_require__(32),toConsumableArray_default=__webpack_require__.n(toConsumableArray),getDispatchActions=function(input){return[(entities=input.entities,{type:"MergeMatrix/RECEIVE_ENTITIES",payload:{entities:entities}}),(model=input.model,{type:"MergeMatrix/RETRIEVE_MODEL",payload:{model:model}}),changeTargetEntity(input.entities[0].pk),{type:"MergeMatrix/CLEAR_RELATION_MANY"},retrieveEditOptions(input.sourceEntitiesEditOptions)].concat(toConsumableArray_default()(getToManySelectDispatchActions(input)));var model,entities},getToManySelectDispatchActions=function(_ref){var model=_ref.model,entities=_ref.entities,result=[];return model.relations.filter((function(relation){return relation.toMany})).forEach((function(relation){entities.forEach((function(entity){entity.relations[relation.name].values.forEach((function(userRelationValue){userRelationValue.checked&&result.push(toggleRelationMany(relation.name,userRelationValue.pk,entity.pk))}))}))})),result},redux=__webpack_require__(97);var editOptions_reducer_ACTION_HANDLERS=(reducer_ACTION_HANDLERS={},defineProperty_default()(reducer_ACTION_HANDLERS,"MergeStrategy/RECEIVE_EDIT_OPTIONS",(function receiveEditOption(state,_ref){var payload=_ref.payload,newState=[].concat(payload.editOptions);return newState.forEach((function(editOption){editOption.value=editOption.defaultValue,editOption.active=!1})),newState})),defineProperty_default()(reducer_ACTION_HANDLERS,"MergeStrategy/CHANGE_EDIT_OPTION_VALUE",(function reducer_changeEditOptionValue(state,_ref2){var payload=_ref2.payload,name=payload.name,value=payload.value,newState=[].concat(state),editOption=newState.find((function(eO){return eO.name===name}));return editOption&&(editOption.value=value),newState})),defineProperty_default()(reducer_ACTION_HANDLERS,"MergeStrategy/ACTIVATE_EDIT_OPTION",(function reducer_activateEditOption(state,_ref3){var payload=_ref3.payload,name=payload.name,activate=payload.activate,newState=[].concat(state),editOption=newState.find((function(eO){return eO.name===name}));return editOption&&(editOption.active=activate),newState})),reducer_ACTION_HANDLERS),reducer_initialState=[];function editOptions_reducer_reducer(){var state=0<arguments.length&&void 0!==arguments[0]?arguments[0]:reducer_initialState,action=1<arguments.length?arguments[1]:void 0,handler=editOptions_reducer_ACTION_HANDLERS[action.type];return handler?handler(state,action):state}editOptions_reducer_reducer.__docgenInfo={description:"",methods:[],displayName:"reducer"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/modules/mergeStrategy/editOptions/reducer.js"]={name:"reducer",docgenInfo:editOptions_reducer_reducer.__docgenInfo,path:"packages/merge/src/modules/mergeStrategy/editOptions/reducer.js"});var editOptions=editOptions_reducer_reducer;function reducer_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}var strategies_reducer_ACTION_HANDLERS=defineProperty_default()({},"MergeStrategy/CHANGE_STRATEGY",(function setStrategy(state,_ref){var payload=_ref.payload,name=payload.name,value=payload.value;return function reducer_objectSpread(target){for(var source,i=1;i<arguments.length;i++)source=null!=arguments[i]?arguments[i]:{},i%2?reducer_ownKeys(source,!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):reducer_ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}));return target}({},state,defineProperty_default()({},name,value))})),strategies_reducer_initialState={copyRelations:!0,sourceEntityAction:"NO_ACTION"};function strategies_reducer_reducer(){var state=0<arguments.length&&void 0!==arguments[0]?arguments[0]:strategies_reducer_initialState,action=1<arguments.length?arguments[1]:void 0,handler=strategies_reducer_ACTION_HANDLERS[action.type];return handler?handler(state,action):state}strategies_reducer_reducer.__docgenInfo={description:"",methods:[],displayName:"reducer"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/modules/mergeStrategy/strategies/reducer.js"]={name:"reducer",docgenInfo:strategies_reducer_reducer.__docgenInfo,path:"packages/merge/src/modules/mergeStrategy/strategies/reducer.js"});var strategies=strategies_reducer_reducer,mergeStrategy=Object(redux.combineReducers)({editOptions:editOptions,strategies:strategies}),regenerator=__webpack_require__(2),regenerator_default=__webpack_require__.n(regenerator),redux_saga_effects_npm_proxy_esm=(__webpack_require__(43),__webpack_require__(1)),consoleLogger=(__webpack_require__(92),__webpack_require__(87));function MergeActionResult_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function createMergeResult(state){return function MergeActionResult_objectSpread(target){for(var source,i=1;i<arguments.length;i++)source=null!=arguments[i]?arguments[i]:{},i%2?MergeActionResult_ownKeys(source,!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):MergeActionResult_ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}));return target}({},function getMergeStrategyResult(mergeStrategyState){var deleteSourceEntities=mergeStrategyState.strategies.sourceEntityAction===SourceEntityAction_DELETE;return{copyRemainingRelations:mergeStrategyState.strategies.copyRelations,sourceEntityConfig:{deleteSourceEntities:deleteSourceEntities,updateValues:extractUpdateValues(mergeStrategyState)}}}(state.mergeStrategy),{},function getMergeMatrixResult(mergeMatrixState){return{modelName:mergeMatrixState.model.modelName,targetEntity:mergeMatrixState.targetEntityPk,sourceEntities:mergeMatrixState.entities.filter((function(e){return e.pk!==mergeMatrixState.targetEntityPk})).map((function(e){return e.pk})),data:{fields:extractFields(mergeMatrixState),relations:extractRelations(mergeMatrixState),toManyRelations:extractToManyRelations(mergeMatrixState)}}}(state.mergeMatrix))}function extractUpdateValues(mergeStrategyState){if(mergeStrategyState.strategies.sourceEntityAction!==SourceEntityAction_EDIT||!mergeStrategyState.editOptions)return[];var result=[];return mergeStrategyState.editOptions.forEach((function(editOptions){editOptions.active&&result.push({type:editOptions.type,name:editOptions.name,value:editOptions.value})})),result}function extractFields(state){var result=[];return state.selections.fields&&Object.keys(state.selections.fields).forEach((function(fieldName){var value=state.selections.fields[fieldName];value!==state.targetEntityPk&&result.push({name:fieldName,pk:value})})),result}function extractRelations(state){var result=[];return state.selections.relations&&Object.keys(state.selections.relations).forEach((function(relationName){var entityPk=state.selections.relations[relationName];if(entityPk!==state.targetEntityPk){var entity=state.entities.find((function(e){return e.pk===entityPk})),pks=[];entity.relations[relationName]&&0<entity.relations[relationName].values.length&&pks.push(entity.relations[relationName].values[0].pk),result.push({name:relationName,keys:pks})}})),result}function extractToManyRelations(state){var result=[];return state.selections.toManyRelations&&Object.keys(state.selections.toManyRelations).forEach((function(relationName){result.push({name:relationName,keys:state.selections.toManyRelations[relationName][state.targetEntityPk]})})),result}function mergingWithoutProblems(mergeResponse){if(mergeResponse){if(mergeResponse.notCopiedRelations&&0<mergeResponse.notCopiedRelations.length)return!1;if(mergeResponse.notDeletedEntities&&0<mergeResponse.notDeletedEntities.length)return!1}return!0}var _marked=regenerator_default.a.mark(save),_marked2=regenerator_default.a.mark(sagas);function sendDwr(mergeActionResult){return function sendDwrRequest(remoteService,method,args){return nice2.netui.dwr.RemoteService.call({remoteService:remoteService,method:method,args:[args]})}("nice2_entityoperation_MergeEntitiesService","merge",mergeActionResult)}function save(){var state,mergeActionResult,mergeResponse;return regenerator_default.a.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,Object(redux_saga_effects_npm_proxy_esm.f)();case 3:return state=_context.sent,_context.next=6,Object(redux_saga_effects_npm_proxy_esm.b)(createMergeResult,state);case 6:return mergeActionResult=_context.sent,_context.next=9,Object(redux_saga_effects_npm_proxy_esm.b)(sendDwr,mergeActionResult);case 9:if(!mergingWithoutProblems(mergeResponse=_context.sent)){_context.next=15;break}return _context.next=13,Object(redux_saga_effects_npm_proxy_esm.e)(externalEvents.a.fireExternalEvent("close"));case 13:_context.next=17;break;case 15:return _context.next=17,Object(redux_saga_effects_npm_proxy_esm.e)(setMergeResponse(mergeResponse));case 17:_context.next=22;break;case 19:_context.prev=19,_context.t0=_context.catch(0),consoleLogger.a.logError("An error occurred during merge:",_context.t0);case 22:case"end":return _context.stop()}}),_marked,null,[[0,19]])}function sagas(){return regenerator_default.a.wrap((function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,Object(redux_saga_effects_npm_proxy_esm.a)([Object(redux_saga_effects_npm_proxy_esm.i)("Wizard/SAVE_MERGE",save)]);case 2:case"end":return _context2.stop()}}),_marked2)}function wizard_reducer_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function wizard_reducer_objectSpread(target){for(var source,i=1;i<arguments.length;i++)source=null!=arguments[i]?arguments[i]:{},i%2?wizard_reducer_ownKeys(source,!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):wizard_reducer_ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}));return target}var wizard_reducer_ACTION_HANDLERS=defineProperty_default()({},"Wizard/SET_MERGE_RESPONSE",(function reducer_setMergeResponse(state,_ref){return wizard_reducer_objectSpread({},state,{mergeResponse:wizard_reducer_objectSpread({merged:!0},_ref.payload.mergeResponse)})}));function wizard_reducer_reducer(){var state=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{mergeResponse:{merged:!1}},action=1<arguments.length?arguments[1]:void 0,handler=wizard_reducer_ACTION_HANDLERS[action.type];return handler?handler(state,action):state}wizard_reducer_reducer.__docgenInfo={description:"",methods:[],displayName:"reducer"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/modules/wizard/reducer.js"]={name:"reducer",docgenInfo:wizard_reducer_reducer.__docgenInfo,path:"packages/merge/src/modules/wizard/reducer.js"});var wizard_marked=regenerator_default.a.mark(wizard_sagas),wizard=wizard_reducer_reducer;function wizard_sagas(){return regenerator_default.a.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,Object(redux_saga_effects_npm_proxy_esm.a)([Object(redux_saga_effects_npm_proxy_esm.d)(sagas)]);case 2:case"end":return _context.stop()}}),wizard_marked)}var sagas_marked=regenerator_default.a.mark(selectTargetEntityFields),sagas_marked2=regenerator_default.a.mark(sagas_sagas),mergeMatrixSelector=function(state){return state.mergeMatrix};function selectTargetEntityFields(_ref){var payload,pk,mergeMatrixState;return regenerator_default.a.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:return payload=_ref.payload,pk=payload.pk,_context.next=4,Object(redux_saga_effects_npm_proxy_esm.f)(mergeMatrixSelector);case 4:return mergeMatrixState=_context.sent,_context.next=7,mergeMatrixState.model.fields.map((function(field){return Object(redux_saga_effects_npm_proxy_esm.e)(selectSourceField(field.name,pk))}));case 7:return _context.next=9,mergeMatrixState.model.relations.filter((function(relation){return!relation.toMany})).map((function(relation){return Object(redux_saga_effects_npm_proxy_esm.e)(selectSourceRelation(relation.name,pk))}));case 9:case"end":return _context.stop()}}),sagas_marked)}function sagas_sagas(){return regenerator_default.a.wrap((function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,Object(redux_saga_effects_npm_proxy_esm.a)([Object(redux_saga_effects_npm_proxy_esm.i)("MergeMatrix/CHANGE_TARGET_ENTITY",selectTargetEntityFields)]);case 2:case"end":return _context2.stop()}}),sagas_marked2)}var entities_reducer_ACTION_HANDLERS=defineProperty_default()({},"MergeMatrix/RECEIVE_ENTITIES",(function reducer_receiveEntities(state,_ref){var payload=_ref.payload;return[].concat(payload.entities)})),entities_reducer_initialState=[];function entities_reducer_reducer(){var state=0<arguments.length&&void 0!==arguments[0]?arguments[0]:entities_reducer_initialState,action=1<arguments.length?arguments[1]:void 0,handler=entities_reducer_ACTION_HANDLERS[action.type];return handler?handler(state,action):state}entities_reducer_reducer.__docgenInfo={description:"",methods:[],displayName:"reducer"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/modules/mergeMatrix/entities/reducer.js"]={name:"reducer",docgenInfo:entities_reducer_reducer.__docgenInfo,path:"packages/merge/src/modules/mergeMatrix/entities/reducer.js"});var mergeMatrix_entities=entities_reducer_reducer;var model_reducer_ACTION_HANDLERS=defineProperty_default()({},"MergeMatrix/RETRIEVE_MODEL",(function model_reducer_receiveEntities(state,_ref){return _ref.payload.model})),model_reducer_initialState=[];function model_reducer_reducer(){var state=0<arguments.length&&void 0!==arguments[0]?arguments[0]:model_reducer_initialState,action=1<arguments.length?arguments[1]:void 0,handler=model_reducer_ACTION_HANDLERS[action.type];return handler?handler(state,action):state}model_reducer_reducer.__docgenInfo={description:"",methods:[],displayName:"reducer"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/modules/mergeMatrix/model/reducer.js"]={name:"reducer",docgenInfo:model_reducer_reducer.__docgenInfo,path:"packages/merge/src/modules/mergeMatrix/model/reducer.js"});var mergeMatrix_model=model_reducer_reducer;var targetEntityPk_reducer_ACTION_HANDLERS=defineProperty_default()({},"MergeMatrix/CHANGE_TARGET_ENTITY",(function reducer_changeTargetEntity(state,_ref){return _ref.payload.pk})),targetEntityPk_reducer_initialState=[];function targetEntityPk_reducer_reducer(){var state=0<arguments.length&&void 0!==arguments[0]?arguments[0]:targetEntityPk_reducer_initialState,action=1<arguments.length?arguments[1]:void 0,handler=targetEntityPk_reducer_ACTION_HANDLERS[action.type];return handler?handler(state,action):state}targetEntityPk_reducer_reducer.__docgenInfo={description:"",methods:[],displayName:"reducer"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/modules/mergeMatrix/targetEntityPk/reducer.js"]={name:"reducer",docgenInfo:targetEntityPk_reducer_reducer.__docgenInfo,path:"packages/merge/src/modules/mergeMatrix/targetEntityPk/reducer.js"});var targetEntityPk=targetEntityPk_reducer_reducer,mergeMatrix_marked=regenerator_default.a.mark(mergeMatrix_sagas);function mergeMatrix_sagas(){return regenerator_default.a.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,Object(redux_saga_effects_npm_proxy_esm.a)([Object(redux_saga_effects_npm_proxy_esm.d)(sagas_sagas)]);case 2:case"end":return _context.stop()}}),mergeMatrix_marked)}var reducers={mergeMatrix:Object(redux.combineReducers)({entities:mergeMatrix_entities,model:mergeMatrix_model,targetEntityPk:targetEntityPk,selections:selections}),mergeStrategy:mergeStrategy,wizard:wizard},reducers_sagas=[mergeMatrix_sagas,wizard_sagas],main_ref=react_default.a.createElement(MergeWizardContainer,null),initApp=function(id,input){var events=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},publicPath=3<arguments.length?arguments[3]:void 0,actions=getDispatchActions(input),store=appFactory.a.createStore(reducers,reducers_sagas,input,"merge");return externalEvents.a.addToStore(store,events),errorLogging.a.addToStore(store,!0,["console","remote"]),appFactory.a.createApp("merge",main_ref,store,{input:input,actions:actions,publicPath:publicPath})};appFactory.a.registerAppInRegistry("merge",initApp)}}]);
//# sourceMappingURL=9.dc26ceffa84b33afef49.bundle.js.map